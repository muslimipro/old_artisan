import{b as x,a4 as E,a5 as M,u as B,r as c,E as I,o as y,p as $,D as h,j as f,t as P,h as o,w as D,L as S,f as T,e as j,g as L,c as N,i as v,v as R}from"./index-CrrKimau.js";import{_ as q,a as A}from"./ExportProgressDialog.vue_vue_type_script_setup_true_lang-ZGQTf_Gp.js";import{C as k,m as F}from"./mapClassFromDto-AH29mFws.js";import{s as z}from"./index-CVUgYmaA.js";import{s as G}from"./index-DgmsQzkT.js";import"./index-CzVL6f0S.js";import"./index-rLSFooqB.js";import"./index-Cc4fZZVN.js";import"./index-D_2waQsa.js";import"./index-4_fBhWkb.js";import"./index-VUifxjOs.js";import"./index-Dv3PXNVO.js";import"./index-gprwKlQi.js";import"./index-DxuAR6go.js";import"./index-DU7DOYFv.js";import"./index-CSMgnqNq.js";import"./index-_C9UEwL7.js";import"./index-B93GKCIf.js";import"./mapRouteFromDto-GFbZzc0z.js";import"./mapLessonFromDto-CG19vVOp.js";import"./mapUnitFromDto-DJ2zlrQL.js";import"./transformUnitDtosToPages-4blM3N0G.js";import"./lessonType-v5Tmr0TL.js";import"./mapStudentFromDto-D4MSietx.js";const H={class:"flex flex-col gap-1"},J={class:"flex flex-col"},K={class:"font-bold text-sm mb-1"},O={class:"flex gap-2 justify-end"},Q=x({__name:"EditClassDialog",props:E({selectedClass:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(b){const d=M(b,"modelValue"),u=b,m=B(),i=c(""),a=c(!1);I(()=>u.selectedClass,e=>{i.value="",e&&(i.value=e.name)},{immediate:!0});async function g(){a.value=!0;try{const{data:e}=await k.createClass(i.value);window.location.reload(),m.add({severity:"success",summary:e.message,life:2e3}),d.value=!1}catch(e){m.add({severity:"error",summary:e.response.data.error,detail:e,life:2e3})}finally{a.value=!1}}async function C(){if(u.selectedClass){a.value=!0;try{const{data:e}=await k.updateClassById(u.selectedClass.id,i.value);window.location.reload(),m.add({severity:"success",summary:e.message,life:2e3}),d.value=!1}catch(e){m.add({severity:"error",summary:e.response.data.error,detail:e,life:2e3})}finally{a.value=!1}}}return(e,l)=>{const _=G,p=z,s=D,t=S;return y(),$(t,{visible:d.value,"onUpdate:visible":l[2]||(l[2]=r=>d.value=r),modal:"",draggable:!1,class:"m-4 max-w-md",header:u.selectedClass?e.$t("pages.teacher.editClass"):e.$t("pages.teacher.addClass")},{default:h(()=>[f("div",H,[f("div",J,[f("div",K,P(e.$t("pages.teacher.name")),1),o(_,{type:"text",modelValue:i.value,"onUpdate:modelValue":l[0]||(l[0]=r=>i.value=r)},null,8,["modelValue"])]),o(p),f("div",O,[o(s,{label:e.$t("pages.teacher.cancel"),severity:"secondary",onClick:l[1]||(l[1]=r=>d.value=!1)},null,8,["label"]),u.selectedClass==null?(y(),$(s,{key:0,label:e.$t("pages.teacher.create"),onClick:g,loading:a.value,disabled:a.value},null,8,["label","loading","disabled"])):(y(),$(s,{key:1,label:e.$t("pages.teacher.save"),onClick:C,loading:a.value,disabled:a.value},null,8,["label","loading","disabled"]))])])]),_:1},8,["visible","header"])}}}),W={class:"flex-grow min-w-0 pb-4 mb-4 bg-white rounded-md border"},X={class:"flex gap-2"},he=x({__name:"ClassesPage",setup(b){const d=B(),u=R(),m=T(),{userInfo:i}=j(m),a=c(!1),g=c(null);function C(s){a.value=!0,g.value=s}const e=c([]),l=c(!1);async function _(){try{l.value=!0;const{data:s}=await k.getClasses();e.value=(s==null?void 0:s.map(F))??[]}catch(s){d.add({severity:"error",summary:s.response.data.error,life:2e3})}finally{l.value=!1}}L(()=>{_()});const p=c(!1);return(s,t)=>{var w;const r=D;return y(),N("div",W,[o(v(q),{classes:e.value,loading:l.value},{"header-extra":h(()=>[o(r,{label:s.$t("pages.teacher.addClass"),icon:"pi pi-plus",variant:"outlined",class:"mr-2",onClick:t[0]||(t[0]=n=>C(null))},null,8,["label"]),o(r,{label:s.$t("exportProgress"),icon:"pi pi-upload",severity:"info",variant:"outlined",class:"mr-2",onClick:t[1]||(t[1]=n=>p.value=!0)},null,8,["label"])]),actions:h(({row:n})=>[f("div",X,[o(r,{icon:"pi pi-pencil",outlined:"",rounded:"",severity:"warn",onClick:U=>C(n)},null,8,["onClick"]),o(r,{icon:"pi pi-angle-right",outlined:"",rounded:"",severity:"info",onClick:U=>{var V;return v(u).push({name:((V=v(i))==null?void 0:V.user_type)=="teacher"?"teacher-class":"school-class",params:{id:n.id}})}},null,8,["onClick"])])]),_:1},8,["classes","loading"]),o(Q,{"model-value":a.value,"onUpdate:modelValue":t[2]||(t[2]=n=>a.value=n),"selected-class":g.value},null,8,["model-value","selected-class"]),o(v(A),{"model-value":p.value,"onUpdate:modelValue":t[3]||(t[3]=n=>p.value=n),classes:e.value,"school-name":((w=v(i))==null?void 0:w.school_name)??""},null,8,["model-value","classes","school-name"])])}}});export{he as default};
