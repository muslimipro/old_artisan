import{s as h}from"./index-C4TRSEyf.js";import{d as w,u as b,r as j,b as y,o as r,c as a,j as o,y as P,p as v,z as k,q as _,t as n,h as g,n as $,v as I,w as B,e as S,x as C,g as D,i as f,F as L,l as T}from"./index-BNOYZ_6B.js";import{_ as U}from"./MainHeader.vue_vue_type_script_setup_true_lang-BuEgZxiR.js";import{P as N}from"./projectApi-JqlVeMGA.js";import{m as A}from"./mapUnitFromDto-DJ2zlrQL.js";import{t as F}from"./transformUnitDtosToPages-4blM3N0G.js";import{T as q}from"./index-BjTXdGTl.js";import{s as V}from"./index-CAA1rma3.js";import{s as z}from"./index-CNPyJFLZ.js";import{L as M}from"./lessonApi-DJ332M2h.js";import"./index-CoDkBE5V.js";import"./index-DlyffbqJ.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./logo-D1-3uCnC.js";const R=e=>{var s;return{accessStatus:e.access_status,accessType:e.access_type,createdAt:new Date(e.created_at),createdBy:e.created_by,description:e.description,id:e.id,lessonType:e.lesson_type,levelId:e.level_id,name:e.name,previewImageUrl:e.preview_image_url,reviewedBy:e.reviewed_by,sourceImageUrl:e.source_image_url,stage:e.stage,studentProgress:e.student_progress,completed:e.completed,pages:F(e.units??[]),units:((s=e.units)==null?void 0:s.map(A))??[],lastAccessedUnit:e.last_accessed_unit,updatedAt:new Date(e.updated_at),updatedBy:e.updated_by,editable:e.editable,routeId:e.route_id??0,routeName:e.route_name??"",levelName:e.level_name??""}},E=w("projects-store",()=>{const e=b(),s=j([]),c=j(!1);async function p(){try{c.value=!0;const{data:i}=await N.getProjects();s.value=(i==null?void 0:i.map(R))??[]}catch(i){e.add({severity:"error",summary:i.response.data.error,life:2e3})}finally{c.value=!1}}return{projects:s,isLoading:c,loadProjects:p}}),O={class:"absolute top-0 left-0"},G={class:"flex gap-2 w-full h-full"},H={class:"flex flex-col justify-between items w-full"},J={class:"flex flex-col gap-[2px] justify-center"},K={class:"text-overline-small"},Q={class:"flex items-center gap-2"},W={key:0,class:"text-purple-500 h-[22px] w-4"},X={class:"text-body-large-semibold"},Y={class:"pt-[10px] flex flex-col gap-1"},Z={class:"action-small-bold text-blue400"},ee={key:0},se={key:1},te={key:2},oe=y({__name:"ProjectCard",props:{project:{}},setup(e){const s=e,c=I(),p=()=>{s.project.accessStatus==="available"&&c.push({name:"project",params:{id:s.project.id},query:{route_id:s.project.routeId}})};async function i(){s.project.accessStatus==="available"&&(await M.resetLessonById(s.project.id),c.push({name:"project",params:{id:s.project.id},query:{route_id:s.project.routeId}}))}return(t,l)=>{const u=B,m=z,d=V,x=q;return r(),a("div",{class:$(["relative flex flex-col rounded-lg h-[160px] w-[348px] pt-2 px-3 cursor-pointer bg-blue50",{"cursor-not-allowed opacity-60 pointer-events-none":t.project.accessStatus==="progress_restriction"}]),onClick:p},[o("div",O,[t.project.studentProgress>0?P((r(),v(u,{key:0,icon:"pi pi-refresh",variant:"link",onClick:k(i,["stop","prevent"]),class:"text-blue400"},null,512)),[[x,t.$t("startOver"),void 0,{top:!0}]]):_("",!0)]),o("div",G,[o("div",H,[l[1]||(l[1]=o("div",{class:"flex flex-wrap text-xs font-semibold pt-8"},null,-1)),o("div",J,[o("div",K,n(t.project.description),1),o("div",Q,[t.project.accessStatus==="premium_restriction"?(r(),a("div",W,l[0]||(l[0]=[o("i",{class:"pi pi-crown","aria-hidden":"true"},null,-1)]))):_("",!0),o("div",X,n(t.project.name),1)])])]),s.project.sourceImageUrl?(r(),v(m,{key:0,src:s.project.sourceImageUrl,alt:"Image",class:"min-w-[120px] min-h-[120px] w-[120px] h-[120px]"},null,8,["src"])):_("",!0)]),o("div",Y,[o("div",Z,[t.project.studentProgress==100||t.project.completed?(r(),a("span",ee,n(t.$t("done")),1)):t.project.studentProgress==0?(r(),a("span",se,n(t.$t("start")),1)):(r(),a("span",te,n(t.$t("inProgress")),1))]),g(d,{value:t.project.studentProgress,"show-value":!1,class:"w-full rounded-full h-[2px]",dt:{value:{background:"var(--color-blue400)"},background:"var(--color-blue200)"}},null,8,["value"])])],2)}}}),re={class:"flex flex-col items-center"},ae={class:"w-full flex max-w-[1280px] px-8 py-10 justify-start"},ce={class:"text-heading-2-bold text-neutral900"},ie={class:"w-full max-w-[1280px] px-8 pb-10"},le={key:1,class:"flex justify-center"},ne={key:2,class:"flex flex-col gap-8"},pe={class:"flex flex-wrap gap-6 bg-white p-6 rounded-2xl"},ke=y({__name:"ProjectsPage",setup(e){const s=E(),{projects:c,isLoading:p}=S(s),{loadProjects:i}=s,t=C(()=>{var l;return(l=c.value)==null?void 0:l.filter(u=>u.stage==="published")});return D(()=>i()),(l,u)=>{const m=h;return r(),a("div",re,[g(f(U)),o("div",ae,[o("div",ce,n(l.$t("projects")),1)]),o("div",ie,[f(p)?(r(),v(m,{key:0,class:"flex justify-center"})):f(c)?(r(),a("div",ne,[o("div",pe,[(r(!0),a(L,null,T(t.value,d=>(r(),a("div",{key:d.id},[g(oe,{project:d},null,8,["project"])]))),128))])])):(r(),a("div",le,"No projects yet"))])])}}});export{ke as default};
