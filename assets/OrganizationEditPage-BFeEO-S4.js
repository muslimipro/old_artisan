import{b as T,r as m,o as x,p as k,D as i,j as r,c as B,t as P,q as S,W as F,h as a,k as O,aH as L,w as R,u as H,a1 as K,g as W,i as A,F as G,C as J,v as Q,L as X}from"./index-mkT4Nz16.js";import{s as Y}from"./index-BVK_FUxY.js";import{s as U}from"./index-CYFre0Ef.js";import{_ as Z}from"./SchoolsTable.vue_vue_type_script_setup_true_lang-BlQc8LIK.js";import{O as _}from"./organizationApi-BlnKJlH0.js";import{s as ee,a as ae}from"./index-BfQqXRrB.js";import{a as oe,b as se}from"./index-BzKibbNi.js";import"./index-DPKHG_gJ.js";import"./index-Bae2SLxX.js";import"./index-Dp-E07Q-.js";import"./index-DHHwUh4o.js";import"./index-Dj7bFe1m.js";import"./index-Dt3o_xrH.js";import"./index-C2rkqqLY.js";import"./index-DMVNDFxA.js";import"./index-DFys0Nws.js";const le={class:"flex items-center"},re={class:"flex-grow flex gap-2 items-center"},te={key:0,class:"text-2xl"},ie=T({__name:"SupervisorsTable",props:{supervisors:{},loading:{type:Boolean}},setup(j){const n=m(),d=m();(()=>{d.value={global:{value:null,matchMode:L.CONTAINS}}})();const h=()=>{n.value.exportCSV()};return(t,l)=>{const g=R,p=oe,y=U,u=se,f=ee,w=ae;return x(),k(w,{ref_key:"dt",ref:n,filters:d.value,"onUpdate:filters":l[1]||(l[1]=v=>d.value=v),value:t.supervisors,dataKey:"id",loading:t.loading,scrollable:"",globalFilterFields:["id","email","name"],paginator:"",rows:10,rowsPerPageOptions:[5,10,25],class:"rounded-md overflow-hidden w-full"},{header:i(()=>[r("div",le,[r("div",re,[t.supervisors?(x(),B("div",te,"Supervisors - "+P(t.supervisors.length),1)):S("",!0)]),F(t.$slots,"header-extra"),a(g,{label:"Export",icon:"pi pi-upload",severity:"info",variant:"outlined",class:"mr-2",onClick:h}),a(u,null,{default:i(()=>[a(p,null,{default:i(()=>l[2]||(l[2]=[r("i",{class:"pi pi-search"},null,-1)])),_:1}),a(y,{modelValue:d.value.global.value,"onUpdate:modelValue":l[0]||(l[0]=v=>d.value.global.value=v),placeholder:"Search"},null,8,["modelValue"])]),_:1})])]),empty:i(()=>l[3]||(l[3]=[O(" No supervisors found. ")])),loading:i(()=>l[4]||(l[4]=[O(" Loading supervisors data. Please wait. ")])),default:i(()=>[a(f,{field:"id",header:"ID",sortable:""}),a(f,{field:"email",header:"Supervisor Email",sortable:""}),a(f,{field:"name",header:"Name",sortable:""}),a(f,{frozen:!0,alignFrozen:"right",exportable:!1},{body:i(({data:v})=>[F(t.$slots,"actions",{row:v})]),_:3})]),_:3},8,["filters","value","loading"])}}}),ne={class:"flex-grow min-w-0 pb-4 mb-4 bg-white rounded-md border"},de={class:"p-4 text-heading-3-semibold"},ue={class:"flex gap-2"},ce={class:"flex gap-2"},me={class:"flex flex-col gap-1"},pe={class:"flex flex-col gap-2"},ve={class:"flex gap-2 justify-end"},fe={class:"flex flex-col gap-1"},ge={class:"flex flex-col gap-2"},ye={class:"flex gap-2 justify-end"},Ae=T({__name:"OrganizationEditPage",setup(j){const n=H(),d=J(),$=Q(),h=K(),t=m(null),l=m(!1);async function g(){try{l.value=!0;const{data:o}=await _.getOrganizationById(Number(d.params.id));t.value=o}catch(o){n.add({severity:"error",summary:o.response.data.error,life:2e3})}finally{l.value=!1}}W(()=>{g()});const p=m(!1),y=m(""),u=m(!1);async function f(){u.value=!0;try{const{data:o}=await _.addSchoolToOrganization(Number(d.params.id),Number(y.value));n.add({severity:"success",summary:o.message,life:2e3}),window.location.reload(),p.value=!1}catch(o){n.add({severity:"error",summary:o.response.data.error,detail:o,life:2e3})}finally{u.value=!1}}function w(o){h.require({message:"Are you sure you want to remove school?",header:"Remove school",icon:"pi pi-exclamation-triangle",rejectProps:{label:"Cancel",severity:"secondary",outlined:!0},acceptProps:{label:"Remove",severity:"danger"},accept:()=>{v(o)}})}async function v(o){try{const{data:e}=await _.removeSchoolFromOrganization(Number(d.params.id),o);await g(),n.add({severity:"success",summary:e.message,life:2e3})}catch(e){n.add({severity:"error",summary:e.response.data.error,detail:e,life:2e3})}}const b=m(!1),C=m("");async function E(){u.value=!0;try{const{data:o}=await _.addSupervisorToOrganization(Number(d.params.id),Number(C.value));n.add({severity:"success",summary:o.message,life:2e3}),window.location.reload(),b.value=!1}catch(o){n.add({severity:"error",summary:o.response.data.error,detail:o,life:2e3})}finally{u.value=!1}}function M(o){h.require({message:"Are you sure you want to remove supervisor?",header:"Remove supervisor",icon:"pi pi-exclamation-triangle",rejectProps:{label:"Cancel",severity:"secondary",outlined:!0},acceptProps:{label:"Remove",severity:"danger"},accept:()=>{q(o)}})}async function q(o){try{const{data:e}=await _.removeSupervisorFromOrganization(Number(d.params.id),o);await g(),n.add({severity:"success",summary:e.message,life:2e3})}catch(e){n.add({severity:"error",summary:e.response.data.error,detail:e,life:2e3})}}return(o,e)=>{var D;const c=R,V=U,N=Y,I=X;return x(),B(G,null,[r("div",ne,[r("div",de,P((D=t.value)==null?void 0:D.name),1),t.value?(x(),k(ie,{key:0,supervisors:t.value.supervisors,loading:l.value},{"header-extra":i(()=>[a(c,{label:"Add",icon:"pi pi-plus",severity:"success",variant:"outlined",class:"mr-2",onClick:e[0]||(e[0]=s=>b.value=!0)})]),actions:i(({row:s})=>[r("div",ue,[a(c,{icon:"pi pi-trash",outlined:"",rounded:"",severity:"danger",onClick:z=>M(s.id)},null,8,["onClick"])])]),_:1},8,["supervisors","loading"])):S("",!0),t.value?(x(),k(A(Z),{key:1,schools:t.value.schools,loading:l.value},{"header-extra":i(()=>[a(c,{label:"Add",icon:"pi pi-plus",severity:"success",variant:"outlined",class:"mr-2",onClick:e[1]||(e[1]=s=>p.value=!0)})]),actions:i(({row:s})=>[r("div",ce,[a(c,{icon:"pi pi-trash",outlined:"",rounded:"",severity:"danger",onClick:z=>w(s.id)},null,8,["onClick"]),a(c,{icon:"pi pi-angle-right",outlined:"",rounded:"",severity:"info",onClick:z=>A($).push({name:"admin-school",params:{id:s.id}})},null,8,["onClick"])])]),_:1},8,["schools","loading"])):S("",!0)]),a(I,{visible:p.value,"onUpdate:visible":e[4]||(e[4]=s=>p.value=s),modal:"",draggable:!1,class:"m-4 max-w-md",header:"Add school by ID"},{default:i(()=>[r("div",me,[r("div",pe,[e[8]||(e[8]=r("div",{class:"font-bold text-sm"},"School ID",-1)),a(V,{key:"name",type:"text",modelValue:y.value,"onUpdate:modelValue":e[2]||(e[2]=s=>y.value=s)},null,8,["modelValue"])]),a(N),r("div",ve,[a(c,{label:"Cancel",severity:"secondary",onClick:e[3]||(e[3]=s=>p.value=!1)}),a(c,{label:"Add",onClick:f,loading:u.value,disabled:u.value},null,8,["loading","disabled"])])])]),_:1},8,["visible"]),a(I,{visible:b.value,"onUpdate:visible":e[7]||(e[7]=s=>b.value=s),modal:"",draggable:!1,class:"m-4 max-w-md",header:"Add supervisor by ID"},{default:i(()=>[r("div",fe,[r("div",ge,[e[9]||(e[9]=r("div",{class:"font-bold text-sm"},"Supervisor ID",-1)),a(V,{key:"name",type:"text",modelValue:C.value,"onUpdate:modelValue":e[5]||(e[5]=s=>C.value=s)},null,8,["modelValue"])]),a(N),r("div",ye,[a(c,{label:"Cancel",severity:"secondary",onClick:e[6]||(e[6]=s=>b.value=!1)}),a(c,{label:"Add",onClick:E,loading:u.value,disabled:u.value},null,8,["loading","disabled"])])])]),_:1},8,["visible"])],64)}}});export{Ae as default};
