import{b as x,aa as M,ab as U,u as B,r as c,E as I,o as u,p as y,D as $,j as f,t as N,h as m,w as D,L as S,f as T,e as j,g as q,c as L,i as v,q as V,v as R}from"./index-OPmzM71e.js";import{_ as A}from"./ClassesTable.vue_vue_type_script_setup_true_lang-DpQ2ZD_S.js";import{C as k}from"./classApi-D7ECTSva.js";import{m as F}from"./mapClassFromDto-DgC5mjEL.js";import{s as P}from"./index-DRDFAob1.js";import{s as z}from"./index-y66fLmIk.js";import"./index-KlUxpl9U.js";import"./index-CH7amLO5.js";import"./index-0vmajm6r.js";import"./index-WPnT3Nz4.js";import"./index-CR1osQc6.js";import"./index-BNhW59mc.js";import"./index-D4eOrBlW.js";import"./index-a7tscP-N.js";import"./index-C9mcwbj8.js";import"./index-Bbywy24T.js";import"./index-LTZ0Oj9i.js";const G={class:"flex flex-col gap-1"},H={class:"flex flex-col"},J={class:"font-bold text-sm mb-1"},K={class:"flex gap-2 justify-end"},O=x({__name:"EditClassDialog",props:M({selectedClass:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(b){const n=U(b,"modelValue"),i=b,d=B(),t=c(""),s=c(!1);I(()=>i.selectedClass,e=>{t.value="",e&&(t.value=e.name)},{immediate:!0});async function g(){s.value=!0;try{const{data:e}=await k.createClass(t.value);window.location.reload(),d.add({severity:"success",summary:e.message,life:2e3}),n.value=!1}catch(e){d.add({severity:"error",summary:e.response.data.error,detail:e,life:2e3})}finally{s.value=!1}}async function C(){if(i.selectedClass){s.value=!0;try{const{data:e}=await k.updateClassById(i.selectedClass.id,t.value);window.location.reload(),d.add({severity:"success",summary:e.message,life:2e3}),n.value=!1}catch(e){d.add({severity:"error",summary:e.response.data.error,detail:e,life:2e3})}finally{s.value=!1}}}return(e,o)=>{const _=z,l=P,r=D,p=S;return u(),y(p,{visible:n.value,"onUpdate:visible":o[2]||(o[2]=a=>n.value=a),modal:"",draggable:!1,class:"m-4 max-w-md",header:i.selectedClass?e.$t("pages.teacher.editClass"):e.$t("pages.teacher.addClass")},{default:$(()=>[f("div",G,[f("div",H,[f("div",J,N(e.$t("pages.teacher.name")),1),m(_,{type:"text",modelValue:t.value,"onUpdate:modelValue":o[0]||(o[0]=a=>t.value=a)},null,8,["modelValue"])]),m(l),f("div",K,[m(r,{label:e.$t("pages.teacher.cancel"),severity:"secondary",onClick:o[1]||(o[1]=a=>n.value=!1)},null,8,["label"]),i.selectedClass==null?(u(),y(r,{key:0,label:e.$t("pages.teacher.create"),onClick:g,loading:s.value,disabled:s.value},null,8,["label","loading","disabled"])):(u(),y(r,{key:1,label:e.$t("pages.teacher.save"),onClick:C,loading:s.value,disabled:s.value},null,8,["label","loading","disabled"]))])])]),_:1},8,["visible","header"])}}}),Q={class:"flex-grow min-w-0 pb-4 mb-4 bg-white rounded-md border"},W={class:"flex gap-2"},ve=x({__name:"ClassesPage",setup(b){const n=B(),i=R(),d=T(),{userInfo:t}=j(d),s=c(!1),g=c(null);function C(l){s.value=!0,g.value=l}const e=c([]),o=c(!1);async function _(){try{o.value=!0;const{data:l}=await k.getClasses();e.value=(l==null?void 0:l.map(F))??[]}catch(l){n.add({severity:"error",summary:l.response.data.error,life:2e3})}finally{o.value=!1}}return q(()=>{_()}),(l,r)=>{const p=D;return u(),L("div",Q,[m(v(A),{classes:e.value,loading:o.value},{"header-extra":$(()=>{var a;return[((a=v(t))==null?void 0:a.user_type)=="teacher"?(u(),y(p,{key:0,label:l.$t("pages.teacher.addClass"),icon:"pi pi-plus",variant:"outlined",class:"mr-2",onClick:r[0]||(r[0]=h=>C(null))},null,8,["label"])):V("",!0)]}),actions:$(({row:a})=>{var h;return[f("div",W,[((h=v(t))==null?void 0:h.user_type)=="teacher"?(u(),y(p,{key:0,icon:"pi pi-pencil",outlined:"",rounded:"",severity:"warn",onClick:E=>C(a)},null,8,["onClick"])):V("",!0),m(p,{icon:"pi pi-angle-right",outlined:"",rounded:"",severity:"info",onClick:E=>{var w;return v(i).push({name:((w=v(t))==null?void 0:w.user_type)=="teacher"?"teacher-class":"school-class",params:{id:a.id}})}},null,8,["onClick"])])]}),_:1},8,["classes","loading"]),m(O,{"model-value":s.value,"onUpdate:modelValue":r[1]||(r[1]=a=>s.value=a),"selected-class":g.value},null,8,["model-value","selected-class"])])}}});export{ve as default};
