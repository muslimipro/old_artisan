import{b as w,aa as D,ab as E,u as V,r as u,E as M,o as g,p as b,D as h,j as p,t as U,h as i,w as x,L as I,f as S,e as T,g as j,c as L,i as _,v as N}from"./index-AClBedbW.js";import{_ as R}from"./ClassesTable.vue_vue_type_script_setup_true_lang-DBS2lfxC.js";import{C as $}from"./classApi-C6Mqn5GW.js";import{m as q}from"./mapClassFromDto-BHXsJaNm.js";import{s as A}from"./index-CYJwprTh.js";import{s as F}from"./index-CKslPvHa.js";import"./index-eMhY5NLX.js";import"./index-BqfOP99U.js";import"./index-XWd1g6Xq.js";import"./index-DDx-e1KX.js";import"./index-EYPUebmY.js";import"./index-3LekTigX.js";import"./index-Cz8lbA_9.js";import"./index-NBixiio1.js";import"./index-CRBI1kF9.js";import"./index-r2exBSIy.js";import"./index-BAEmVBEP.js";const P={class:"flex flex-col gap-1"},z={class:"flex flex-col"},G={class:"font-bold text-sm mb-1"},H={class:"flex gap-2 justify-end"},J=w({__name:"EditClassDialog",props:D({selectedClass:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(C){const n=E(C,"modelValue"),d=C,c=V(),o=u(""),s=u(!1);M(()=>d.selectedClass,e=>{o.value="",e&&(o.value=e.name)},{immediate:!0});async function v(){s.value=!0;try{const{data:e}=await $.createClass(o.value);window.location.reload(),c.add({severity:"success",summary:e.message,life:2e3}),n.value=!1}catch(e){c.add({severity:"error",summary:e.response.data.error,detail:e,life:2e3})}finally{s.value=!1}}async function f(){if(d.selectedClass){s.value=!0;try{const{data:e}=await $.updateClassById(d.selectedClass.id,o.value);window.location.reload(),c.add({severity:"success",summary:e.message,life:2e3}),n.value=!1}catch(e){c.add({severity:"error",summary:e.response.data.error,detail:e,life:2e3})}finally{s.value=!1}}}return(e,l)=>{const y=F,a=A,r=x,m=I;return g(),b(m,{visible:n.value,"onUpdate:visible":l[2]||(l[2]=t=>n.value=t),modal:"",draggable:!1,class:"m-4 max-w-md",header:d.selectedClass?e.$t("pages.teacher.editClass"):e.$t("pages.teacher.addClass")},{default:h(()=>[p("div",P,[p("div",z,[p("div",G,U(e.$t("pages.teacher.name")),1),i(y,{type:"text",modelValue:o.value,"onUpdate:modelValue":l[0]||(l[0]=t=>o.value=t)},null,8,["modelValue"])]),i(a),p("div",H,[i(r,{label:e.$t("pages.teacher.cancel"),severity:"secondary",onClick:l[1]||(l[1]=t=>n.value=!1)},null,8,["label"]),d.selectedClass==null?(g(),b(r,{key:0,label:e.$t("pages.teacher.create"),onClick:v,loading:s.value,disabled:s.value},null,8,["label","loading","disabled"])):(g(),b(r,{key:1,label:e.$t("pages.teacher.save"),onClick:f,loading:s.value,disabled:s.value},null,8,["label","loading","disabled"]))])])]),_:1},8,["visible","header"])}}}),K={class:"flex-grow min-w-0 pb-4 mb-4 bg-white rounded-md border"},O={class:"flex gap-2"},me=w({__name:"ClassesPage",setup(C){const n=V(),d=N(),c=S(),{userInfo:o}=T(c),s=u(!1),v=u(null);function f(a){s.value=!0,v.value=a}const e=u([]),l=u(!1);async function y(){try{l.value=!0;const{data:a}=await $.getClasses();e.value=(a==null?void 0:a.map(q))??[]}catch(a){n.add({severity:"error",summary:a.response.data.error,life:2e3})}finally{l.value=!1}}return j(()=>{y()}),(a,r)=>{const m=x;return g(),L("div",K,[i(_(R),{classes:e.value,loading:l.value},{"header-extra":h(()=>[i(m,{label:a.$t("pages.teacher.addClass"),icon:"pi pi-plus",variant:"outlined",class:"mr-2",onClick:r[0]||(r[0]=t=>f(null))},null,8,["label"])]),actions:h(({row:t})=>[p("div",O,[i(m,{icon:"pi pi-pencil",outlined:"",rounded:"",severity:"warn",onClick:B=>f(t)},null,8,["onClick"]),i(m,{icon:"pi pi-angle-right",outlined:"",rounded:"",severity:"info",onClick:B=>{var k;return _(d).push({name:((k=_(o))==null?void 0:k.user_type)=="teacher"?"teacher-class":"school-class",params:{id:t.id}})}},null,8,["onClick"])])]),_:1},8,["classes","loading"]),i(J,{"model-value":s.value,"onUpdate:modelValue":r[1]||(r[1]=t=>s.value=t),"selected-class":v.value},null,8,["model-value","selected-class"])])}}});export{me as default};
