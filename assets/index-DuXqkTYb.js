import{s as q}from"./index-Dv2Z5Jp_.js";import{s as T}from"./index-C1S6C8oy.js";import{s as A}from"./index-IzOwROKR.js";import{b as k,o as t,c as u,j as o,h as p,x as R,F as V,l as P,p as a,y as $,k as F,t as U,d as W,u as O,r as m,i as r,q as C,e as K,g as M,E as Y,G,H,K as J,C as Q,v as X,w as Z}from"./index-BKHARNaj.js";import{u as ee,a as te}from"./store-BlIEKi6L.js";import{S as se}from"./SimulationView-BxVQdi0-.js";import"./CodeEditorView.vue_vue_type_script_setup_true_lang-CtRnrm_-.js";import{_ as oe}from"./CodeViewer.vue_vue_type_script_setup_true_lang-B0dhWYRf.js";import{L as ne}from"./lessonApi-BD3ZfN5o.js";import{m as le}from"./mapLessonFromDto-De7FAIVI.js";import{m as re}from"./mapUnitFromDto-DVWJHO4f.js";import{U as ie}from"./unitApi-Dhez_8w_.js";import{_ as z,a as ae,b as ue,c as de,d as ce}from"./TeacherReviseViewer.vue_vue_type_style_index_0_scoped_94e5260f_lang-C54fdSlH.js";import{s as pe}from"./index-BTKwQcjg.js";import"./index-BIOeEwIG.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-DUiGxFAo.js";import"./index-CklhTBqg.js";import"./index-D2UfNRXk.js";import"./index-DLOQYNUR.js";import"./index-o2Q_4Jq5.js";import"./transformUnitDtosToPages-hsgZNhAG.js";import"./index-OH5Ko_zB.js";import"./index-Dw05hbtA.js";import"./index-CuVWL5IL.js";const me={class:"rounded-2xl p-6 max-w-2xl mx-auto border border-slate-100 gap-2 flex flex-col"},fe={class:"rounded-xl overflow-clip"},ve=k({__name:"CodeReviseViewer",props:{state:{}},setup(f){const e=f;return(i,n)=>(t(),u("div",me,[n[0]||(n[0]=o("div",{class:"text-overline-small text-neutral600"},"Your answer",-1)),o("div",fe,[p(z,{text:` \`\`\`python
${e.state.answer.code}
\`\`\` `},null,8,["text"])])]))}}),_e={class:"rounded-2xl p-6 max-w-2xl mx-auto border border-slate-100 gap-2 flex flex-col"},ye={class:"space-y-1"},xe={class:"flex flex-wrap items-center gap-2 text-slate-800 bg-slate-50 rounded-xl px-3 py-2"},we={class:"text-slate-800"},he={class:"rounded-xl overflow-clip"},ge=k({__name:"PibodyReviseViewer",props:{state:{}},setup(f){const e=f,i=["A","B","C","D","E","F","8","9"],n=R(()=>e.state.answer.slots.map((d,v)=>({slot:d,index:v})).filter(d=>d.slot!==""));return(d,v)=>{const y=pe;return t(),u("div",_e,[v[0]||(v[0]=o("div",{class:"text-overline-small text-neutral600"},"Your answer",-1)),o("div",ye,[o("div",xe,[(t(!0),u(V,null,P(n.value,c=>(t(),a(y,{key:c.index,class:"font-medium text-slate-500"},{default:$(()=>[F(" Slot "+U(i[c.index])+": ",1),o("span",we,U(c.slot),1)]),_:2},1024))),128))])]),o("div",he,[p(z,{text:` \`\`\`python
${e.state.answer.code}
\`\`\` `},null,8,["text"])])])}}}),be=W("lesson-revise-store",()=>{const f=O(),e=m(null),i=m(!1),n=m([]),d=m(null),v=m(null),y=m(!1),c=m(!1);async function S(x,w){try{i.value=!0;const{data:l}=await ne.getLessonById(x,w);e.value=le(l),await E()}catch(l){f.add({severity:"error",summary:l.response.data.error,life:2e3})}finally{i.value=!1}}async function E(){if(e.value)try{n.value=[];const x=[];e.value.pages.forEach(l=>{l.groups.forEach(h=>{h.units.forEach(g=>{x.push(g.id)})})});const{data:w}=await ie.getUnitsByIdsandLessonId(x,e.value.id);for(const l of w)n.value.push(re(l)),(l.unit_type=="code"||l.unit_type=="pibody")&&(y.value=!0,v.value=ee("emulatorID"),v.value.setCode("")),l.unit_type=="pibody"&&(c.value=!0,d.value=te("emulatorID"),d.value.addNeededModules([]))}catch(x){console.error("Error loading units:",x)}finally{}}return{selectedLesson:e,isLessonLoading:i,units:n,showPibody:c,showCode:y,loadLessonById:S}}),$e={key:1,class:"flex-grow px-4 py-2"},ke=k({__name:"UnitCard",props:{unit:{},loading:{type:Boolean}},setup(f){const e=f;return(i,n)=>{const d=T;return t(),u("div",null,[i.loading?(t(),a(d,{key:0,class:"flex justify-center items-center w-10 h-full"})):(t(),u("div",$e,[e.unit.unitType=="article"?(t(),a(r(ae),{key:0,article:e.unit.content},null,8,["article"])):e.unit.unitType=="options"?(t(),a(r(ue),{key:1,"options-data":e.unit.content,state:e.unit.studentState},null,8,["options-data","state"])):e.unit.unitType=="open"?(t(),a(r(de),{key:2,state:e.unit.studentState},null,8,["state"])):e.unit.unitType=="video"?(t(),a(r(ce),{key:3,video:e.unit.content},null,8,["video"])):e.unit.unitType=="code"?(t(),a(r(ve),{key:4,state:e.unit.studentState},null,8,["state"])):e.unit.unitType=="pibody"?(t(),a(r(ge),{key:5,state:e.unit.studentState},null,8,["state"])):C("",!0)]))])}}}),Le={ref:"rootEl",class:"flex flex-col gap-8"},Ce=k({__name:"UnitsView",props:{units:{}},setup(f){return(e,i)=>(t(),u("div",Le,[(t(!0),u(V,null,P(e.units,n=>(t(),a(ke,{key:n.id,unit:n},null,8,["unit"]))),128))],512))}}),Se={class:"h-screen flex flex-col items-center overflow-hidden relative bg-white"},Ee={class:"fixed top-0 left-0 right-0 z-50 bg-white border-b border-gray-200 max-w-[1920px] mx-auto"},De={class:"flex justify-between items-center w-full min-h-16 px-8 gap-8"},Be={class:"flex items-center gap-4"},Ie={key:0,class:"flex flex-grow max-w-screen-lg items-center gap-4"},Ue={class:"flex-1 overflow-y-auto mt-16 mb-0 w-full"},Te={key:1,class:"flex justify-center"},Re={key:2},Ve={key:0,class:"absolute left-0 top-1/2 -translate-y-1/2"},Pe={class:"relative h-full"},ze={class:"absolute -right-0 top-1/2 -translate-y-1/2 w-5 h-10 z-10"},Ne={key:1,class:"absolute right-0 top-1/2 -translate-y-1/2"},je={class:"relative h-full"},qe={class:"absolute -left-0 top-1/2 -translate-y-1/2 w-5 h-10 z-10"},pt=k({__name:"LessonRevisePage",setup(f){const e=Q(),i=X(),n=be(),{units:d,isLessonLoading:v,selectedLesson:y,showPibody:c,showCode:S}=K(n),{loadLessonById:E}=n;function x(){var L;((L=y.value)==null?void 0:L.lessonType)=="module"?i.push("/v2/docs"):e.query.route_id&&e.query.route_id!=""?i.push("/v2/route/"+e.query.route_id):i.push("/v2/home")}const w=m(window.innerWidth),l=m(16),h=m(!0),g=m(!0);function D(){if(w.value=window.innerWidth,w.value<=1300){l.value=16;return}const s=452-(w.value-1024)/2;l.value=s>16?s:16}M(()=>{D(),E(Number(e.params.id),(e.query.route_id??"").toString()),window.addEventListener("resize",D)}),Y(()=>{window.removeEventListener("resize",D)});const B=R(()=>w.value<=1920?{}:"calc((-100vw + 1920px) / 2)");return(L,s)=>{const b=Z,N=A,j=T,I=q;return t(),u("div",Se,[o("div",Ee,[o("div",De,[o("div",Be,[p(b,{icon:"pi pi-times",variant:"text",severity:"contrast",onClick:x})]),r(y)?(t(),u("div",Ie,[p(N,{value:100,"show-value":!1,class:"w-full rounded-full h-3"})])):C("",!0),s[7]||(s[7]=o("div",{class:"w-10"},null,-1))])]),o("div",Ue,[o("div",{class:"w-full h-full max-w-screen-lg mx-auto py-8",style:G({paddingLeft:l.value+"px",paddingRight:l.value+"px"})},[r(v)?(t(),a(j,{key:0,class:"flex justify-center"})):r(y)?(t(),u("div",Re,[p(Ce,{units:r(d)},null,8,["units"])])):(t(),u("div",Te,"No lesson found"))],4)]),r(c)?(t(),u("div",Ve,[p(b,{icon:"pi pi-microchip",severity:"secondary",onClick:s[0]||(s[0]=_=>h.value=!0),class:"w-8 rounded-tl-none rounded-bl-none rounded-tr-lg rounded-br-lg mt-16"}),p(I,{visible:h.value,"onUpdate:visible":s[2]||(s[2]=_=>h.value=_),modal:!1,dismissable:!1,closeOnEscape:!1,class:"h-[calc(100vh-64px)] w-fit mt-16",pt:{root:{style:`right: ${B.value}`}}},{header:$(()=>s[8]||(s[8]=[o("div",null,null,-1)])),container:$(()=>[o("div",Pe,[o("div",ze,[p(b,{icon:"pi pi-chevron-left",severity:"secondary",onClick:s[1]||(s[1]=_=>h.value=!1),class:"w-5 rounded-tl-lg rounded-bl-lg rounded-tr-none rounded-br-none"})]),(t(),a(r(se),{id:"emulatorID",key:"emulatorID",class:"w-full",horizontal:!1,autoPut:!0}))])]),_:1},8,["visible","pt"])])):C("",!0),r(S)?(t(),u("div",Ne,[p(b,{icon:"pi pi-code",severity:"secondary",onClick:s[3]||(s[3]=_=>g.value=!0),class:"w-8 rounded-tl-lg rounded-bl-lg rounded-tr-none rounded-br-none mt-16"}),p(I,{visible:g.value,"onUpdate:visible":s[6]||(s[6]=_=>g.value=_),header:"Drawer",modal:!1,dismissable:!1,closeOnEscape:!1,position:"right",class:"h-[calc(100vh-64px)] w-[452px] mt-16",pt:{root:{style:`left: ${B.value}`}}},{header:$(()=>s[9]||(s[9]=[o("div",null,null,-1)])),container:$(()=>[o("div",je,[o("div",qe,[p(b,{icon:"pi pi-chevron-right",severity:"secondary",onClick:s[4]||(s[4]=_=>g.value=!1),class:"w-5 rounded-tl-none rounded-bl-none rounded-tr-lg rounded-br-lg"})]),(t(),a(J,null,[(t(),a(r(oe),{id:"emulatorID",key:"emulatorID",connectbuttons:r(c),"onUpdate:connectbuttons":s[5]||(s[5]=_=>H(c)?c.value=_:null)},null,8,["connectbuttons"]))],1024))])]),_:1},8,["visible","pt"])])):C("",!0)])}}});export{pt as default};
