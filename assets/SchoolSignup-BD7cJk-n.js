import{J as q,b as W,a as G,u as K,r,x as O,o as d,c as y,j as e,h as l,i as w,k as p,D as g,p as k,q as C,t as n,T as Q,F as X,v as Y,w as Z,L as ee}from"./index-CrrKimau.js";import{s as se}from"./index-CVUgYmaA.js";import{h as ae,z as S,s as te}from"./index-BXPBdHnN.js";import{s as le}from"./index-sf2f6Ydm.js";import{s as ie}from"./index-DgmsQzkT.js";import{s as oe}from"./index-DL1ViM7W.js";import{_ as ne}from"./LocaleSelectButton.vue_vue_type_script_setup_true_lang-Cxnwygte.js";import{L as re}from"./logo-D1-3uCnC.js";import{_ as de}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-4_fBhWkb.js";import"./index-Cxw2yqN5.js";import"./index-In5iuvip.js";import"./language-DYQF8nnT.js";const N={checkActivation:ce,createSchoolByCode:ue};async function ce(h){try{return await q.post("/v2/activation/check",null,{params:{code:h}})}catch(a){throw console.log(a),a}}async function ue(h,a,u,I,c){return await q.post("/v2/school/register",{code:h,title:a,address:u,email:I,force_type_change:c,country:""})}const me={class:"h-screen bg-white flex flex-col overflow-hidden relative"},ve={class:"w-full h-full flex justify-center gap-6 max-w-[1440px] p-6 mx-auto"},pe={class:"hidden lg:flex flex-col w-full max-w-[684px] justify-between bg-primary rounded-2xl p-10"},ge={class:"flex items-center gap-2"},fe={class:"w-full max-w-[684px] mx-auto flex items-center justify-center relative overflow-hidden"},ye={class:"flex gap-1"},he={class:"text-heading-3-semibold mb-2"},be={class:"text-body-large-regular mb-8"},xe={key:0,class:"w-full"},_e={class:"text-body-medium-regular mb-1"},we={key:1},ke={class:"text-body-medium-regular mb-1"},Ce={class:"mb-6"},Se={class:"text-body-medium-regular mb-1"},Ie={class:"mb-6"},$e={class:"text-body-medium-regular mb-1"},Ve={class:"mb-6"},Te={key:2},Ae={class:"flex gap-2 justify-end"},Be=W({__name:"SchoolSignup",setup(h){const{t:a}=G(),u=K(),I=Y(),c=r(!1),V=r(!1),b=r(""),T=r(!1),m=r(!1);async function z(){c.value=!0;try{const{data:s}=await N.checkActivation(b.value);V.value=s.is_valid,V.value?(u.add({severity:"success",summary:a("pages.login.codeIsValid"),life:2e3}),A()):u.add({severity:"error",summary:a("pages.login.codeIsInvalid"),life:2e3})}catch(s){u.add({severity:"error",summary:s,life:2e3})}finally{c.value=!1}}const o=r(0),x=O(()=>[{id:0,title:a("pages.login.enterActivationCode"),description:a("pages.login.weWillVerifyActivationCode")},{id:1,title:a("pages.login.enterSchoolInfo"),description:a("pages.login.pleaseProvideInfo")},{id:2,title:a("pages.login.registrationSuccess"),description:a("pages.login.weHaveSentLoginDetails")}]);function A(){o.value<x.value.length-1&&o.value++}const f=r(!1),F=r({name:"",address:"",email:""}),R=ae(S.object({name:S.string().min(1,{message:a("pages.login.nameIsRequired")}).max(100,{message:a("pages.login.max100chars")}),address:S.string().min(1,{message:a("pages.login.addressIsRequired")}).max(100,{message:a("pages.login.max100chars")}),email:S.string().email({message:a("pages.settings.emailInvalid")}).min(1,{message:a("pages.login.emailIsRequired")}).max(100,{message:a("pages.login.max100chars")})})),E=async s=>{if(!f.value&&s.valid){f.value=!0;try{await N.createSchoolByCode(b.value,s.states.name.value,s.states.address.value,s.states.email.value,T.value),A()}catch(t){t.status==400&&!m.value?m.value=!0:u.add({severity:"error",summary:t.response.data.error,life:3e3})}finally{f.value=!1}}},B=r(null);async function M(){var s;T.value=!0,m.value=!1,await((s=B.value)==null?void 0:s.submit())}return(s,t)=>{const U=oe,v=Z,_=ie,$=le,H=te,J=se,P=ee;return d(),y(X,null,[e("div",me,[e("div",ve,[e("div",pe,[e("div",ge,[l(U,{src:w(re),width:"40"},null,8,["src"]),t[5]||(t[5]=e("p",{class:"text-heading-2-bold text-black"},"Artisan",-1))]),t[6]||(t[6]=e("div",{class:"text-display-small-bold text-neutral900"},[p(" Building"),e("br"),e("span",{class:"text-white"},"creative"),e("br"),p(" learners who"),e("br"),p(" love to grow ")],-1))]),e("div",fe,[l(w(ne),{class:"absolute top-0 left-1/2 -translate-x-1/2"}),l(Q,{name:"slide-fade",mode:"out-in",class:"w-full max-w-[540px] flex"},{default:g(()=>[(d(),y("div",{key:o.value,class:"w-full flex flex-col"},[e("div",ye,[o.value>0&&o.value!=x.value.length-1?(d(),k(v,{key:0,icon:"pi pi-chevron-left",class:"h-6 w-6",severity:"secondary",variant:"text",onClick:t[0]||(t[0]=i=>o.value--)})):C("",!0),e("div",he,n(x.value[o.value].title),1)]),e("div",be,n(x.value[o.value].description),1),o.value===0?(d(),y("div",xe,[e("div",_e,n(s.$t("pages.login.activationCode")),1),l(_,{modelValue:b.value,"onUpdate:modelValue":t[1]||(t[1]=i=>b.value=i),type:"text",fluid:"",class:"mb-6"},null,8,["modelValue"]),l(v,{label:s.$t("pages.login.continue"),class:"w-full h-12",onClick:z,loading:c.value,disabled:c.value},null,8,["label","loading","disabled"])])):o.value===1?(d(),y("div",we,[l(H,{ref_key:"form",ref:B,initialValues:F.value,resolver:w(R),onSubmit:E},{default:g(i=>{var j,D,L;return[e("div",ke,n(s.$t("pages.login.schoolName")),1),e("div",Ce,[l(_,{id:"name",name:"name",type:"text",fluid:""}),(j=i.name)!=null&&j.invalid?(d(),k($,{key:0,severity:"error",size:"small",variant:"simple"},{default:g(()=>[p(n(i.name.error.message),1)]),_:2},1024)):C("",!0)]),e("div",Se,n(s.$t("pages.login.schoolAddress")),1),e("div",Ie,[l(_,{id:"address",name:"address",type:"text",fluid:""}),(D=i.address)!=null&&D.invalid?(d(),k($,{key:0,severity:"error",size:"small",variant:"simple"},{default:g(()=>[p(n(i.address.error.message),1)]),_:2},1024)):C("",!0)]),e("div",$e,n(s.$t("pages.login.schoolEmail")),1),e("div",Ve,[l(_,{id:"email",name:"email",type:"text",fluid:""}),(L=i.email)!=null&&L.invalid?(d(),k($,{key:0,severity:"error",size:"small",variant:"simple"},{default:g(()=>[p(n(i.email.error.message),1)]),_:2},1024)):C("",!0)]),l(v,{label:s.$t("pages.login.registerSchool"),type:"submit",class:"w-full h-12",loading:f.value,disabled:f.value},null,8,["label","loading","disabled"])]}),_:1},8,["initialValues","resolver"])])):(d(),y("div",Te,[l(v,{label:s.$t("pages.login.goToLogin"),class:"w-full h-12",onClick:t[2]||(t[2]=i=>w(I).replace({name:"login"})),loading:c.value,disabled:c.value},null,8,["label","loading","disabled"])]))]))]),_:1})])])]),l(P,{visible:m.value,"onUpdate:visible":t[4]||(t[4]=i=>m.value=i),modal:"",header:"Account Type Change",class:"m-4 max-w-md"},{default:g(()=>[t[7]||(t[7]=e("div",{class:"flex flex-col gap-1"},[e("div",{class:"flex justify-center text-body-medium-regular"},n(`This account already exists.
        If you continue, its type will be changed to School Manager.
        Do you want to proceed?`))],-1)),l(J),e("div",Ae,[l(v,{label:s.$t("pages.teacher.cancel"),severity:"secondary",onClick:t[3]||(t[3]=i=>m.value=!1)},null,8,["label"]),l(v,{label:s.$t("continue"),type:"submit",onClick:M},null,8,["label"])])]),_:1},8,["visible"])],64)}}}),Pe=de(Be,[["__scopeId","data-v-19f6bc45"]]);export{Pe as default};
