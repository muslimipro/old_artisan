import{M as Bu,o as ue,c as je,j as se,m as ke,B as Uu,s as gl,w as hr,N as Vu,O as yl,P as xn,l as zr,t as yt,h as re,n as Pn,D as st,p as ot,Q as Mr,F as On,R as Hu,S as Qa,V as Yu,W as Zt,X as qa,q as At,k as Bo,Y as Xu,J as co,d as $u,u as Wu,e as Zr,r as me,Z as Ku,_ as zu,$ as Zu,a0 as Ju,b as fo,z as _i,i as he,v as ml,a1 as ha,g as El,a2 as Qu,C as va,L as pa,E as bl,I as qu}from"./index-Dhd596fX.js";import{s as ec}from"./index-aDwi1kfG.js";import{s as ga}from"./index-DK1FbR08.js";import{s as tc}from"./index-DQSFBBPC.js";import{s as Sl}from"./index-BqPnD5xZ.js";import{s as nc}from"./index-Cfe88MbM.js";import{s as Cl}from"./index-TCX7xrgA.js";import{s as xl}from"./index-i9viJsyy.js";import{_ as rc}from"./MainHeader.vue_vue_type_script_setup_true_lang-DRihCRCK.js";import{C as Vi}from"./cloudStorageApi-SxU8X_LV.js";import{_ as ic}from"./EditLocaleSelector.vue_vue_type_script_setup_true_lang-CsLAgVtI.js";import{u as Pl}from"./useLocaleStore-BPdRXCxy.js";import{d as ya}from"./defaultConfirmDeleteOptions-BHu3VNzp.js";import{R as di,m as oc}from"./mapRouteFromDto-NJ9SRlUG.js";import{L as Gn}from"./lessonApi-CgtFWtPy.js";import{g as ac}from"./groupLessonsByLevelAndType-B0Iu0b2E.js";import{s as sc}from"./index-BWpdM_Rl.js";import{s as lc}from"./index-BygXRAOh.js";import{s as uc}from"./index-duF6WyRC.js";import{s as cc}from"./index-B9x1KOKv.js";import{A as dc}from"./user-B459fZOf.js";import{A as es}from"./lessonType-v5Tmr0TL.js";import{_ as ma}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-YWwT92yc.js";import"./index-mLwmMvJS.js";import"./index-DqDCjQGO.js";import"./logo-D1-3uCnC.js";import"./language-DYQF8nnT.js";import"./mapLessonFromDto-D3cEBYeg.js";import"./mapUnitFromDto-DVWJHO4f.js";import"./transformUnitDtosToPages-hsgZNhAG.js";import"./index-BOxY141j.js";var Tl={name:"UploadIcon",extends:Bu};function fc(o,a,n,i,e,t){return ue(),je("svg",ke({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o.pti()),a[0]||(a[0]=[se("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M6.58942 9.82197C6.70165 9.93405 6.85328 9.99793 7.012 10C7.17071 9.99793 7.32234 9.93405 7.43458 9.82197C7.54681 9.7099 7.61079 9.55849 7.61286 9.4V2.04798L9.79204 4.22402C9.84752 4.28011 9.91365 4.32457 9.98657 4.35479C10.0595 4.38502 10.1377 4.40039 10.2167 4.40002C10.2956 4.40039 10.3738 4.38502 10.4467 4.35479C10.5197 4.32457 10.5858 4.28011 10.6413 4.22402C10.7538 4.11152 10.817 3.95902 10.817 3.80002C10.817 3.64102 10.7538 3.48852 10.6413 3.37602L7.45127 0.190618C7.44656 0.185584 7.44176 0.180622 7.43687 0.175736C7.32419 0.063214 7.17136 0 7.012 0C6.85264 0 6.69981 0.063214 6.58712 0.175736C6.58181 0.181045 6.5766 0.186443 6.5715 0.191927L3.38282 3.37602C3.27669 3.48976 3.2189 3.6402 3.22165 3.79564C3.2244 3.95108 3.28746 4.09939 3.39755 4.20932C3.50764 4.31925 3.65616 4.38222 3.81182 4.38496C3.96749 4.3877 4.11814 4.33001 4.23204 4.22402L6.41113 2.04807V9.4C6.41321 9.55849 6.47718 9.7099 6.58942 9.82197ZM11.9952 14H2.02883C1.751 13.9887 1.47813 13.9228 1.22584 13.8061C0.973545 13.6894 0.746779 13.5241 0.558517 13.3197C0.370254 13.1154 0.22419 12.876 0.128681 12.6152C0.0331723 12.3545 -0.00990605 12.0775 0.0019109 11.8V9.40005C0.0019109 9.24092 0.065216 9.08831 0.1779 8.97579C0.290584 8.86326 0.443416 8.80005 0.602775 8.80005C0.762134 8.80005 0.914966 8.86326 1.02765 8.97579C1.14033 9.08831 1.20364 9.24092 1.20364 9.40005V11.8C1.18295 12.0376 1.25463 12.274 1.40379 12.4602C1.55296 12.6463 1.76817 12.7681 2.00479 12.8H11.9952C12.2318 12.7681 12.447 12.6463 12.5962 12.4602C12.7453 12.274 12.817 12.0376 12.7963 11.8V9.40005C12.7963 9.24092 12.8596 9.08831 12.9723 8.97579C13.085 8.86326 13.2378 8.80005 13.3972 8.80005C13.5565 8.80005 13.7094 8.86326 13.8221 8.97579C13.9347 9.08831 13.998 9.24092 13.998 9.40005V11.8C14.022 12.3563 13.8251 12.8996 13.45 13.3116C13.0749 13.7236 12.552 13.971 11.9952 14Z",fill:"currentColor"},null,-1)]),16)}Tl.render=fc;var hc=function(a){var n=a.dt;return`
.p-fileupload input[type="file"] {
    display: none;
}

.p-fileupload-advanced {
    border: 1px solid `.concat(n("fileupload.border.color"),`;
    border-radius: `).concat(n("fileupload.border.radius"),`;
    background: `).concat(n("fileupload.background"),`;
    color: `).concat(n("fileupload.color"),`;
}

.p-fileupload-header {
    display: flex;
    align-items: center;
    padding: `).concat(n("fileupload.header.padding"),`;
    background: `).concat(n("fileupload.header.background"),`;
    color: `).concat(n("fileupload.header.color"),`;
    border-style: solid;
    border-width: `).concat(n("fileupload.header.border.width"),`;
    border-color: `).concat(n("fileupload.header.border.color"),`;
    border-radius: `).concat(n("fileupload.header.border.radius"),`;
    gap: `).concat(n("fileupload.header.gap"),`;
}

.p-fileupload-content {
    border: 1px solid transparent;
    display: flex;
    flex-direction: column;
    gap: `).concat(n("fileupload.content.gap"),`;
    transition: border-color `).concat(n("fileupload.transition.duration"),`;
    padding: `).concat(n("fileupload.content.padding"),`;
}

.p-fileupload-content .p-progressbar {
    width: 100%;
    height: `).concat(n("fileupload.progressbar.height"),`;
}

.p-fileupload-file-list {
    display: flex;
    flex-direction: column;
    gap: `).concat(n("fileupload.filelist.gap"),`;
}

.p-fileupload-file {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    padding: `).concat(n("fileupload.file.padding"),`;
    border-block-end: 1px solid `).concat(n("fileupload.file.border.color"),`;
    gap: `).concat(n("fileupload.file.gap"),`;
}

.p-fileupload-file:last-child {
    border-block-end: 0;
}

.p-fileupload-file-info {
    display: flex;
    flex-direction: column;
    gap: `).concat(n("fileupload.file.info.gap"),`;
}

.p-fileupload-file-thumbnail {
    flex-shrink: 0;
}

.p-fileupload-file-actions {
    margin-inline-start: auto;
}

.p-fileupload-highlight {
    border: 1px dashed `).concat(n("fileupload.content.highlight.border.color"),`;
}

.p-fileupload-basic {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    justify-content: center;
    gap: `).concat(n("fileupload.basic.gap"),`;
}
`)},vc={root:function(a){var n=a.props;return["p-fileupload p-fileupload-".concat(n.mode," p-component")]},header:"p-fileupload-header",pcChooseButton:"p-fileupload-choose-button",pcUploadButton:"p-fileupload-upload-button",pcCancelButton:"p-fileupload-cancel-button",content:"p-fileupload-content",fileList:"p-fileupload-file-list",file:"p-fileupload-file",fileThumbnail:"p-fileupload-file-thumbnail",fileInfo:"p-fileupload-file-info",fileName:"p-fileupload-file-name",fileSize:"p-fileupload-file-size",pcFileBadge:"p-fileupload-file-badge",fileActions:"p-fileupload-file-actions",pcFileRemoveButton:"p-fileupload-file-remove-button"},pc=Uu.extend({name:"fileupload",theme:hc,classes:vc}),gc={name:"BaseFileUpload",extends:gl,props:{name:{type:String,default:null},url:{type:String,default:null},mode:{type:String,default:"advanced"},multiple:{type:Boolean,default:!1},accept:{type:String,default:null},disabled:{type:Boolean,default:!1},auto:{type:Boolean,default:!1},maxFileSize:{type:Number,default:null},invalidFileSizeMessage:{type:String,default:"{0}: Invalid file size, file size should be smaller than {1}."},invalidFileTypeMessage:{type:String,default:"{0}: Invalid file type, allowed file types: {1}."},fileLimit:{type:Number,default:null},invalidFileLimitMessage:{type:String,default:"Maximum number of files exceeded, limit is {0} at most."},withCredentials:{type:Boolean,default:!1},previewWidth:{type:Number,default:50},chooseLabel:{type:String,default:null},uploadLabel:{type:String,default:null},cancelLabel:{type:String,default:null},customUpload:{type:Boolean,default:!1},showUploadButton:{type:Boolean,default:!0},showCancelButton:{type:Boolean,default:!0},chooseIcon:{type:String,default:void 0},uploadIcon:{type:String,default:void 0},cancelIcon:{type:String,default:void 0},style:null,class:null,chooseButtonProps:{type:null,default:null},uploadButtonProps:{type:Object,default:function(){return{severity:"secondary"}}},cancelButtonProps:{type:Object,default:function(){return{severity:"secondary"}}}},style:pc,provide:function(){return{$pcFileUpload:this,$parentInstance:this}}},Ol={name:"FileContent",hostName:"FileUpload",extends:gl,emits:["remove"],props:{files:{type:Array,default:function(){return[]}},badgeSeverity:{type:String,default:"warn"},badgeValue:{type:String,default:null},previewWidth:{type:Number,default:50},templates:{type:null,default:null}},methods:{formatSize:function(a){var n,i=1024,e=3,t=((n=this.$primevue.config.locale)===null||n===void 0?void 0:n.fileSizeTypes)||["B","KB","MB","GB","TB","PB","EB","ZB","YB"];if(a===0)return"0 ".concat(t[0]);var r=Math.floor(Math.log(a)/Math.log(i)),s=parseFloat((a/Math.pow(i,r)).toFixed(e));return"".concat(s," ").concat(t[r])}},components:{Button:hr,Badge:Vu,TimesIcon:yl}},yc=["alt","src","width"];function mc(o,a,n,i,e,t){var r=xn("Badge"),s=xn("TimesIcon"),l=xn("Button");return ue(!0),je(On,null,zr(n.files,function(u,c){return ue(),je("div",ke({key:u.name+u.type+u.size,class:o.cx("file"),ref_for:!0},o.ptm("file")),[se("img",ke({role:"presentation",class:o.cx("fileThumbnail"),alt:u.name,src:u.objectURL,width:n.previewWidth,ref_for:!0},o.ptm("fileThumbnail")),null,16,yc),se("div",ke({class:o.cx("fileInfo"),ref_for:!0},o.ptm("fileInfo")),[se("div",ke({class:o.cx("fileName"),ref_for:!0},o.ptm("fileName")),yt(u.name),17),se("span",ke({class:o.cx("fileSize"),ref_for:!0},o.ptm("fileSize")),yt(t.formatSize(u.size)),17)],16),re(r,{value:n.badgeValue,class:Pn(o.cx("pcFileBadge")),severity:n.badgeSeverity,unstyled:o.unstyled,pt:o.ptm("pcFileBadge")},null,8,["value","class","severity","unstyled","pt"]),se("div",ke({class:o.cx("fileActions"),ref_for:!0},o.ptm("fileActions")),[re(l,{onClick:function(f){return o.$emit("remove",c)},text:"",rounded:"",severity:"danger",class:Pn(o.cx("pcFileRemoveButton")),unstyled:o.unstyled,pt:o.ptm("pcFileRemoveButton")},{icon:st(function(d){return[n.templates.fileremoveicon?(ue(),ot(Mr(n.templates.fileremoveicon),{key:0,class:Pn(d.class),file:u,index:c},null,8,["class","file","index"])):(ue(),ot(s,ke({key:1,class:d.class,"aria-hidden":"true",ref_for:!0},o.ptm("pcFileRemoveButton").icon),null,16,["class"]))]}),_:2},1032,["onClick","class","unstyled","pt"])],16)],16)}),128)}Ol.render=mc;function bo(o){return Sc(o)||bc(o)||Al(o)||Ec()}function Ec(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bc(o){if(typeof Symbol<"u"&&o[Symbol.iterator]!=null||o["@@iterator"]!=null)return Array.from(o)}function Sc(o){if(Array.isArray(o))return Uo(o)}function fi(o,a){var n=typeof Symbol<"u"&&o[Symbol.iterator]||o["@@iterator"];if(!n){if(Array.isArray(o)||(n=Al(o))||a){n&&(o=n);var i=0,e=function(){};return{s:e,n:function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function(u){throw u},f:e}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var t,r=!0,s=!1;return{s:function(){n=n.call(o)},n:function(){var u=n.next();return r=u.done,u},e:function(u){s=!0,t=u},f:function(){try{r||n.return==null||n.return()}finally{if(s)throw t}}}}function Al(o,a){if(o){if(typeof o=="string")return Uo(o,a);var n={}.toString.call(o).slice(8,-1);return n==="Object"&&o.constructor&&(n=o.constructor.name),n==="Map"||n==="Set"?Array.from(o):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Uo(o,a):void 0}}function Uo(o,a){(a==null||a>o.length)&&(a=o.length);for(var n=0,i=Array(a);n<a;n++)i[n]=o[n];return i}var Ea={name:"FileUpload",extends:gc,inheritAttrs:!1,emits:["select","uploader","before-upload","progress","upload","error","before-send","clear","remove","remove-uploaded-file"],duplicateIEEvent:!1,data:function(){return{uploadedFileCount:0,files:[],messages:[],focused:!1,progress:null,uploadedFiles:[]}},methods:{upload:function(){this.hasFiles&&this.uploader()},onBasicUploaderClick:function(a){a.button===0&&this.$refs.fileInput.click()},onFileSelect:function(a){if(a.type!=="drop"&&this.isIE11()&&this.duplicateIEEvent){this.duplicateIEEvent=!1;return}this.isBasic&&this.hasFiles&&(this.files=[]),this.messages=[],this.files=this.files||[];var n=a.dataTransfer?a.dataTransfer.files:a.target.files,i=fi(n),e;try{for(i.s();!(e=i.n()).done;){var t=e.value;this.isFileSelected(t)||this.validate(t)&&(this.isImage(t)&&(t.objectURL=window.URL.createObjectURL(t)),this.files.push(t))}}catch(r){i.e(r)}finally{i.f()}this.$emit("select",{originalEvent:a,files:this.files}),this.fileLimit&&this.checkFileLimit(),this.auto&&this.hasFiles&&!this.isFileLimitExceeded()&&this.uploader(),a.type!=="drop"&&this.isIE11()?this.clearIEInput():this.clearInputElement()},choose:function(){this.$refs.fileInput.click()},uploader:function(){var a=this;if(this.customUpload)this.fileLimit&&(this.uploadedFileCount+=this.files.length),this.$emit("uploader",{files:this.files}),this.clear();else{var n=new XMLHttpRequest,i=new FormData;this.$emit("before-upload",{xhr:n,formData:i});var e=fi(this.files),t;try{for(e.s();!(t=e.n()).done;){var r=t.value;i.append(this.name,r,r.name)}}catch(s){e.e(s)}finally{e.f()}n.upload.addEventListener("progress",function(s){s.lengthComputable&&(a.progress=Math.round(s.loaded*100/s.total)),a.$emit("progress",{originalEvent:s,progress:a.progress})}),n.onreadystatechange=function(){if(n.readyState===4){var s;a.progress=0,n.status>=200&&n.status<300?(a.fileLimit&&(a.uploadedFileCount+=a.files.length),a.$emit("upload",{xhr:n,files:a.files})):a.$emit("error",{xhr:n,files:a.files}),(s=a.uploadedFiles).push.apply(s,bo(a.files)),a.clear()}},n.open("POST",this.url,!0),this.$emit("before-send",{xhr:n,formData:i}),n.withCredentials=this.withCredentials,n.send(i)}},clear:function(){this.files=[],this.messages=null,this.$emit("clear"),this.isAdvanced&&this.clearInputElement()},onFocus:function(){this.focused=!0},onBlur:function(){this.focused=!1},isFileSelected:function(a){if(this.files&&this.files.length){var n=fi(this.files),i;try{for(n.s();!(i=n.n()).done;){var e=i.value;if(e.name+e.type+e.size===a.name+a.type+a.size)return!0}}catch(t){n.e(t)}finally{n.f()}}return!1},isIE11:function(){return!!window.MSInputMethodContext&&!!document.documentMode},validate:function(a){return this.accept&&!this.isFileTypeValid(a)?(this.messages.push(this.invalidFileTypeMessage.replace("{0}",a.name).replace("{1}",this.accept)),!1):this.maxFileSize&&a.size>this.maxFileSize?(this.messages.push(this.invalidFileSizeMessage.replace("{0}",a.name).replace("{1}",this.formatSize(this.maxFileSize))),!1):!0},isFileTypeValid:function(a){var n=this.accept.split(",").map(function(s){return s.trim()}),i=fi(n),e;try{for(i.s();!(e=i.n()).done;){var t=e.value,r=this.isWildcard(t)?this.getTypeClass(a.type)===this.getTypeClass(t):a.type==t||this.getFileExtension(a).toLowerCase()===t.toLowerCase();if(r)return!0}}catch(s){i.e(s)}finally{i.f()}return!1},getTypeClass:function(a){return a.substring(0,a.indexOf("/"))},isWildcard:function(a){return a.indexOf("*")!==-1},getFileExtension:function(a){return"."+a.name.split(".").pop()},isImage:function(a){return/^image\//.test(a.type)},onDragEnter:function(a){this.disabled||(a.stopPropagation(),a.preventDefault())},onDragOver:function(a){this.disabled||(!this.isUnstyled&&Hu(this.$refs.content,"p-fileupload-highlight"),this.$refs.content.setAttribute("data-p-highlight",!0),a.stopPropagation(),a.preventDefault())},onDragLeave:function(){this.disabled||(!this.isUnstyled&&Qa(this.$refs.content,"p-fileupload-highlight"),this.$refs.content.setAttribute("data-p-highlight",!1))},onDrop:function(a){if(!this.disabled){!this.isUnstyled&&Qa(this.$refs.content,"p-fileupload-highlight"),this.$refs.content.setAttribute("data-p-highlight",!1),a.stopPropagation(),a.preventDefault();var n=a.dataTransfer?a.dataTransfer.files:a.target.files,i=this.multiple||n&&n.length===1;i&&this.onFileSelect(a)}},remove:function(a){this.clearInputElement();var n=this.files.splice(a,1)[0];this.files=bo(this.files),this.$emit("remove",{file:n,files:this.files})},removeUploadedFile:function(a){var n=this.uploadedFiles.splice(a,1)[0];this.uploadedFiles=bo(this.uploadedFiles),this.$emit("remove-uploaded-file",{file:n,files:this.uploadedFiles})},clearInputElement:function(){this.$refs.fileInput.value=""},clearIEInput:function(){this.$refs.fileInput&&(this.duplicateIEEvent=!0,this.$refs.fileInput.value="")},formatSize:function(a){var n,i=1024,e=3,t=((n=this.$primevue.config.locale)===null||n===void 0?void 0:n.fileSizeTypes)||["B","KB","MB","GB","TB","PB","EB","ZB","YB"];if(a===0)return"0 ".concat(t[0]);var r=Math.floor(Math.log(a)/Math.log(i)),s=parseFloat((a/Math.pow(i,r)).toFixed(e));return"".concat(s," ").concat(t[r])},isFileLimitExceeded:function(){return this.fileLimit&&this.fileLimit<=this.files.length+this.uploadedFileCount&&this.focused&&(this.focused=!1),this.fileLimit&&this.fileLimit<this.files.length+this.uploadedFileCount},checkFileLimit:function(){this.isFileLimitExceeded()&&this.messages.push(this.invalidFileLimitMessage.replace("{0}",this.fileLimit.toString()))},onMessageClose:function(){this.messages=null}},computed:{isAdvanced:function(){return this.mode==="advanced"},isBasic:function(){return this.mode==="basic"},chooseButtonClass:function(){return[this.cx("pcChooseButton"),this.class]},basicFileChosenLabel:function(){var a;if(this.auto)return this.chooseButtonLabel;if(this.hasFiles){var n;return this.files&&this.files.length===1?this.files[0].name:(n=this.$primevue.config.locale)===null||n===void 0||(n=n.fileChosenMessage)===null||n===void 0?void 0:n.replace("{0}",this.files.length)}return((a=this.$primevue.config.locale)===null||a===void 0?void 0:a.noFileChosenMessage)||""},hasFiles:function(){return this.files&&this.files.length>0},hasUploadedFiles:function(){return this.uploadedFiles&&this.uploadedFiles.length>0},chooseDisabled:function(){return this.disabled||this.fileLimit&&this.fileLimit<=this.files.length+this.uploadedFileCount},uploadDisabled:function(){return this.disabled||!this.hasFiles||this.fileLimit&&this.fileLimit<this.files.length},cancelDisabled:function(){return this.disabled||!this.hasFiles},chooseButtonLabel:function(){return this.chooseLabel||this.$primevue.config.locale.choose},uploadButtonLabel:function(){return this.uploadLabel||this.$primevue.config.locale.upload},cancelButtonLabel:function(){return this.cancelLabel||this.$primevue.config.locale.cancel},completedLabel:function(){return this.$primevue.config.locale.completed},pendingLabel:function(){return this.$primevue.config.locale.pending}},components:{Button:hr,ProgressBar:nc,Message:Sl,FileContent:Ol,PlusIcon:tc,UploadIcon:Tl,TimesIcon:yl},directives:{ripple:Yu}},Cc=["multiple","accept","disabled"],xc=["files"],Pc=["accept","disabled","multiple"];function Tc(o,a,n,i,e,t){var r=xn("Button"),s=xn("ProgressBar"),l=xn("Message"),u=xn("FileContent");return t.isAdvanced?(ue(),je("div",ke({key:0,class:o.cx("root")},o.ptmi("root")),[se("input",ke({ref:"fileInput",type:"file",onChange:a[0]||(a[0]=function(){return t.onFileSelect&&t.onFileSelect.apply(t,arguments)}),multiple:o.multiple,accept:o.accept,disabled:t.chooseDisabled},o.ptm("input")),null,16,Cc),se("div",ke({class:o.cx("header")},o.ptm("header")),[Zt(o.$slots,"header",{files:e.files,uploadedFiles:e.uploadedFiles,chooseCallback:t.choose,uploadCallback:t.uploader,clearCallback:t.clear},function(){return[re(r,ke({label:t.chooseButtonLabel,class:t.chooseButtonClass,style:o.style,disabled:o.disabled,unstyled:o.unstyled,onClick:t.choose,onKeydown:qa(t.choose,["enter"]),onFocus:t.onFocus,onBlur:t.onBlur},o.chooseButtonProps,{pt:o.ptm("pcChooseButton")}),{icon:st(function(c){return[Zt(o.$slots,"chooseicon",{},function(){return[(ue(),ot(Mr(o.chooseIcon?"span":"PlusIcon"),ke({class:[c.class,o.chooseIcon],"aria-hidden":"true"},o.ptm("pcChooseButton").icon),null,16,["class"]))]})]}),_:3},16,["label","class","style","disabled","unstyled","onClick","onKeydown","onFocus","onBlur","pt"]),o.showUploadButton?(ue(),ot(r,ke({key:0,class:o.cx("pcUploadButton"),label:t.uploadButtonLabel,onClick:t.uploader,disabled:t.uploadDisabled,unstyled:o.unstyled},o.uploadButtonProps,{pt:o.ptm("pcUploadButton")}),{icon:st(function(c){return[Zt(o.$slots,"uploadicon",{},function(){return[(ue(),ot(Mr(o.uploadIcon?"span":"UploadIcon"),ke({class:[c.class,o.uploadIcon],"aria-hidden":"true"},o.ptm("pcUploadButton").icon,{"data-pc-section":"uploadbuttonicon"}),null,16,["class"]))]})]}),_:3},16,["class","label","onClick","disabled","unstyled","pt"])):At("",!0),o.showCancelButton?(ue(),ot(r,ke({key:1,class:o.cx("pcCancelButton"),label:t.cancelButtonLabel,onClick:t.clear,disabled:t.cancelDisabled,unstyled:o.unstyled},o.cancelButtonProps,{pt:o.ptm("pcCancelButton")}),{icon:st(function(c){return[Zt(o.$slots,"cancelicon",{},function(){return[(ue(),ot(Mr(o.cancelIcon?"span":"TimesIcon"),ke({class:[c.class,o.cancelIcon],"aria-hidden":"true"},o.ptm("pcCancelButton").icon,{"data-pc-section":"cancelbuttonicon"}),null,16,["class"]))]})]}),_:3},16,["class","label","onClick","disabled","unstyled","pt"])):At("",!0)]})],16),se("div",ke({ref:"content",class:o.cx("content"),onDragenter:a[1]||(a[1]=function(){return t.onDragEnter&&t.onDragEnter.apply(t,arguments)}),onDragover:a[2]||(a[2]=function(){return t.onDragOver&&t.onDragOver.apply(t,arguments)}),onDragleave:a[3]||(a[3]=function(){return t.onDragLeave&&t.onDragLeave.apply(t,arguments)}),onDrop:a[4]||(a[4]=function(){return t.onDrop&&t.onDrop.apply(t,arguments)})},o.ptm("content"),{"data-p-highlight":!1}),[Zt(o.$slots,"content",{files:e.files,uploadedFiles:e.uploadedFiles,removeUploadedFileCallback:t.removeUploadedFile,removeFileCallback:t.remove,progress:e.progress,messages:e.messages},function(){return[t.hasFiles?(ue(),ot(s,{key:0,value:e.progress,showValue:!1,unstyled:o.unstyled,pt:o.ptm("pcProgressbar")},null,8,["value","unstyled","pt"])):At("",!0),(ue(!0),je(On,null,zr(e.messages,function(c){return ue(),ot(l,{key:c,severity:"error",onClose:t.onMessageClose,unstyled:o.unstyled,pt:o.ptm("pcMessage")},{default:st(function(){return[Bo(yt(c),1)]}),_:2},1032,["onClose","unstyled","pt"])}),128)),t.hasFiles?(ue(),je("div",{key:1,class:Pn(o.cx("fileList"))},[re(u,{files:e.files,onRemove:t.remove,badgeValue:t.pendingLabel,previewWidth:o.previewWidth,templates:o.$slots,unstyled:o.unstyled,pt:o.pt},null,8,["files","onRemove","badgeValue","previewWidth","templates","unstyled","pt"])],2)):At("",!0),t.hasUploadedFiles?(ue(),je("div",{key:2,class:Pn(o.cx("fileList"))},[re(u,{files:e.uploadedFiles,onRemove:t.removeUploadedFile,badgeValue:t.completedLabel,badgeSeverity:"success",previewWidth:o.previewWidth,templates:o.$slots,unstyled:o.unstyled,pt:o.pt},null,8,["files","onRemove","badgeValue","previewWidth","templates","unstyled","pt"])],2)):At("",!0)]}),o.$slots.empty&&!t.hasFiles&&!t.hasUploadedFiles?(ue(),je("div",Xu(ke({key:0},o.ptm("empty"))),[Zt(o.$slots,"empty")],16)):At("",!0)],16)],16)):t.isBasic?(ue(),je("div",ke({key:1,class:o.cx("root")},o.ptmi("root")),[(ue(!0),je(On,null,zr(e.messages,function(c){return ue(),ot(l,{key:c,severity:"error",onClose:t.onMessageClose,unstyled:o.unstyled,pt:o.ptm("pcMessage")},{default:st(function(){return[Bo(yt(c),1)]}),_:2},1032,["onClose","unstyled","pt"])}),128)),re(r,ke({label:t.chooseButtonLabel,class:t.chooseButtonClass,style:o.style,disabled:o.disabled,unstyled:o.unstyled,onMouseup:t.onBasicUploaderClick,onKeydown:qa(t.choose,["enter"]),onFocus:t.onFocus,onBlur:t.onBlur},o.chooseButtonProps,{pt:o.ptm("pcChooseButton")}),{icon:st(function(c){return[Zt(o.$slots,"chooseicon",{},function(){return[(ue(),ot(Mr(o.chooseIcon?"span":"PlusIcon"),ke({class:[c.class,o.chooseIcon],"aria-hidden":"true"},o.ptm("pcChooseButton").icon),null,16,["class"]))]})]}),_:3},16,["label","class","style","disabled","unstyled","onMouseup","onKeydown","onFocus","onBlur","pt"]),o.auto?At("",!0):Zt(o.$slots,"filelabel",{key:0,class:Pn(o.cx("filelabel"))},function(){return[se("span",{class:Pn(o.cx("filelabel")),files:e.files},yt(t.basicFileChosenLabel),11,xc)]}),se("input",ke({ref:"fileInput",type:"file",accept:o.accept,disabled:o.disabled,multiple:o.multiple,onChange:a[5]||(a[5]=function(){return t.onFileSelect&&t.onFileSelect.apply(t,arguments)}),onFocus:a[6]||(a[6]=function(){return t.onFocus&&t.onFocus.apply(t,arguments)}),onBlur:a[7]||(a[7]=function(){return t.onBlur&&t.onBlur.apply(t,arguments)})},o.ptm("input")),null,16,Pc)],16)):At("",!0)}Ea.render=Tc;const So={getLevelsByRouteId:Oc,createLevelByRouteId:Ac,updateLevelByIdAndRouteId:Dc,deleteLevelByIdAndRouteId:Ic};async function Oc(o){return await co.get(`v2/route/${o}/levels`)}async function Ac(o,a){return await co.post(`v2/route/${o}/level`,{name:a.name})}async function Dc(o,a,n,i){const e={};return i&&(e.lang=i),await co.put(`v2/route/${a}/level/${o}`,{language:n.language,learn_count:n.learn_count,name:n.name,practice_count:n.practice_count},{params:e})}async function Ic(o,a){return await co.delete(`v2/route/${a}/level/${o}`)}function _c(o,a){const n=new Map,i={};for(const e of a)n.set(e.id,e.levelId),i[e.levelId]||(i[e.levelId]=[]);for(const e of o){const t=n.get(e.lesson_id);t!==void 0&&i[t].push(e)}return i}const ba=$u("route-edit-store",()=>{const o=Wu(),a=Pl(),{lang:n}=Zr(a),i=me("Order mode"),e=me(null),t=me({}),r=me({}),s=me(!1),l=me(!1),u=me(!1),c=me(!1),d=me(!1),f=me(!1),v=me(!1),p=me(!1),y=me(!1),g=me(!1);async function E(L){var k,N,V,ae;try{s.value=!0;const{data:ve}=await di.getRouteById(L,n.value);e.value=oc(ve),t.value=ac(((k=e.value)==null?void 0:k.lessons)??[],((N=e.value)==null?void 0:N.levels)??[]),r.value=_c(((V=e.value)==null?void 0:V.dependencies)??[],((ae=e.value)==null?void 0:ae.lessons)??[])}catch(ve){o.add({severity:"error",summary:ve.response.data.error,life:2e3})}finally{s.value=!1}}async function b(L,k){try{l.value=!0;const{data:N}=await di.updateRouteById(L,k,n.value);o.add({severity:"success",summary:N.message,life:2e3})}catch(N){o.add({severity:"error",summary:N.response.data.error,life:2e3})}finally{l.value=!1}}async function S(L){try{u.value=!0;const{data:k}=await di.deleteRouteById(L);o.add({severity:"success",summary:k.message,life:2e3})}catch(k){o.add({severity:"error",summary:k.response.data.error,life:2e3})}finally{u.value=!1}}async function C(L){try{c.value=!0;const{data:k}=await So.createLevelByRouteId(e.value.id,L);o.add({severity:"success",summary:k.message,life:2e3})}catch(k){o.add({severity:"error",summary:k.response.data.error,life:2e3})}finally{c.value=!1}}async function x(L,k){try{d.value=!0;const{data:N}=await So.updateLevelByIdAndRouteId(L,e.value.id,k,n.value);o.add({severity:"success",summary:N.message,life:2e3})}catch(N){o.add({severity:"error",summary:N.response.data.error,life:2e3})}finally{d.value=!1}}async function T(L){try{f.value=!0;const{data:k}=await So.deleteLevelByIdAndRouteId(L,e.value.id);o.add({severity:"success",summary:k.message,life:2e3})}catch(k){o.add({severity:"error",summary:k.response.data.error,life:2e3})}finally{f.value=!1}}async function O(L){try{v.value=!0;const{data:k}=await Gn.createLesson(L);o.add({severity:"success",summary:k.message,life:2e3})}catch(k){o.add({severity:"error",summary:k.response.data.error,life:2e3})}finally{v.value=!1}}async function P(L,k){try{p.value=!0;const{data:N}=await Gn.updateLessonById(L,k,n.value);o.add({severity:"success",summary:N.message,life:2e3})}catch(N){o.add({severity:"error",summary:N.response.data.error,life:2e3})}finally{p.value=!1}}async function A(L){try{y.value=!0;const{data:k}=await Gn.deleteLessonById(L);o.add({severity:"success",summary:k.message,life:2e3})}catch(k){o.add({severity:"error",summary:k.response.data.error,life:2e3})}finally{y.value=!1}}async function _(L,k){try{g.value=!0;const{data:N}=await di.updateRouteLessonsOrderById(L,k);o.add({severity:"success",summary:N.message,life:2e3})}catch(N){o.add({severity:"error",summary:N.response.data.error,life:2e3})}finally{g.value=!1}}async function R(L){try{const{data:k}=await Gn.setLessonDependency(L);o.add({severity:"success",summary:k.message,life:2e3})}catch(k){o.add({severity:"error",summary:k.response.data.error,life:2e3})}}async function M(L){try{const{data:k}=await Gn.removeLessonDependency(L);o.add({severity:"success",summary:k.message,life:2e3})}catch(k){o.add({severity:"error",summary:k.response.data.error,life:2e3})}}async function F(L){try{const{data:k}=await Gn.removeAllLessonDependencies(L);o.add({severity:"success",summary:k.message,life:2e3})}catch(k){o.add({severity:"error",summary:k.response.data.error,life:2e3})}}return{mode:i,selectedRoute:e,isRouteLoading:s,isRouteUpdating:l,isRouteDeleting:u,isLevelCreating:c,isLevelUpdating:d,isLevelDeleting:f,isLessonCreating:v,isLessonUpdating:p,isLessonDeleting:y,isOrderUpdating:g,groupedLessons:t,groupedDependencies:r,loadRouteById:E,updateRouteById:b,deleteRouteById:S,createLevel:C,updateLevelById:x,deleteLevelById:T,createLesson:O,updateLessonById:P,deleteLessonById:A,updateRouteLessonsOrderById:_,createLessonDependency:R,deleteLessonDependency:M,deleteAllLessonDependencies:F}});var Dl={exports:{}};/**!
 * Sortable 1.14.0
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function ts(o,a){var n=Object.keys(o);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(o);a&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(o,e).enumerable})),n.push.apply(n,i)}return n}function Ft(o){for(var a=1;a<arguments.length;a++){var n=arguments[a]!=null?arguments[a]:{};a%2?ts(Object(n),!0).forEach(function(i){wc(o,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(n)):ts(Object(n)).forEach(function(i){Object.defineProperty(o,i,Object.getOwnPropertyDescriptor(n,i))})}return o}function wi(o){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?wi=function(a){return typeof a}:wi=function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},wi(o)}function wc(o,a,n){return a in o?Object.defineProperty(o,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):o[a]=n,o}function St(){return St=Object.assign||function(o){for(var a=1;a<arguments.length;a++){var n=arguments[a];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(o[i]=n[i])}return o},St.apply(this,arguments)}function Mc(o,a){if(o==null)return{};var n={},i=Object.keys(o),e,t;for(t=0;t<i.length;t++)e=i[t],!(a.indexOf(e)>=0)&&(n[e]=o[e]);return n}function kc(o,a){if(o==null)return{};var n=Mc(o,a),i,e;if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(o);for(e=0;e<t.length;e++)i=t[e],!(a.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(o,i)&&(n[i]=o[i])}return n}function Lc(o){return Nc(o)||Rc(o)||Fc(o)||Gc()}function Nc(o){if(Array.isArray(o))return Vo(o)}function Rc(o){if(typeof Symbol<"u"&&o[Symbol.iterator]!=null||o["@@iterator"]!=null)return Array.from(o)}function Fc(o,a){if(o){if(typeof o=="string")return Vo(o,a);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor&&(n=o.constructor.name),n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Vo(o,a)}}function Vo(o,a){(a==null||a>o.length)&&(a=o.length);for(var n=0,i=new Array(a);n<a;n++)i[n]=o[n];return i}function Gc(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var jc="1.14.0";function Xt(o){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(o)}var Kt=Xt(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),oi=Xt(/Edge/i),ns=Xt(/firefox/i),Vr=Xt(/safari/i)&&!Xt(/chrome/i)&&!Xt(/android/i),Il=Xt(/iP(ad|od|hone)/i),Bc=Xt(/chrome/i)&&Xt(/android/i),_l={capture:!1,passive:!1};function ce(o,a,n){o.addEventListener(a,n,!Kt&&_l)}function le(o,a,n){o.removeEventListener(a,n,!Kt&&_l)}function Hi(o,a){if(a){if(a[0]===">"&&(a=a.substring(1)),o)try{if(o.matches)return o.matches(a);if(o.msMatchesSelector)return o.msMatchesSelector(a);if(o.webkitMatchesSelector)return o.webkitMatchesSelector(a)}catch{return!1}return!1}}function Uc(o){return o.host&&o!==document&&o.host.nodeType?o.host:o.parentNode}function Dt(o,a,n,i){if(o){n=n||document;do{if(a!=null&&(a[0]===">"?o.parentNode===n&&Hi(o,a):Hi(o,a))||i&&o===n)return o;if(o===n)break}while(o=Uc(o))}return null}var rs=/\s+/g;function Le(o,a,n){if(o&&a)if(o.classList)o.classList[n?"add":"remove"](a);else{var i=(" "+o.className+" ").replace(rs," ").replace(" "+a+" "," ");o.className=(i+(n?" "+a:"")).replace(rs," ")}}function Y(o,a,n){var i=o&&o.style;if(i){if(n===void 0)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(o,""):o.currentStyle&&(n=o.currentStyle),a===void 0?n:n[a];!(a in i)&&a.indexOf("webkit")===-1&&(a="-webkit-"+a),i[a]=n+(typeof n=="string"?"":"px")}}function An(o,a){var n="";if(typeof o=="string")n=o;else do{var i=Y(o,"transform");i&&i!=="none"&&(n=i+" "+n)}while(!a&&(o=o.parentNode));var e=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return e&&new e(n)}function wl(o,a,n){if(o){var i=o.getElementsByTagName(a),e=0,t=i.length;if(n)for(;e<t;e++)n(i[e],e);return i}return[]}function Rt(){var o=document.scrollingElement;return o||document.documentElement}function we(o,a,n,i,e){if(!(!o.getBoundingClientRect&&o!==window)){var t,r,s,l,u,c,d;if(o!==window&&o.parentNode&&o!==Rt()?(t=o.getBoundingClientRect(),r=t.top,s=t.left,l=t.bottom,u=t.right,c=t.height,d=t.width):(r=0,s=0,l=window.innerHeight,u=window.innerWidth,c=window.innerHeight,d=window.innerWidth),(a||n)&&o!==window&&(e=e||o.parentNode,!Kt))do if(e&&e.getBoundingClientRect&&(Y(e,"transform")!=="none"||n&&Y(e,"position")!=="static")){var f=e.getBoundingClientRect();r-=f.top+parseInt(Y(e,"border-top-width")),s-=f.left+parseInt(Y(e,"border-left-width")),l=r+t.height,u=s+t.width;break}while(e=e.parentNode);if(i&&o!==window){var v=An(e||o),p=v&&v.a,y=v&&v.d;v&&(r/=y,s/=p,d/=p,c/=y,l=r+c,u=s+d)}return{top:r,left:s,bottom:l,right:u,width:d,height:c}}}function is(o,a,n){for(var i=on(o,!0),e=we(o)[a];i;){var t=we(i)[n],r=void 0;if(r=e>=t,!r)return i;if(i===Rt())break;i=on(i,!1)}return!1}function or(o,a,n,i){for(var e=0,t=0,r=o.children;t<r.length;){if(r[t].style.display!=="none"&&r[t]!==Z.ghost&&(i||r[t]!==Z.dragged)&&Dt(r[t],n.draggable,o,!1)){if(e===a)return r[t];e++}t++}return null}function Sa(o,a){for(var n=o.lastElementChild;n&&(n===Z.ghost||Y(n,"display")==="none"||a&&!Hi(n,a));)n=n.previousElementSibling;return n||null}function Fe(o,a){var n=0;if(!o||!o.parentNode)return-1;for(;o=o.previousElementSibling;)o.nodeName.toUpperCase()!=="TEMPLATE"&&o!==Z.clone&&(!a||Hi(o,a))&&n++;return n}function os(o){var a=0,n=0,i=Rt();if(o)do{var e=An(o),t=e.a,r=e.d;a+=o.scrollLeft*t,n+=o.scrollTop*r}while(o!==i&&(o=o.parentNode));return[a,n]}function Vc(o,a){for(var n in o)if(o.hasOwnProperty(n)){for(var i in a)if(a.hasOwnProperty(i)&&a[i]===o[n][i])return Number(n)}return-1}function on(o,a){if(!o||!o.getBoundingClientRect)return Rt();var n=o,i=!1;do if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var e=Y(n);if(n.clientWidth<n.scrollWidth&&(e.overflowX=="auto"||e.overflowX=="scroll")||n.clientHeight<n.scrollHeight&&(e.overflowY=="auto"||e.overflowY=="scroll")){if(!n.getBoundingClientRect||n===document.body)return Rt();if(i||a)return n;i=!0}}while(n=n.parentNode);return Rt()}function Hc(o,a){if(o&&a)for(var n in a)a.hasOwnProperty(n)&&(o[n]=a[n]);return o}function Co(o,a){return Math.round(o.top)===Math.round(a.top)&&Math.round(o.left)===Math.round(a.left)&&Math.round(o.height)===Math.round(a.height)&&Math.round(o.width)===Math.round(a.width)}var Hr;function Ml(o,a){return function(){if(!Hr){var n=arguments,i=this;n.length===1?o.call(i,n[0]):o.apply(i,n),Hr=setTimeout(function(){Hr=void 0},a)}}}function Yc(){clearTimeout(Hr),Hr=void 0}function kl(o,a,n){o.scrollLeft+=a,o.scrollTop+=n}function Ca(o){var a=window.Polymer,n=window.jQuery||window.Zepto;return a&&a.dom?a.dom(o).cloneNode(!0):n?n(o).clone(!0)[0]:o.cloneNode(!0)}function as(o,a){Y(o,"position","absolute"),Y(o,"top",a.top),Y(o,"left",a.left),Y(o,"width",a.width),Y(o,"height",a.height)}function xo(o){Y(o,"position",""),Y(o,"top",""),Y(o,"left",""),Y(o,"width",""),Y(o,"height","")}var nt="Sortable"+new Date().getTime();function Xc(){var o=[],a;return{captureAnimationState:function(){if(o=[],!!this.options.animation){var i=[].slice.call(this.el.children);i.forEach(function(e){if(!(Y(e,"display")==="none"||e===Z.ghost)){o.push({target:e,rect:we(e)});var t=Ft({},o[o.length-1].rect);if(e.thisAnimationDuration){var r=An(e,!0);r&&(t.top-=r.f,t.left-=r.e)}e.fromRect=t}})}},addAnimationState:function(i){o.push(i)},removeAnimationState:function(i){o.splice(Vc(o,{target:i}),1)},animateAll:function(i){var e=this;if(!this.options.animation){clearTimeout(a),typeof i=="function"&&i();return}var t=!1,r=0;o.forEach(function(s){var l=0,u=s.target,c=u.fromRect,d=we(u),f=u.prevFromRect,v=u.prevToRect,p=s.rect,y=An(u,!0);y&&(d.top-=y.f,d.left-=y.e),u.toRect=d,u.thisAnimationDuration&&Co(f,d)&&!Co(c,d)&&(p.top-d.top)/(p.left-d.left)===(c.top-d.top)/(c.left-d.left)&&(l=Wc(p,f,v,e.options)),Co(d,c)||(u.prevFromRect=c,u.prevToRect=d,l||(l=e.options.animation),e.animate(u,p,d,l)),l&&(t=!0,r=Math.max(r,l),clearTimeout(u.animationResetTimer),u.animationResetTimer=setTimeout(function(){u.animationTime=0,u.prevFromRect=null,u.fromRect=null,u.prevToRect=null,u.thisAnimationDuration=null},l),u.thisAnimationDuration=l)}),clearTimeout(a),t?a=setTimeout(function(){typeof i=="function"&&i()},r):typeof i=="function"&&i(),o=[]},animate:function(i,e,t,r){if(r){Y(i,"transition",""),Y(i,"transform","");var s=An(this.el),l=s&&s.a,u=s&&s.d,c=(e.left-t.left)/(l||1),d=(e.top-t.top)/(u||1);i.animatingX=!!c,i.animatingY=!!d,Y(i,"transform","translate3d("+c+"px,"+d+"px,0)"),this.forRepaintDummy=$c(i),Y(i,"transition","transform "+r+"ms"+(this.options.easing?" "+this.options.easing:"")),Y(i,"transform","translate3d(0,0,0)"),typeof i.animated=="number"&&clearTimeout(i.animated),i.animated=setTimeout(function(){Y(i,"transition",""),Y(i,"transform",""),i.animated=!1,i.animatingX=!1,i.animatingY=!1},r)}}}}function $c(o){return o.offsetWidth}function Wc(o,a,n,i){return Math.sqrt(Math.pow(a.top-o.top,2)+Math.pow(a.left-o.left,2))/Math.sqrt(Math.pow(a.top-n.top,2)+Math.pow(a.left-n.left,2))*i.animation}var jn=[],Po={initializeByDefault:!0},ai={mount:function(a){for(var n in Po)Po.hasOwnProperty(n)&&!(n in a)&&(a[n]=Po[n]);jn.forEach(function(i){if(i.pluginName===a.pluginName)throw"Sortable: Cannot mount plugin ".concat(a.pluginName," more than once")}),jn.push(a)},pluginEvent:function(a,n,i){var e=this;this.eventCanceled=!1,i.cancel=function(){e.eventCanceled=!0};var t=a+"Global";jn.forEach(function(r){n[r.pluginName]&&(n[r.pluginName][t]&&n[r.pluginName][t](Ft({sortable:n},i)),n.options[r.pluginName]&&n[r.pluginName][a]&&n[r.pluginName][a](Ft({sortable:n},i)))})},initializePlugins:function(a,n,i,e){jn.forEach(function(s){var l=s.pluginName;if(!(!a.options[l]&&!s.initializeByDefault)){var u=new s(a,n,a.options);u.sortable=a,u.options=a.options,a[l]=u,St(i,u.defaults)}});for(var t in a.options)if(a.options.hasOwnProperty(t)){var r=this.modifyOption(a,t,a.options[t]);typeof r<"u"&&(a.options[t]=r)}},getEventProperties:function(a,n){var i={};return jn.forEach(function(e){typeof e.eventProperties=="function"&&St(i,e.eventProperties.call(n[e.pluginName],a))}),i},modifyOption:function(a,n,i){var e;return jn.forEach(function(t){a[t.pluginName]&&t.optionListeners&&typeof t.optionListeners[n]=="function"&&(e=t.optionListeners[n].call(a[t.pluginName],i))}),e}};function kr(o){var a=o.sortable,n=o.rootEl,i=o.name,e=o.targetEl,t=o.cloneEl,r=o.toEl,s=o.fromEl,l=o.oldIndex,u=o.newIndex,c=o.oldDraggableIndex,d=o.newDraggableIndex,f=o.originalEvent,v=o.putSortable,p=o.extraEventProperties;if(a=a||n&&n[nt],!!a){var y,g=a.options,E="on"+i.charAt(0).toUpperCase()+i.substr(1);window.CustomEvent&&!Kt&&!oi?y=new CustomEvent(i,{bubbles:!0,cancelable:!0}):(y=document.createEvent("Event"),y.initEvent(i,!0,!0)),y.to=r||n,y.from=s||n,y.item=e||n,y.clone=t,y.oldIndex=l,y.newIndex=u,y.oldDraggableIndex=c,y.newDraggableIndex=d,y.originalEvent=f,y.pullMode=v?v.lastPutMode:void 0;var b=Ft(Ft({},p),ai.getEventProperties(i,a));for(var S in b)y[S]=b[S];n&&n.dispatchEvent(y),g[E]&&g[E].call(a,y)}}var Kc=["evt"],ct=function(a,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},e=i.evt,t=kc(i,Kc);ai.pluginEvent.bind(Z)(a,n,Ft({dragEl:j,parentEl:Ne,ghostEl:ie,rootEl:De,nextEl:bn,lastDownEl:Mi,cloneEl:Re,cloneHidden:nn,dragStarted:Lr,putSortable:qe,activeSortable:Z.active,originalEvent:e,oldIndex:qn,oldDraggableIndex:Yr,newIndex:pt,newDraggableIndex:tn,hideGhostForTarget:Fl,unhideGhostForTarget:Gl,cloneNowHidden:function(){nn=!0},cloneNowShown:function(){nn=!1},dispatchSortableEvent:function(s){it({sortable:n,name:s,originalEvent:e})}},t))};function it(o){kr(Ft({putSortable:qe,cloneEl:Re,targetEl:j,rootEl:De,oldIndex:qn,oldDraggableIndex:Yr,newIndex:pt,newDraggableIndex:tn},o))}var j,Ne,ie,De,bn,Mi,Re,nn,qn,pt,Yr,tn,hi,qe,Jn=!1,Yi=!1,Xi=[],hn,xt,To,Oo,ss,ls,Lr,Bn,Xr,$r=!1,vi=!1,ki,tt,Ao=[],Ho=!1,$i=[],ho=typeof document<"u",pi=Il,us=oi||Kt?"cssFloat":"float",zc=ho&&!Bc&&!Il&&"draggable"in document.createElement("div"),Ll=function(){if(ho){if(Kt)return!1;var o=document.createElement("x");return o.style.cssText="pointer-events:auto",o.style.pointerEvents==="auto"}}(),Nl=function(a,n){var i=Y(a),e=parseInt(i.width)-parseInt(i.paddingLeft)-parseInt(i.paddingRight)-parseInt(i.borderLeftWidth)-parseInt(i.borderRightWidth),t=or(a,0,n),r=or(a,1,n),s=t&&Y(t),l=r&&Y(r),u=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+we(t).width,c=l&&parseInt(l.marginLeft)+parseInt(l.marginRight)+we(r).width;if(i.display==="flex")return i.flexDirection==="column"||i.flexDirection==="column-reverse"?"vertical":"horizontal";if(i.display==="grid")return i.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(t&&s.float&&s.float!=="none"){var d=s.float==="left"?"left":"right";return r&&(l.clear==="both"||l.clear===d)?"vertical":"horizontal"}return t&&(s.display==="block"||s.display==="flex"||s.display==="table"||s.display==="grid"||u>=e&&i[us]==="none"||r&&i[us]==="none"&&u+c>e)?"vertical":"horizontal"},Zc=function(a,n,i){var e=i?a.left:a.top,t=i?a.right:a.bottom,r=i?a.width:a.height,s=i?n.left:n.top,l=i?n.right:n.bottom,u=i?n.width:n.height;return e===s||t===l||e+r/2===s+u/2},Jc=function(a,n){var i;return Xi.some(function(e){var t=e[nt].options.emptyInsertThreshold;if(!(!t||Sa(e))){var r=we(e),s=a>=r.left-t&&a<=r.right+t,l=n>=r.top-t&&n<=r.bottom+t;if(s&&l)return i=e}}),i},Rl=function(a){function n(t,r){return function(s,l,u,c){var d=s.options.group.name&&l.options.group.name&&s.options.group.name===l.options.group.name;if(t==null&&(r||d))return!0;if(t==null||t===!1)return!1;if(r&&t==="clone")return t;if(typeof t=="function")return n(t(s,l,u,c),r)(s,l,u,c);var f=(r?s:l).options.group.name;return t===!0||typeof t=="string"&&t===f||t.join&&t.indexOf(f)>-1}}var i={},e=a.group;(!e||wi(e)!="object")&&(e={name:e}),i.name=e.name,i.checkPull=n(e.pull,!0),i.checkPut=n(e.put),i.revertClone=e.revertClone,a.group=i},Fl=function(){!Ll&&ie&&Y(ie,"display","none")},Gl=function(){!Ll&&ie&&Y(ie,"display","")};ho&&document.addEventListener("click",function(o){if(Yi)return o.preventDefault(),o.stopPropagation&&o.stopPropagation(),o.stopImmediatePropagation&&o.stopImmediatePropagation(),Yi=!1,!1},!0);var vn=function(a){if(j){a=a.touches?a.touches[0]:a;var n=Jc(a.clientX,a.clientY);if(n){var i={};for(var e in a)a.hasOwnProperty(e)&&(i[e]=a[e]);i.target=i.rootEl=n,i.preventDefault=void 0,i.stopPropagation=void 0,n[nt]._onDragOver(i)}}},Qc=function(a){j&&j.parentNode[nt]._isOutsideThisEl(a.target)};function Z(o,a){if(!(o&&o.nodeType&&o.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(o));this.el=o,this.options=a=St({},a),o[nt]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(o.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Nl(o,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(r,s){r.setData("Text",s.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:Z.supportPointer!==!1&&"PointerEvent"in window&&!Vr,emptyInsertThreshold:5};ai.initializePlugins(this,o,n);for(var i in n)!(i in a)&&(a[i]=n[i]);Rl(a);for(var e in this)e.charAt(0)==="_"&&typeof this[e]=="function"&&(this[e]=this[e].bind(this));this.nativeDraggable=a.forceFallback?!1:zc,this.nativeDraggable&&(this.options.touchStartThreshold=1),a.supportPointer?ce(o,"pointerdown",this._onTapStart):(ce(o,"mousedown",this._onTapStart),ce(o,"touchstart",this._onTapStart)),this.nativeDraggable&&(ce(o,"dragover",this),ce(o,"dragenter",this)),Xi.push(this.el),a.store&&a.store.get&&this.sort(a.store.get(this)||[]),St(this,Xc())}Z.prototype={constructor:Z,_isOutsideThisEl:function(a){!this.el.contains(a)&&a!==this.el&&(Bn=null)},_getDirection:function(a,n){return typeof this.options.direction=="function"?this.options.direction.call(this,a,n,j):this.options.direction},_onTapStart:function(a){if(a.cancelable){var n=this,i=this.el,e=this.options,t=e.preventOnFilter,r=a.type,s=a.touches&&a.touches[0]||a.pointerType&&a.pointerType==="touch"&&a,l=(s||a).target,u=a.target.shadowRoot&&(a.path&&a.path[0]||a.composedPath&&a.composedPath()[0])||l,c=e.filter;if(ad(i),!j&&!(/mousedown|pointerdown/.test(r)&&a.button!==0||e.disabled)&&!u.isContentEditable&&!(!this.nativeDraggable&&Vr&&l&&l.tagName.toUpperCase()==="SELECT")&&(l=Dt(l,e.draggable,i,!1),!(l&&l.animated)&&Mi!==l)){if(qn=Fe(l),Yr=Fe(l,e.draggable),typeof c=="function"){if(c.call(this,a,l,this)){it({sortable:n,rootEl:u,name:"filter",targetEl:l,toEl:i,fromEl:i}),ct("filter",n,{evt:a}),t&&a.cancelable&&a.preventDefault();return}}else if(c&&(c=c.split(",").some(function(d){if(d=Dt(u,d.trim(),i,!1),d)return it({sortable:n,rootEl:d,name:"filter",targetEl:l,fromEl:i,toEl:i}),ct("filter",n,{evt:a}),!0}),c)){t&&a.cancelable&&a.preventDefault();return}e.handle&&!Dt(u,e.handle,i,!1)||this._prepareDragStart(a,s,l)}}},_prepareDragStart:function(a,n,i){var e=this,t=e.el,r=e.options,s=t.ownerDocument,l;if(i&&!j&&i.parentNode===t){var u=we(i);if(De=t,j=i,Ne=j.parentNode,bn=j.nextSibling,Mi=i,hi=r.group,Z.dragged=j,hn={target:j,clientX:(n||a).clientX,clientY:(n||a).clientY},ss=hn.clientX-u.left,ls=hn.clientY-u.top,this._lastX=(n||a).clientX,this._lastY=(n||a).clientY,j.style["will-change"]="all",l=function(){if(ct("delayEnded",e,{evt:a}),Z.eventCanceled){e._onDrop();return}e._disableDelayedDragEvents(),!ns&&e.nativeDraggable&&(j.draggable=!0),e._triggerDragStart(a,n),it({sortable:e,name:"choose",originalEvent:a}),Le(j,r.chosenClass,!0)},r.ignore.split(",").forEach(function(c){wl(j,c.trim(),Do)}),ce(s,"dragover",vn),ce(s,"mousemove",vn),ce(s,"touchmove",vn),ce(s,"mouseup",e._onDrop),ce(s,"touchend",e._onDrop),ce(s,"touchcancel",e._onDrop),ns&&this.nativeDraggable&&(this.options.touchStartThreshold=4,j.draggable=!0),ct("delayStart",this,{evt:a}),r.delay&&(!r.delayOnTouchOnly||n)&&(!this.nativeDraggable||!(oi||Kt))){if(Z.eventCanceled){this._onDrop();return}ce(s,"mouseup",e._disableDelayedDrag),ce(s,"touchend",e._disableDelayedDrag),ce(s,"touchcancel",e._disableDelayedDrag),ce(s,"mousemove",e._delayedDragTouchMoveHandler),ce(s,"touchmove",e._delayedDragTouchMoveHandler),r.supportPointer&&ce(s,"pointermove",e._delayedDragTouchMoveHandler),e._dragStartTimer=setTimeout(l,r.delay)}else l()}},_delayedDragTouchMoveHandler:function(a){var n=a.touches?a.touches[0]:a;Math.max(Math.abs(n.clientX-this._lastX),Math.abs(n.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){j&&Do(j),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var a=this.el.ownerDocument;le(a,"mouseup",this._disableDelayedDrag),le(a,"touchend",this._disableDelayedDrag),le(a,"touchcancel",this._disableDelayedDrag),le(a,"mousemove",this._delayedDragTouchMoveHandler),le(a,"touchmove",this._delayedDragTouchMoveHandler),le(a,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(a,n){n=n||a.pointerType=="touch"&&a,!this.nativeDraggable||n?this.options.supportPointer?ce(document,"pointermove",this._onTouchMove):n?ce(document,"touchmove",this._onTouchMove):ce(document,"mousemove",this._onTouchMove):(ce(j,"dragend",this),ce(De,"dragstart",this._onDragStart));try{document.selection?Li(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(a,n){if(Jn=!1,De&&j){ct("dragStarted",this,{evt:n}),this.nativeDraggable&&ce(document,"dragover",Qc);var i=this.options;!a&&Le(j,i.dragClass,!1),Le(j,i.ghostClass,!0),Z.active=this,a&&this._appendGhost(),it({sortable:this,name:"start",originalEvent:n})}else this._nulling()},_emulateDragOver:function(){if(xt){this._lastX=xt.clientX,this._lastY=xt.clientY,Fl();for(var a=document.elementFromPoint(xt.clientX,xt.clientY),n=a;a&&a.shadowRoot&&(a=a.shadowRoot.elementFromPoint(xt.clientX,xt.clientY),a!==n);)n=a;if(j.parentNode[nt]._isOutsideThisEl(a),n)do{if(n[nt]){var i=void 0;if(i=n[nt]._onDragOver({clientX:xt.clientX,clientY:xt.clientY,target:a,rootEl:n}),i&&!this.options.dragoverBubble)break}a=n}while(n=n.parentNode);Gl()}},_onTouchMove:function(a){if(hn){var n=this.options,i=n.fallbackTolerance,e=n.fallbackOffset,t=a.touches?a.touches[0]:a,r=ie&&An(ie,!0),s=ie&&r&&r.a,l=ie&&r&&r.d,u=pi&&tt&&os(tt),c=(t.clientX-hn.clientX+e.x)/(s||1)+(u?u[0]-Ao[0]:0)/(s||1),d=(t.clientY-hn.clientY+e.y)/(l||1)+(u?u[1]-Ao[1]:0)/(l||1);if(!Z.active&&!Jn){if(i&&Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))<i)return;this._onDragStart(a,!0)}if(ie){r?(r.e+=c-(To||0),r.f+=d-(Oo||0)):r={a:1,b:0,c:0,d:1,e:c,f:d};var f="matrix(".concat(r.a,",").concat(r.b,",").concat(r.c,",").concat(r.d,",").concat(r.e,",").concat(r.f,")");Y(ie,"webkitTransform",f),Y(ie,"mozTransform",f),Y(ie,"msTransform",f),Y(ie,"transform",f),To=c,Oo=d,xt=t}a.cancelable&&a.preventDefault()}},_appendGhost:function(){if(!ie){var a=this.options.fallbackOnBody?document.body:De,n=we(j,!0,pi,!0,a),i=this.options;if(pi){for(tt=a;Y(tt,"position")==="static"&&Y(tt,"transform")==="none"&&tt!==document;)tt=tt.parentNode;tt!==document.body&&tt!==document.documentElement?(tt===document&&(tt=Rt()),n.top+=tt.scrollTop,n.left+=tt.scrollLeft):tt=Rt(),Ao=os(tt)}ie=j.cloneNode(!0),Le(ie,i.ghostClass,!1),Le(ie,i.fallbackClass,!0),Le(ie,i.dragClass,!0),Y(ie,"transition",""),Y(ie,"transform",""),Y(ie,"box-sizing","border-box"),Y(ie,"margin",0),Y(ie,"top",n.top),Y(ie,"left",n.left),Y(ie,"width",n.width),Y(ie,"height",n.height),Y(ie,"opacity","0.8"),Y(ie,"position",pi?"absolute":"fixed"),Y(ie,"zIndex","100000"),Y(ie,"pointerEvents","none"),Z.ghost=ie,a.appendChild(ie),Y(ie,"transform-origin",ss/parseInt(ie.style.width)*100+"% "+ls/parseInt(ie.style.height)*100+"%")}},_onDragStart:function(a,n){var i=this,e=a.dataTransfer,t=i.options;if(ct("dragStart",this,{evt:a}),Z.eventCanceled){this._onDrop();return}ct("setupClone",this),Z.eventCanceled||(Re=Ca(j),Re.draggable=!1,Re.style["will-change"]="",this._hideClone(),Le(Re,this.options.chosenClass,!1),Z.clone=Re),i.cloneId=Li(function(){ct("clone",i),!Z.eventCanceled&&(i.options.removeCloneOnHide||De.insertBefore(Re,j),i._hideClone(),it({sortable:i,name:"clone"}))}),!n&&Le(j,t.dragClass,!0),n?(Yi=!0,i._loopId=setInterval(i._emulateDragOver,50)):(le(document,"mouseup",i._onDrop),le(document,"touchend",i._onDrop),le(document,"touchcancel",i._onDrop),e&&(e.effectAllowed="move",t.setData&&t.setData.call(i,e,j)),ce(document,"drop",i),Y(j,"transform","translateZ(0)")),Jn=!0,i._dragStartId=Li(i._dragStarted.bind(i,n,a)),ce(document,"selectstart",i),Lr=!0,Vr&&Y(document.body,"user-select","none")},_onDragOver:function(a){var n=this.el,i=a.target,e,t,r,s=this.options,l=s.group,u=Z.active,c=hi===l,d=s.sort,f=qe||u,v,p=this,y=!1;if(Ho)return;function g(ae,ve){ct(ae,p,Ft({evt:a,isOwner:c,axis:v?"vertical":"horizontal",revert:r,dragRect:e,targetRect:t,canSort:d,fromSortable:f,target:i,completed:b,onMove:function(Ce,Se){return gi(De,n,j,e,Ce,we(Ce),a,Se)},changed:S},ve))}function E(){g("dragOverAnimationCapture"),p.captureAnimationState(),p!==f&&f.captureAnimationState()}function b(ae){return g("dragOverCompleted",{insertion:ae}),ae&&(c?u._hideClone():u._showClone(p),p!==f&&(Le(j,qe?qe.options.ghostClass:u.options.ghostClass,!1),Le(j,s.ghostClass,!0)),qe!==p&&p!==Z.active?qe=p:p===Z.active&&qe&&(qe=null),f===p&&(p._ignoreWhileAnimating=i),p.animateAll(function(){g("dragOverAnimationComplete"),p._ignoreWhileAnimating=null}),p!==f&&(f.animateAll(),f._ignoreWhileAnimating=null)),(i===j&&!j.animated||i===n&&!i.animated)&&(Bn=null),!s.dragoverBubble&&!a.rootEl&&i!==document&&(j.parentNode[nt]._isOutsideThisEl(a.target),!ae&&vn(a)),!s.dragoverBubble&&a.stopPropagation&&a.stopPropagation(),y=!0}function S(){pt=Fe(j),tn=Fe(j,s.draggable),it({sortable:p,name:"change",toEl:n,newIndex:pt,newDraggableIndex:tn,originalEvent:a})}if(a.preventDefault!==void 0&&a.cancelable&&a.preventDefault(),i=Dt(i,s.draggable,n,!0),g("dragOver"),Z.eventCanceled)return y;if(j.contains(a.target)||i.animated&&i.animatingX&&i.animatingY||p._ignoreWhileAnimating===i)return b(!1);if(Yi=!1,u&&!s.disabled&&(c?d||(r=Ne!==De):qe===this||(this.lastPutMode=hi.checkPull(this,u,j,a))&&l.checkPut(this,u,j,a))){if(v=this._getDirection(a,i)==="vertical",e=we(j),g("dragOverValid"),Z.eventCanceled)return y;if(r)return Ne=De,E(),this._hideClone(),g("revert"),Z.eventCanceled||(bn?De.insertBefore(j,bn):De.appendChild(j)),b(!0);var C=Sa(n,s.draggable);if(!C||nd(a,v,this)&&!C.animated){if(C===j)return b(!1);if(C&&n===a.target&&(i=C),i&&(t=we(i)),gi(De,n,j,e,i,t,a,!!i)!==!1)return E(),n.appendChild(j),Ne=n,S(),b(!0)}else if(C&&td(a,v,this)){var x=or(n,0,s,!0);if(x===j)return b(!1);if(i=x,t=we(i),gi(De,n,j,e,i,t,a,!1)!==!1)return E(),n.insertBefore(j,x),Ne=n,S(),b(!0)}else if(i.parentNode===n){t=we(i);var T=0,O,P=j.parentNode!==n,A=!Zc(j.animated&&j.toRect||e,i.animated&&i.toRect||t,v),_=v?"top":"left",R=is(i,"top","top")||is(j,"top","top"),M=R?R.scrollTop:void 0;Bn!==i&&(O=t[_],$r=!1,vi=!A&&s.invertSwap||P),T=rd(a,i,t,v,A?1:s.swapThreshold,s.invertedSwapThreshold==null?s.swapThreshold:s.invertedSwapThreshold,vi,Bn===i);var F;if(T!==0){var L=Fe(j);do L-=T,F=Ne.children[L];while(F&&(Y(F,"display")==="none"||F===ie))}if(T===0||F===i)return b(!1);Bn=i,Xr=T;var k=i.nextElementSibling,N=!1;N=T===1;var V=gi(De,n,j,e,i,t,a,N);if(V!==!1)return(V===1||V===-1)&&(N=V===1),Ho=!0,setTimeout(ed,30),E(),N&&!k?n.appendChild(j):i.parentNode.insertBefore(j,N?k:i),R&&kl(R,0,M-R.scrollTop),Ne=j.parentNode,O!==void 0&&!vi&&(ki=Math.abs(O-we(i)[_])),S(),b(!0)}if(n.contains(j))return b(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){le(document,"mousemove",this._onTouchMove),le(document,"touchmove",this._onTouchMove),le(document,"pointermove",this._onTouchMove),le(document,"dragover",vn),le(document,"mousemove",vn),le(document,"touchmove",vn)},_offUpEvents:function(){var a=this.el.ownerDocument;le(a,"mouseup",this._onDrop),le(a,"touchend",this._onDrop),le(a,"pointerup",this._onDrop),le(a,"touchcancel",this._onDrop),le(document,"selectstart",this)},_onDrop:function(a){var n=this.el,i=this.options;if(pt=Fe(j),tn=Fe(j,i.draggable),ct("drop",this,{evt:a}),Ne=j&&j.parentNode,pt=Fe(j),tn=Fe(j,i.draggable),Z.eventCanceled){this._nulling();return}Jn=!1,vi=!1,$r=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),Yo(this.cloneId),Yo(this._dragStartId),this.nativeDraggable&&(le(document,"drop",this),le(n,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),Vr&&Y(document.body,"user-select",""),Y(j,"transform",""),a&&(Lr&&(a.cancelable&&a.preventDefault(),!i.dropBubble&&a.stopPropagation()),ie&&ie.parentNode&&ie.parentNode.removeChild(ie),(De===Ne||qe&&qe.lastPutMode!=="clone")&&Re&&Re.parentNode&&Re.parentNode.removeChild(Re),j&&(this.nativeDraggable&&le(j,"dragend",this),Do(j),j.style["will-change"]="",Lr&&!Jn&&Le(j,qe?qe.options.ghostClass:this.options.ghostClass,!1),Le(j,this.options.chosenClass,!1),it({sortable:this,name:"unchoose",toEl:Ne,newIndex:null,newDraggableIndex:null,originalEvent:a}),De!==Ne?(pt>=0&&(it({rootEl:Ne,name:"add",toEl:Ne,fromEl:De,originalEvent:a}),it({sortable:this,name:"remove",toEl:Ne,originalEvent:a}),it({rootEl:Ne,name:"sort",toEl:Ne,fromEl:De,originalEvent:a}),it({sortable:this,name:"sort",toEl:Ne,originalEvent:a})),qe&&qe.save()):pt!==qn&&pt>=0&&(it({sortable:this,name:"update",toEl:Ne,originalEvent:a}),it({sortable:this,name:"sort",toEl:Ne,originalEvent:a})),Z.active&&((pt==null||pt===-1)&&(pt=qn,tn=Yr),it({sortable:this,name:"end",toEl:Ne,originalEvent:a}),this.save()))),this._nulling()},_nulling:function(){ct("nulling",this),De=j=Ne=ie=bn=Re=Mi=nn=hn=xt=Lr=pt=tn=qn=Yr=Bn=Xr=qe=hi=Z.dragged=Z.ghost=Z.clone=Z.active=null,$i.forEach(function(a){a.checked=!0}),$i.length=To=Oo=0},handleEvent:function(a){switch(a.type){case"drop":case"dragend":this._onDrop(a);break;case"dragenter":case"dragover":j&&(this._onDragOver(a),qc(a));break;case"selectstart":a.preventDefault();break}},toArray:function(){for(var a=[],n,i=this.el.children,e=0,t=i.length,r=this.options;e<t;e++)n=i[e],Dt(n,r.draggable,this.el,!1)&&a.push(n.getAttribute(r.dataIdAttr)||od(n));return a},sort:function(a,n){var i={},e=this.el;this.toArray().forEach(function(t,r){var s=e.children[r];Dt(s,this.options.draggable,e,!1)&&(i[t]=s)},this),n&&this.captureAnimationState(),a.forEach(function(t){i[t]&&(e.removeChild(i[t]),e.appendChild(i[t]))}),n&&this.animateAll()},save:function(){var a=this.options.store;a&&a.set&&a.set(this)},closest:function(a,n){return Dt(a,n||this.options.draggable,this.el,!1)},option:function(a,n){var i=this.options;if(n===void 0)return i[a];var e=ai.modifyOption(this,a,n);typeof e<"u"?i[a]=e:i[a]=n,a==="group"&&Rl(i)},destroy:function(){ct("destroy",this);var a=this.el;a[nt]=null,le(a,"mousedown",this._onTapStart),le(a,"touchstart",this._onTapStart),le(a,"pointerdown",this._onTapStart),this.nativeDraggable&&(le(a,"dragover",this),le(a,"dragenter",this)),Array.prototype.forEach.call(a.querySelectorAll("[draggable]"),function(n){n.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),Xi.splice(Xi.indexOf(this.el),1),this.el=a=null},_hideClone:function(){if(!nn){if(ct("hideClone",this),Z.eventCanceled)return;Y(Re,"display","none"),this.options.removeCloneOnHide&&Re.parentNode&&Re.parentNode.removeChild(Re),nn=!0}},_showClone:function(a){if(a.lastPutMode!=="clone"){this._hideClone();return}if(nn){if(ct("showClone",this),Z.eventCanceled)return;j.parentNode==De&&!this.options.group.revertClone?De.insertBefore(Re,j):bn?De.insertBefore(Re,bn):De.appendChild(Re),this.options.group.revertClone&&this.animate(j,Re),Y(Re,"display",""),nn=!1}}};function qc(o){o.dataTransfer&&(o.dataTransfer.dropEffect="move"),o.cancelable&&o.preventDefault()}function gi(o,a,n,i,e,t,r,s){var l,u=o[nt],c=u.options.onMove,d;return window.CustomEvent&&!Kt&&!oi?l=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(l=document.createEvent("Event"),l.initEvent("move",!0,!0)),l.to=a,l.from=o,l.dragged=n,l.draggedRect=i,l.related=e||a,l.relatedRect=t||we(a),l.willInsertAfter=s,l.originalEvent=r,o.dispatchEvent(l),c&&(d=c.call(u,l,r)),d}function Do(o){o.draggable=!1}function ed(){Ho=!1}function td(o,a,n){var i=we(or(n.el,0,n.options,!0)),e=10;return a?o.clientX<i.left-e||o.clientY<i.top&&o.clientX<i.right:o.clientY<i.top-e||o.clientY<i.bottom&&o.clientX<i.left}function nd(o,a,n){var i=we(Sa(n.el,n.options.draggable)),e=10;return a?o.clientX>i.right+e||o.clientX<=i.right&&o.clientY>i.bottom&&o.clientX>=i.left:o.clientX>i.right&&o.clientY>i.top||o.clientX<=i.right&&o.clientY>i.bottom+e}function rd(o,a,n,i,e,t,r,s){var l=i?o.clientY:o.clientX,u=i?n.height:n.width,c=i?n.top:n.left,d=i?n.bottom:n.right,f=!1;if(!r){if(s&&ki<u*e){if(!$r&&(Xr===1?l>c+u*t/2:l<d-u*t/2)&&($r=!0),$r)f=!0;else if(Xr===1?l<c+ki:l>d-ki)return-Xr}else if(l>c+u*(1-e)/2&&l<d-u*(1-e)/2)return id(a)}return f=f||r,f&&(l<c+u*t/2||l>d-u*t/2)?l>c+u/2?1:-1:0}function id(o){return Fe(j)<Fe(o)?1:-1}function od(o){for(var a=o.tagName+o.className+o.src+o.href+o.textContent,n=a.length,i=0;n--;)i+=a.charCodeAt(n);return i.toString(36)}function ad(o){$i.length=0;for(var a=o.getElementsByTagName("input"),n=a.length;n--;){var i=a[n];i.checked&&$i.push(i)}}function Li(o){return setTimeout(o,0)}function Yo(o){return clearTimeout(o)}ho&&ce(document,"touchmove",function(o){(Z.active||Jn)&&o.cancelable&&o.preventDefault()});Z.utils={on:ce,off:le,css:Y,find:wl,is:function(a,n){return!!Dt(a,n,a,!1)},extend:Hc,throttle:Ml,closest:Dt,toggleClass:Le,clone:Ca,index:Fe,nextTick:Li,cancelNextTick:Yo,detectDirection:Nl,getChild:or};Z.get=function(o){return o[nt]};Z.mount=function(){for(var o=arguments.length,a=new Array(o),n=0;n<o;n++)a[n]=arguments[n];a[0].constructor===Array&&(a=a[0]),a.forEach(function(i){if(!i.prototype||!i.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(i));i.utils&&(Z.utils=Ft(Ft({},Z.utils),i.utils)),ai.mount(i)})};Z.create=function(o,a){return new Z(o,a)};Z.version=jc;var Xe=[],Nr,Xo,$o=!1,Io,_o,Wi,Rr;function sd(){function o(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var a in this)a.charAt(0)==="_"&&typeof this[a]=="function"&&(this[a]=this[a].bind(this))}return o.prototype={dragStarted:function(n){var i=n.originalEvent;this.sortable.nativeDraggable?ce(document,"dragover",this._handleAutoScroll):this.options.supportPointer?ce(document,"pointermove",this._handleFallbackAutoScroll):i.touches?ce(document,"touchmove",this._handleFallbackAutoScroll):ce(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(n){var i=n.originalEvent;!this.options.dragOverBubble&&!i.rootEl&&this._handleAutoScroll(i)},drop:function(){this.sortable.nativeDraggable?le(document,"dragover",this._handleAutoScroll):(le(document,"pointermove",this._handleFallbackAutoScroll),le(document,"touchmove",this._handleFallbackAutoScroll),le(document,"mousemove",this._handleFallbackAutoScroll)),cs(),Ni(),Yc()},nulling:function(){Wi=Xo=Nr=$o=Rr=Io=_o=null,Xe.length=0},_handleFallbackAutoScroll:function(n){this._handleAutoScroll(n,!0)},_handleAutoScroll:function(n,i){var e=this,t=(n.touches?n.touches[0]:n).clientX,r=(n.touches?n.touches[0]:n).clientY,s=document.elementFromPoint(t,r);if(Wi=n,i||this.options.forceAutoScrollFallback||oi||Kt||Vr){wo(n,this.options,s,i);var l=on(s,!0);$o&&(!Rr||t!==Io||r!==_o)&&(Rr&&cs(),Rr=setInterval(function(){var u=on(document.elementFromPoint(t,r),!0);u!==l&&(l=u,Ni()),wo(n,e.options,u,i)},10),Io=t,_o=r)}else{if(!this.options.bubbleScroll||on(s,!0)===Rt()){Ni();return}wo(n,this.options,on(s,!1),!1)}}},St(o,{pluginName:"scroll",initializeByDefault:!0})}function Ni(){Xe.forEach(function(o){clearInterval(o.pid)}),Xe=[]}function cs(){clearInterval(Rr)}var wo=Ml(function(o,a,n,i){if(a.scroll){var e=(o.touches?o.touches[0]:o).clientX,t=(o.touches?o.touches[0]:o).clientY,r=a.scrollSensitivity,s=a.scrollSpeed,l=Rt(),u=!1,c;Xo!==n&&(Xo=n,Ni(),Nr=a.scroll,c=a.scrollFn,Nr===!0&&(Nr=on(n,!0)));var d=0,f=Nr;do{var v=f,p=we(v),y=p.top,g=p.bottom,E=p.left,b=p.right,S=p.width,C=p.height,x=void 0,T=void 0,O=v.scrollWidth,P=v.scrollHeight,A=Y(v),_=v.scrollLeft,R=v.scrollTop;v===l?(x=S<O&&(A.overflowX==="auto"||A.overflowX==="scroll"||A.overflowX==="visible"),T=C<P&&(A.overflowY==="auto"||A.overflowY==="scroll"||A.overflowY==="visible")):(x=S<O&&(A.overflowX==="auto"||A.overflowX==="scroll"),T=C<P&&(A.overflowY==="auto"||A.overflowY==="scroll"));var M=x&&(Math.abs(b-e)<=r&&_+S<O)-(Math.abs(E-e)<=r&&!!_),F=T&&(Math.abs(g-t)<=r&&R+C<P)-(Math.abs(y-t)<=r&&!!R);if(!Xe[d])for(var L=0;L<=d;L++)Xe[L]||(Xe[L]={});(Xe[d].vx!=M||Xe[d].vy!=F||Xe[d].el!==v)&&(Xe[d].el=v,Xe[d].vx=M,Xe[d].vy=F,clearInterval(Xe[d].pid),(M!=0||F!=0)&&(u=!0,Xe[d].pid=setInterval((function(){i&&this.layer===0&&Z.active._onTouchMove(Wi);var k=Xe[this.layer].vy?Xe[this.layer].vy*s:0,N=Xe[this.layer].vx?Xe[this.layer].vx*s:0;typeof c=="function"&&c.call(Z.dragged.parentNode[nt],N,k,o,Wi,Xe[this.layer].el)!=="continue"||kl(Xe[this.layer].el,N,k)}).bind({layer:d}),24))),d++}while(a.bubbleScroll&&f!==l&&(f=on(f,!1)));$o=u}},30),jl=function(a){var n=a.originalEvent,i=a.putSortable,e=a.dragEl,t=a.activeSortable,r=a.dispatchSortableEvent,s=a.hideGhostForTarget,l=a.unhideGhostForTarget;if(n){var u=i||t;s();var c=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:n,d=document.elementFromPoint(c.clientX,c.clientY);l(),u&&!u.el.contains(d)&&(r("spill"),this.onSpill({dragEl:e,putSortable:i}))}};function xa(){}xa.prototype={startIndex:null,dragStart:function(a){var n=a.oldDraggableIndex;this.startIndex=n},onSpill:function(a){var n=a.dragEl,i=a.putSortable;this.sortable.captureAnimationState(),i&&i.captureAnimationState();var e=or(this.sortable.el,this.startIndex,this.options);e?this.sortable.el.insertBefore(n,e):this.sortable.el.appendChild(n),this.sortable.animateAll(),i&&i.animateAll()},drop:jl};St(xa,{pluginName:"revertOnSpill"});function Pa(){}Pa.prototype={onSpill:function(a){var n=a.dragEl,i=a.putSortable,e=i||this.sortable;e.captureAnimationState(),n.parentNode&&n.parentNode.removeChild(n),e.animateAll()},drop:jl};St(Pa,{pluginName:"removeOnSpill"});var mt;function ld(){function o(){this.defaults={swapClass:"sortable-swap-highlight"}}return o.prototype={dragStart:function(n){var i=n.dragEl;mt=i},dragOverValid:function(n){var i=n.completed,e=n.target,t=n.onMove,r=n.activeSortable,s=n.changed,l=n.cancel;if(r.options.swap){var u=this.sortable.el,c=this.options;if(e&&e!==u){var d=mt;t(e)!==!1?(Le(e,c.swapClass,!0),mt=e):mt=null,d&&d!==mt&&Le(d,c.swapClass,!1)}s(),i(!0),l()}},drop:function(n){var i=n.activeSortable,e=n.putSortable,t=n.dragEl,r=e||this.sortable,s=this.options;mt&&Le(mt,s.swapClass,!1),mt&&(s.swap||e&&e.options.swap)&&t!==mt&&(r.captureAnimationState(),r!==i&&i.captureAnimationState(),ud(t,mt),r.animateAll(),r!==i&&i.animateAll())},nulling:function(){mt=null}},St(o,{pluginName:"swap",eventProperties:function(){return{swapItem:mt}}})}function ud(o,a){var n=o.parentNode,i=a.parentNode,e,t;!n||!i||n.isEqualNode(a)||i.isEqualNode(o)||(e=Fe(o),t=Fe(a),n.isEqualNode(i)&&e<t&&t++,n.insertBefore(a,n.children[e]),i.insertBefore(o,i.children[t]))}var te=[],vt=[],Sr,Pt,Cr=!1,dt=!1,Un=!1,Te,xr,yi;function cd(){function o(a){for(var n in this)n.charAt(0)==="_"&&typeof this[n]=="function"&&(this[n]=this[n].bind(this));a.options.supportPointer?ce(document,"pointerup",this._deselectMultiDrag):(ce(document,"mouseup",this._deselectMultiDrag),ce(document,"touchend",this._deselectMultiDrag)),ce(document,"keydown",this._checkKeyDown),ce(document,"keyup",this._checkKeyUp),this.defaults={selectedClass:"sortable-selected",multiDragKey:null,setData:function(e,t){var r="";te.length&&Pt===a?te.forEach(function(s,l){r+=(l?", ":"")+s.textContent}):r=t.textContent,e.setData("Text",r)}}}return o.prototype={multiDragKeyDown:!1,isMultiDrag:!1,delayStartGlobal:function(n){var i=n.dragEl;Te=i},delayEnded:function(){this.isMultiDrag=~te.indexOf(Te)},setupClone:function(n){var i=n.sortable,e=n.cancel;if(this.isMultiDrag){for(var t=0;t<te.length;t++)vt.push(Ca(te[t])),vt[t].sortableIndex=te[t].sortableIndex,vt[t].draggable=!1,vt[t].style["will-change"]="",Le(vt[t],this.options.selectedClass,!1),te[t]===Te&&Le(vt[t],this.options.chosenClass,!1);i._hideClone(),e()}},clone:function(n){var i=n.sortable,e=n.rootEl,t=n.dispatchSortableEvent,r=n.cancel;this.isMultiDrag&&(this.options.removeCloneOnHide||te.length&&Pt===i&&(ds(!0,e),t("clone"),r()))},showClone:function(n){var i=n.cloneNowShown,e=n.rootEl,t=n.cancel;this.isMultiDrag&&(ds(!1,e),vt.forEach(function(r){Y(r,"display","")}),i(),yi=!1,t())},hideClone:function(n){var i=this;n.sortable;var e=n.cloneNowHidden,t=n.cancel;this.isMultiDrag&&(vt.forEach(function(r){Y(r,"display","none"),i.options.removeCloneOnHide&&r.parentNode&&r.parentNode.removeChild(r)}),e(),yi=!0,t())},dragStartGlobal:function(n){n.sortable,!this.isMultiDrag&&Pt&&Pt.multiDrag._deselectMultiDrag(),te.forEach(function(i){i.sortableIndex=Fe(i)}),te=te.sort(function(i,e){return i.sortableIndex-e.sortableIndex}),Un=!0},dragStarted:function(n){var i=this,e=n.sortable;if(this.isMultiDrag){if(this.options.sort&&(e.captureAnimationState(),this.options.animation)){te.forEach(function(r){r!==Te&&Y(r,"position","absolute")});var t=we(Te,!1,!0,!0);te.forEach(function(r){r!==Te&&as(r,t)}),dt=!0,Cr=!0}e.animateAll(function(){dt=!1,Cr=!1,i.options.animation&&te.forEach(function(r){xo(r)}),i.options.sort&&mi()})}},dragOver:function(n){var i=n.target,e=n.completed,t=n.cancel;dt&&~te.indexOf(i)&&(e(!1),t())},revert:function(n){var i=n.fromSortable,e=n.rootEl,t=n.sortable,r=n.dragRect;te.length>1&&(te.forEach(function(s){t.addAnimationState({target:s,rect:dt?we(s):r}),xo(s),s.fromRect=r,i.removeAnimationState(s)}),dt=!1,dd(!this.options.removeCloneOnHide,e))},dragOverCompleted:function(n){var i=n.sortable,e=n.isOwner,t=n.insertion,r=n.activeSortable,s=n.parentEl,l=n.putSortable,u=this.options;if(t){if(e&&r._hideClone(),Cr=!1,u.animation&&te.length>1&&(dt||!e&&!r.options.sort&&!l)){var c=we(Te,!1,!0,!0);te.forEach(function(f){f!==Te&&(as(f,c),s.appendChild(f))}),dt=!0}if(!e)if(dt||mi(),te.length>1){var d=yi;r._showClone(i),r.options.animation&&!yi&&d&&vt.forEach(function(f){r.addAnimationState({target:f,rect:xr}),f.fromRect=xr,f.thisAnimationDuration=null})}else r._showClone(i)}},dragOverAnimationCapture:function(n){var i=n.dragRect,e=n.isOwner,t=n.activeSortable;if(te.forEach(function(s){s.thisAnimationDuration=null}),t.options.animation&&!e&&t.multiDrag.isMultiDrag){xr=St({},i);var r=An(Te,!0);xr.top-=r.f,xr.left-=r.e}},dragOverAnimationComplete:function(){dt&&(dt=!1,mi())},drop:function(n){var i=n.originalEvent,e=n.rootEl,t=n.parentEl,r=n.sortable,s=n.dispatchSortableEvent,l=n.oldIndex,u=n.putSortable,c=u||this.sortable;if(i){var d=this.options,f=t.children;if(!Un)if(d.multiDragKey&&!this.multiDragKeyDown&&this._deselectMultiDrag(),Le(Te,d.selectedClass,!~te.indexOf(Te)),~te.indexOf(Te))te.splice(te.indexOf(Te),1),Sr=null,kr({sortable:r,rootEl:e,name:"deselect",targetEl:Te,originalEvt:i});else{if(te.push(Te),kr({sortable:r,rootEl:e,name:"select",targetEl:Te,originalEvt:i}),i.shiftKey&&Sr&&r.el.contains(Sr)){var v=Fe(Sr),p=Fe(Te);if(~v&&~p&&v!==p){var y,g;for(p>v?(g=v,y=p):(g=p,y=v+1);g<y;g++)~te.indexOf(f[g])||(Le(f[g],d.selectedClass,!0),te.push(f[g]),kr({sortable:r,rootEl:e,name:"select",targetEl:f[g],originalEvt:i}))}}else Sr=Te;Pt=c}if(Un&&this.isMultiDrag){if(dt=!1,(t[nt].options.sort||t!==e)&&te.length>1){var E=we(Te),b=Fe(Te,":not(."+this.options.selectedClass+")");if(!Cr&&d.animation&&(Te.thisAnimationDuration=null),c.captureAnimationState(),!Cr&&(d.animation&&(Te.fromRect=E,te.forEach(function(C){if(C.thisAnimationDuration=null,C!==Te){var x=dt?we(C):E;C.fromRect=x,c.addAnimationState({target:C,rect:x})}})),mi(),te.forEach(function(C){f[b]?t.insertBefore(C,f[b]):t.appendChild(C),b++}),l===Fe(Te))){var S=!1;te.forEach(function(C){if(C.sortableIndex!==Fe(C)){S=!0;return}}),S&&s("update")}te.forEach(function(C){xo(C)}),c.animateAll()}Pt=c}(e===t||u&&u.lastPutMode!=="clone")&&vt.forEach(function(C){C.parentNode&&C.parentNode.removeChild(C)})}},nullingGlobal:function(){this.isMultiDrag=Un=!1,vt.length=0},destroyGlobal:function(){this._deselectMultiDrag(),le(document,"pointerup",this._deselectMultiDrag),le(document,"mouseup",this._deselectMultiDrag),le(document,"touchend",this._deselectMultiDrag),le(document,"keydown",this._checkKeyDown),le(document,"keyup",this._checkKeyUp)},_deselectMultiDrag:function(n){if(!(typeof Un<"u"&&Un)&&Pt===this.sortable&&!(n&&Dt(n.target,this.options.draggable,this.sortable.el,!1))&&!(n&&n.button!==0))for(;te.length;){var i=te[0];Le(i,this.options.selectedClass,!1),te.shift(),kr({sortable:this.sortable,rootEl:this.sortable.el,name:"deselect",targetEl:i,originalEvt:n})}},_checkKeyDown:function(n){n.key===this.options.multiDragKey&&(this.multiDragKeyDown=!0)},_checkKeyUp:function(n){n.key===this.options.multiDragKey&&(this.multiDragKeyDown=!1)}},St(o,{pluginName:"multiDrag",utils:{select:function(n){var i=n.parentNode[nt];!i||!i.options.multiDrag||~te.indexOf(n)||(Pt&&Pt!==i&&(Pt.multiDrag._deselectMultiDrag(),Pt=i),Le(n,i.options.selectedClass,!0),te.push(n))},deselect:function(n){var i=n.parentNode[nt],e=te.indexOf(n);!i||!i.options.multiDrag||!~e||(Le(n,i.options.selectedClass,!1),te.splice(e,1))}},eventProperties:function(){var n=this,i=[],e=[];return te.forEach(function(t){i.push({multiDragElement:t,index:t.sortableIndex});var r;dt&&t!==Te?r=-1:dt?r=Fe(t,":not(."+n.options.selectedClass+")"):r=Fe(t),e.push({multiDragElement:t,index:r})}),{items:Lc(te),clones:[].concat(vt),oldIndicies:i,newIndicies:e}},optionListeners:{multiDragKey:function(n){return n=n.toLowerCase(),n==="ctrl"?n="Control":n.length>1&&(n=n.charAt(0).toUpperCase()+n.substr(1)),n}}})}function dd(o,a){te.forEach(function(n,i){var e=a.children[n.sortableIndex+(o?Number(i):0)];e?a.insertBefore(n,e):a.appendChild(n)})}function ds(o,a){vt.forEach(function(n,i){var e=a.children[n.sortableIndex+(o?Number(i):0)];e?a.insertBefore(n,e):a.appendChild(n)})}function mi(){te.forEach(function(o){o!==Te&&o.parentNode&&o.parentNode.removeChild(o)})}Z.mount(new sd);Z.mount(Pa,xa);const fd=Object.freeze(Object.defineProperty({__proto__:null,MultiDrag:cd,Sortable:Z,Swap:ld,default:Z},Symbol.toStringTag,{value:"Module"})),hd=Ku(fd);(function(o,a){(function(i,e){o.exports=e(zu,hd)})(typeof self<"u"?self:Zu,function(n,i){return function(e){var t={};function r(s){if(t[s])return t[s].exports;var l=t[s]={i:s,l:!1,exports:{}};return e[s].call(l.exports,l,l.exports,r),l.l=!0,l.exports}return r.m=e,r.c=t,r.d=function(s,l,u){r.o(s,l)||Object.defineProperty(s,l,{enumerable:!0,get:u})},r.r=function(s){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},r.t=function(s,l){if(l&1&&(s=r(s)),l&8||l&4&&typeof s=="object"&&s&&s.__esModule)return s;var u=Object.create(null);if(r.r(u),Object.defineProperty(u,"default",{enumerable:!0,value:s}),l&2&&typeof s!="string")for(var c in s)r.d(u,c,(function(d){return s[d]}).bind(null,c));return u},r.n=function(s){var l=s&&s.__esModule?function(){return s.default}:function(){return s};return r.d(l,"a",l),l},r.o=function(s,l){return Object.prototype.hasOwnProperty.call(s,l)},r.p="",r(r.s="fb15")}({"00ee":function(e,t,r){var s=r("b622"),l=s("toStringTag"),u={};u[l]="z",e.exports=String(u)==="[object z]"},"0366":function(e,t,r){var s=r("1c0b");e.exports=function(l,u,c){if(s(l),u===void 0)return l;switch(c){case 0:return function(){return l.call(u)};case 1:return function(d){return l.call(u,d)};case 2:return function(d,f){return l.call(u,d,f)};case 3:return function(d,f,v){return l.call(u,d,f,v)}}return function(){return l.apply(u,arguments)}}},"057f":function(e,t,r){var s=r("fc6a"),l=r("241c").f,u={}.toString,c=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],d=function(f){try{return l(f)}catch{return c.slice()}};e.exports.f=function(v){return c&&u.call(v)=="[object Window]"?d(v):l(s(v))}},"06cf":function(e,t,r){var s=r("83ab"),l=r("d1e7"),u=r("5c6c"),c=r("fc6a"),d=r("c04e"),f=r("5135"),v=r("0cfb"),p=Object.getOwnPropertyDescriptor;t.f=s?p:function(g,E){if(g=c(g),E=d(E,!0),v)try{return p(g,E)}catch{}if(f(g,E))return u(!l.f.call(g,E),g[E])}},"0cfb":function(e,t,r){var s=r("83ab"),l=r("d039"),u=r("cc12");e.exports=!s&&!l(function(){return Object.defineProperty(u("div"),"a",{get:function(){return 7}}).a!=7})},"13d5":function(e,t,r){var s=r("23e7"),l=r("d58f").left,u=r("a640"),c=r("ae40"),d=u("reduce"),f=c("reduce",{1:0});s({target:"Array",proto:!0,forced:!d||!f},{reduce:function(p){return l(this,p,arguments.length,arguments.length>1?arguments[1]:void 0)}})},"14c3":function(e,t,r){var s=r("c6b6"),l=r("9263");e.exports=function(u,c){var d=u.exec;if(typeof d=="function"){var f=d.call(u,c);if(typeof f!="object")throw TypeError("RegExp exec method returned something other than an Object or null");return f}if(s(u)!=="RegExp")throw TypeError("RegExp#exec called on incompatible receiver");return l.call(u,c)}},"159b":function(e,t,r){var s=r("da84"),l=r("fdbc"),u=r("17c2"),c=r("9112");for(var d in l){var f=s[d],v=f&&f.prototype;if(v&&v.forEach!==u)try{c(v,"forEach",u)}catch{v.forEach=u}}},"17c2":function(e,t,r){var s=r("b727").forEach,l=r("a640"),u=r("ae40"),c=l("forEach"),d=u("forEach");e.exports=!c||!d?function(v){return s(this,v,arguments.length>1?arguments[1]:void 0)}:[].forEach},"1be4":function(e,t,r){var s=r("d066");e.exports=s("document","documentElement")},"1c0b":function(e,t){e.exports=function(r){if(typeof r!="function")throw TypeError(String(r)+" is not a function");return r}},"1c7e":function(e,t,r){var s=r("b622"),l=s("iterator"),u=!1;try{var c=0,d={next:function(){return{done:!!c++}},return:function(){u=!0}};d[l]=function(){return this},Array.from(d,function(){throw 2})}catch{}e.exports=function(f,v){if(!v&&!u)return!1;var p=!1;try{var y={};y[l]=function(){return{next:function(){return{done:p=!0}}}},f(y)}catch{}return p}},"1d80":function(e,t){e.exports=function(r){if(r==null)throw TypeError("Can't call method on "+r);return r}},"1dde":function(e,t,r){var s=r("d039"),l=r("b622"),u=r("2d00"),c=l("species");e.exports=function(d){return u>=51||!s(function(){var f=[],v=f.constructor={};return v[c]=function(){return{foo:1}},f[d](Boolean).foo!==1})}},"23cb":function(e,t,r){var s=r("a691"),l=Math.max,u=Math.min;e.exports=function(c,d){var f=s(c);return f<0?l(f+d,0):u(f,d)}},"23e7":function(e,t,r){var s=r("da84"),l=r("06cf").f,u=r("9112"),c=r("6eeb"),d=r("ce4e"),f=r("e893"),v=r("94ca");e.exports=function(p,y){var g=p.target,E=p.global,b=p.stat,S,C,x,T,O,P;if(E?C=s:b?C=s[g]||d(g,{}):C=(s[g]||{}).prototype,C)for(x in y){if(O=y[x],p.noTargetGet?(P=l(C,x),T=P&&P.value):T=C[x],S=v(E?x:g+(b?".":"#")+x,p.forced),!S&&T!==void 0){if(typeof O==typeof T)continue;f(O,T)}(p.sham||T&&T.sham)&&u(O,"sham",!0),c(C,x,O,p)}}},"241c":function(e,t,r){var s=r("ca84"),l=r("7839"),u=l.concat("length","prototype");t.f=Object.getOwnPropertyNames||function(d){return s(d,u)}},"25f0":function(e,t,r){var s=r("6eeb"),l=r("825a"),u=r("d039"),c=r("ad6d"),d="toString",f=RegExp.prototype,v=f[d],p=u(function(){return v.call({source:"a",flags:"b"})!="/a/b"}),y=v.name!=d;(p||y)&&s(RegExp.prototype,d,function(){var E=l(this),b=String(E.source),S=E.flags,C=String(S===void 0&&E instanceof RegExp&&!("flags"in f)?c.call(E):S);return"/"+b+"/"+C},{unsafe:!0})},"2ca0":function(e,t,r){var s=r("23e7"),l=r("06cf").f,u=r("50c4"),c=r("5a34"),d=r("1d80"),f=r("ab13"),v=r("c430"),p="".startsWith,y=Math.min,g=f("startsWith"),E=!v&&!g&&!!function(){var b=l(String.prototype,"startsWith");return b&&!b.writable}();s({target:"String",proto:!0,forced:!E&&!g},{startsWith:function(S){var C=String(d(this));c(S);var x=u(y(arguments.length>1?arguments[1]:void 0,C.length)),T=String(S);return p?p.call(C,T,x):C.slice(x,x+T.length)===T}})},"2d00":function(e,t,r){var s=r("da84"),l=r("342f"),u=s.process,c=u&&u.versions,d=c&&c.v8,f,v;d?(f=d.split("."),v=f[0]+f[1]):l&&(f=l.match(/Edge\/(\d+)/),(!f||f[1]>=74)&&(f=l.match(/Chrome\/(\d+)/),f&&(v=f[1]))),e.exports=v&&+v},"342f":function(e,t,r){var s=r("d066");e.exports=s("navigator","userAgent")||""},"35a1":function(e,t,r){var s=r("f5df"),l=r("3f8c"),u=r("b622"),c=u("iterator");e.exports=function(d){if(d!=null)return d[c]||d["@@iterator"]||l[s(d)]}},"37e8":function(e,t,r){var s=r("83ab"),l=r("9bf2"),u=r("825a"),c=r("df75");e.exports=s?Object.defineProperties:function(f,v){u(f);for(var p=c(v),y=p.length,g=0,E;y>g;)l.f(f,E=p[g++],v[E]);return f}},"3bbe":function(e,t,r){var s=r("861d");e.exports=function(l){if(!s(l)&&l!==null)throw TypeError("Can't set "+String(l)+" as a prototype");return l}},"3ca3":function(e,t,r){var s=r("6547").charAt,l=r("69f3"),u=r("7dd0"),c="String Iterator",d=l.set,f=l.getterFor(c);u(String,"String",function(v){d(this,{type:c,string:String(v),index:0})},function(){var p=f(this),y=p.string,g=p.index,E;return g>=y.length?{value:void 0,done:!0}:(E=s(y,g),p.index+=E.length,{value:E,done:!1})})},"3f8c":function(e,t){e.exports={}},4160:function(e,t,r){var s=r("23e7"),l=r("17c2");s({target:"Array",proto:!0,forced:[].forEach!=l},{forEach:l})},"428f":function(e,t,r){var s=r("da84");e.exports=s},"44ad":function(e,t,r){var s=r("d039"),l=r("c6b6"),u="".split;e.exports=s(function(){return!Object("z").propertyIsEnumerable(0)})?function(c){return l(c)=="String"?u.call(c,""):Object(c)}:Object},"44d2":function(e,t,r){var s=r("b622"),l=r("7c73"),u=r("9bf2"),c=s("unscopables"),d=Array.prototype;d[c]==null&&u.f(d,c,{configurable:!0,value:l(null)}),e.exports=function(f){d[c][f]=!0}},"44e7":function(e,t,r){var s=r("861d"),l=r("c6b6"),u=r("b622"),c=u("match");e.exports=function(d){var f;return s(d)&&((f=d[c])!==void 0?!!f:l(d)=="RegExp")}},4930:function(e,t,r){var s=r("d039");e.exports=!!Object.getOwnPropertySymbols&&!s(function(){return!String(Symbol())})},"4d64":function(e,t,r){var s=r("fc6a"),l=r("50c4"),u=r("23cb"),c=function(d){return function(f,v,p){var y=s(f),g=l(y.length),E=u(p,g),b;if(d&&v!=v){for(;g>E;)if(b=y[E++],b!=b)return!0}else for(;g>E;E++)if((d||E in y)&&y[E]===v)return d||E||0;return!d&&-1}};e.exports={includes:c(!0),indexOf:c(!1)}},"4de4":function(e,t,r){var s=r("23e7"),l=r("b727").filter,u=r("1dde"),c=r("ae40"),d=u("filter"),f=c("filter");s({target:"Array",proto:!0,forced:!d||!f},{filter:function(p){return l(this,p,arguments.length>1?arguments[1]:void 0)}})},"4df4":function(e,t,r){var s=r("0366"),l=r("7b0b"),u=r("9bdd"),c=r("e95a"),d=r("50c4"),f=r("8418"),v=r("35a1");e.exports=function(y){var g=l(y),E=typeof this=="function"?this:Array,b=arguments.length,S=b>1?arguments[1]:void 0,C=S!==void 0,x=v(g),T=0,O,P,A,_,R,M;if(C&&(S=s(S,b>2?arguments[2]:void 0,2)),x!=null&&!(E==Array&&c(x)))for(_=x.call(g),R=_.next,P=new E;!(A=R.call(_)).done;T++)M=C?u(_,S,[A.value,T],!0):A.value,f(P,T,M);else for(O=d(g.length),P=new E(O);O>T;T++)M=C?S(g[T],T):g[T],f(P,T,M);return P.length=T,P}},"4fad":function(e,t,r){var s=r("23e7"),l=r("6f53").entries;s({target:"Object",stat:!0},{entries:function(c){return l(c)}})},"50c4":function(e,t,r){var s=r("a691"),l=Math.min;e.exports=function(u){return u>0?l(s(u),9007199254740991):0}},5135:function(e,t){var r={}.hasOwnProperty;e.exports=function(s,l){return r.call(s,l)}},5319:function(e,t,r){var s=r("d784"),l=r("825a"),u=r("7b0b"),c=r("50c4"),d=r("a691"),f=r("1d80"),v=r("8aa5"),p=r("14c3"),y=Math.max,g=Math.min,E=Math.floor,b=/\$([$&'`]|\d\d?|<[^>]*>)/g,S=/\$([$&'`]|\d\d?)/g,C=function(x){return x===void 0?x:String(x)};s("replace",2,function(x,T,O,P){var A=P.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,_=P.REPLACE_KEEPS_$0,R=A?"$":"$0";return[function(L,k){var N=f(this),V=L==null?void 0:L[x];return V!==void 0?V.call(L,N,k):T.call(String(N),L,k)},function(F,L){if(!A&&_||typeof L=="string"&&L.indexOf(R)===-1){var k=O(T,F,this,L);if(k.done)return k.value}var N=l(F),V=String(this),ae=typeof L=="function";ae||(L=String(L));var ve=N.global;if(ve){var Ue=N.unicode;N.lastIndex=0}for(var Ce=[];;){var Se=p(N,V);if(Se===null||(Ce.push(Se),!ve))break;var Ae=String(Se[0]);Ae===""&&(N.lastIndex=v(V,c(N.lastIndex),Ue))}for(var B="",H=0,Q=0;Q<Ce.length;Q++){Se=Ce[Q];for(var ne=String(Se[0]),Me=y(g(d(Se.index),V.length),0),Pe=[],ft=1;ft<Se.length;ft++)Pe.push(C(Se[ft]));var xe=Se.groups;if(ae){var Je=[ne].concat(Pe,Me,V);xe!==void 0&&Je.push(xe);var Ye=String(L.apply(void 0,Je))}else Ye=M(ne,V,Me,Pe,xe,L);Me>=H&&(B+=V.slice(H,Me)+Ye,H=Me+ne.length)}return B+V.slice(H)}];function M(F,L,k,N,V,ae){var ve=k+F.length,Ue=N.length,Ce=S;return V!==void 0&&(V=u(V),Ce=b),T.call(ae,Ce,function(Se,Ae){var B;switch(Ae.charAt(0)){case"$":return"$";case"&":return F;case"`":return L.slice(0,k);case"'":return L.slice(ve);case"<":B=V[Ae.slice(1,-1)];break;default:var H=+Ae;if(H===0)return Se;if(H>Ue){var Q=E(H/10);return Q===0?Se:Q<=Ue?N[Q-1]===void 0?Ae.charAt(1):N[Q-1]+Ae.charAt(1):Se}B=N[H-1]}return B===void 0?"":B})}})},5692:function(e,t,r){var s=r("c430"),l=r("c6cd");(e.exports=function(u,c){return l[u]||(l[u]=c!==void 0?c:{})})("versions",[]).push({version:"3.6.5",mode:s?"pure":"global",copyright:" 2020 Denis Pushkarev (zloirock.ru)"})},"56ef":function(e,t,r){var s=r("d066"),l=r("241c"),u=r("7418"),c=r("825a");e.exports=s("Reflect","ownKeys")||function(f){var v=l.f(c(f)),p=u.f;return p?v.concat(p(f)):v}},"5a34":function(e,t,r){var s=r("44e7");e.exports=function(l){if(s(l))throw TypeError("The method doesn't accept regular expressions");return l}},"5c6c":function(e,t){e.exports=function(r,s){return{enumerable:!(r&1),configurable:!(r&2),writable:!(r&4),value:s}}},"5db7":function(e,t,r){var s=r("23e7"),l=r("a2bf"),u=r("7b0b"),c=r("50c4"),d=r("1c0b"),f=r("65f0");s({target:"Array",proto:!0},{flatMap:function(p){var y=u(this),g=c(y.length),E;return d(p),E=f(y,0),E.length=l(E,y,y,g,0,1,p,arguments.length>1?arguments[1]:void 0),E}})},6547:function(e,t,r){var s=r("a691"),l=r("1d80"),u=function(c){return function(d,f){var v=String(l(d)),p=s(f),y=v.length,g,E;return p<0||p>=y?c?"":void 0:(g=v.charCodeAt(p),g<55296||g>56319||p+1===y||(E=v.charCodeAt(p+1))<56320||E>57343?c?v.charAt(p):g:c?v.slice(p,p+2):(g-55296<<10)+(E-56320)+65536)}};e.exports={codeAt:u(!1),charAt:u(!0)}},"65f0":function(e,t,r){var s=r("861d"),l=r("e8b5"),u=r("b622"),c=u("species");e.exports=function(d,f){var v;return l(d)&&(v=d.constructor,typeof v=="function"&&(v===Array||l(v.prototype))?v=void 0:s(v)&&(v=v[c],v===null&&(v=void 0))),new(v===void 0?Array:v)(f===0?0:f)}},"69f3":function(e,t,r){var s=r("7f9a"),l=r("da84"),u=r("861d"),c=r("9112"),d=r("5135"),f=r("f772"),v=r("d012"),p=l.WeakMap,y,g,E,b=function(A){return E(A)?g(A):y(A,{})},S=function(A){return function(_){var R;if(!u(_)||(R=g(_)).type!==A)throw TypeError("Incompatible receiver, "+A+" required");return R}};if(s){var C=new p,x=C.get,T=C.has,O=C.set;y=function(A,_){return O.call(C,A,_),_},g=function(A){return x.call(C,A)||{}},E=function(A){return T.call(C,A)}}else{var P=f("state");v[P]=!0,y=function(A,_){return c(A,P,_),_},g=function(A){return d(A,P)?A[P]:{}},E=function(A){return d(A,P)}}e.exports={set:y,get:g,has:E,enforce:b,getterFor:S}},"6eeb":function(e,t,r){var s=r("da84"),l=r("9112"),u=r("5135"),c=r("ce4e"),d=r("8925"),f=r("69f3"),v=f.get,p=f.enforce,y=String(String).split("String");(e.exports=function(g,E,b,S){var C=S?!!S.unsafe:!1,x=S?!!S.enumerable:!1,T=S?!!S.noTargetGet:!1;if(typeof b=="function"&&(typeof E=="string"&&!u(b,"name")&&l(b,"name",E),p(b).source=y.join(typeof E=="string"?E:"")),g===s){x?g[E]=b:c(E,b);return}else C?!T&&g[E]&&(x=!0):delete g[E];x?g[E]=b:l(g,E,b)})(Function.prototype,"toString",function(){return typeof this=="function"&&v(this).source||d(this)})},"6f53":function(e,t,r){var s=r("83ab"),l=r("df75"),u=r("fc6a"),c=r("d1e7").f,d=function(f){return function(v){for(var p=u(v),y=l(p),g=y.length,E=0,b=[],S;g>E;)S=y[E++],(!s||c.call(p,S))&&b.push(f?[S,p[S]]:p[S]);return b}};e.exports={entries:d(!0),values:d(!1)}},"73d9":function(e,t,r){var s=r("44d2");s("flatMap")},7418:function(e,t){t.f=Object.getOwnPropertySymbols},"746f":function(e,t,r){var s=r("428f"),l=r("5135"),u=r("e538"),c=r("9bf2").f;e.exports=function(d){var f=s.Symbol||(s.Symbol={});l(f,d)||c(f,d,{value:u.f(d)})}},7839:function(e,t){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},"7b0b":function(e,t,r){var s=r("1d80");e.exports=function(l){return Object(s(l))}},"7c73":function(e,t,r){var s=r("825a"),l=r("37e8"),u=r("7839"),c=r("d012"),d=r("1be4"),f=r("cc12"),v=r("f772"),p=">",y="<",g="prototype",E="script",b=v("IE_PROTO"),S=function(){},C=function(A){return y+E+p+A+y+"/"+E+p},x=function(A){A.write(C("")),A.close();var _=A.parentWindow.Object;return A=null,_},T=function(){var A=f("iframe"),_="java"+E+":",R;return A.style.display="none",d.appendChild(A),A.src=String(_),R=A.contentWindow.document,R.open(),R.write(C("document.F=Object")),R.close(),R.F},O,P=function(){try{O=document.domain&&new ActiveXObject("htmlfile")}catch{}P=O?x(O):T();for(var A=u.length;A--;)delete P[g][u[A]];return P()};c[b]=!0,e.exports=Object.create||function(_,R){var M;return _!==null?(S[g]=s(_),M=new S,S[g]=null,M[b]=_):M=P(),R===void 0?M:l(M,R)}},"7dd0":function(e,t,r){var s=r("23e7"),l=r("9ed3"),u=r("e163"),c=r("d2bb"),d=r("d44e"),f=r("9112"),v=r("6eeb"),p=r("b622"),y=r("c430"),g=r("3f8c"),E=r("ae93"),b=E.IteratorPrototype,S=E.BUGGY_SAFARI_ITERATORS,C=p("iterator"),x="keys",T="values",O="entries",P=function(){return this};e.exports=function(A,_,R,M,F,L,k){l(R,_,M);var N=function(Q){if(Q===F&&Ce)return Ce;if(!S&&Q in ve)return ve[Q];switch(Q){case x:return function(){return new R(this,Q)};case T:return function(){return new R(this,Q)};case O:return function(){return new R(this,Q)}}return function(){return new R(this)}},V=_+" Iterator",ae=!1,ve=A.prototype,Ue=ve[C]||ve["@@iterator"]||F&&ve[F],Ce=!S&&Ue||N(F),Se=_=="Array"&&ve.entries||Ue,Ae,B,H;if(Se&&(Ae=u(Se.call(new A)),b!==Object.prototype&&Ae.next&&(!y&&u(Ae)!==b&&(c?c(Ae,b):typeof Ae[C]!="function"&&f(Ae,C,P)),d(Ae,V,!0,!0),y&&(g[V]=P))),F==T&&Ue&&Ue.name!==T&&(ae=!0,Ce=function(){return Ue.call(this)}),(!y||k)&&ve[C]!==Ce&&f(ve,C,Ce),g[_]=Ce,F)if(B={values:N(T),keys:L?Ce:N(x),entries:N(O)},k)for(H in B)(S||ae||!(H in ve))&&v(ve,H,B[H]);else s({target:_,proto:!0,forced:S||ae},B);return B}},"7f9a":function(e,t,r){var s=r("da84"),l=r("8925"),u=s.WeakMap;e.exports=typeof u=="function"&&/native code/.test(l(u))},"825a":function(e,t,r){var s=r("861d");e.exports=function(l){if(!s(l))throw TypeError(String(l)+" is not an object");return l}},"83ab":function(e,t,r){var s=r("d039");e.exports=!s(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7})},8418:function(e,t,r){var s=r("c04e"),l=r("9bf2"),u=r("5c6c");e.exports=function(c,d,f){var v=s(d);v in c?l.f(c,v,u(0,f)):c[v]=f}},"861d":function(e,t){e.exports=function(r){return typeof r=="object"?r!==null:typeof r=="function"}},8875:function(e,t,r){var s,l,u;(function(c,d){l=[],s=d,u=typeof s=="function"?s.apply(t,l):s,u!==void 0&&(e.exports=u)})(typeof self<"u"?self:this,function(){function c(){var d=Object.getOwnPropertyDescriptor(document,"currentScript");if(!d&&"currentScript"in document&&document.currentScript||d&&d.get!==c&&document.currentScript)return document.currentScript;try{throw new Error}catch(O){var f=/.*at [^(]*\((.*):(.+):(.+)\)$/ig,v=/@([^@]*):(\d+):(\d+)\s*$/ig,p=f.exec(O.stack)||v.exec(O.stack),y=p&&p[1]||!1,g=p&&p[2]||!1,E=document.location.href.replace(document.location.hash,""),b,S,C,x=document.getElementsByTagName("script");y===E&&(b=document.documentElement.outerHTML,S=new RegExp("(?:[^\\n]+?\\n){0,"+(g-2)+"}[^<]*<script>([\\d\\D]*?)<\\/script>[\\d\\D]*","i"),C=b.replace(S,"$1").trim());for(var T=0;T<x.length;T++)if(x[T].readyState==="interactive"||x[T].src===y||y===E&&x[T].innerHTML&&x[T].innerHTML.trim()===C)return x[T];return null}}return c})},8925:function(e,t,r){var s=r("c6cd"),l=Function.toString;typeof s.inspectSource!="function"&&(s.inspectSource=function(u){return l.call(u)}),e.exports=s.inspectSource},"8aa5":function(e,t,r){var s=r("6547").charAt;e.exports=function(l,u,c){return u+(c?s(l,u).length:1)}},"8bbf":function(e,t){e.exports=n},"90e3":function(e,t){var r=0,s=Math.random();e.exports=function(l){return"Symbol("+String(l===void 0?"":l)+")_"+(++r+s).toString(36)}},9112:function(e,t,r){var s=r("83ab"),l=r("9bf2"),u=r("5c6c");e.exports=s?function(c,d,f){return l.f(c,d,u(1,f))}:function(c,d,f){return c[d]=f,c}},9263:function(e,t,r){var s=r("ad6d"),l=r("9f7f"),u=RegExp.prototype.exec,c=String.prototype.replace,d=u,f=function(){var g=/a/,E=/b*/g;return u.call(g,"a"),u.call(E,"a"),g.lastIndex!==0||E.lastIndex!==0}(),v=l.UNSUPPORTED_Y||l.BROKEN_CARET,p=/()??/.exec("")[1]!==void 0,y=f||p||v;y&&(d=function(E){var b=this,S,C,x,T,O=v&&b.sticky,P=s.call(b),A=b.source,_=0,R=E;return O&&(P=P.replace("y",""),P.indexOf("g")===-1&&(P+="g"),R=String(E).slice(b.lastIndex),b.lastIndex>0&&(!b.multiline||b.multiline&&E[b.lastIndex-1]!==`
`)&&(A="(?: "+A+")",R=" "+R,_++),C=new RegExp("^(?:"+A+")",P)),p&&(C=new RegExp("^"+A+"$(?!\\s)",P)),f&&(S=b.lastIndex),x=u.call(O?C:b,R),O?x?(x.input=x.input.slice(_),x[0]=x[0].slice(_),x.index=b.lastIndex,b.lastIndex+=x[0].length):b.lastIndex=0:f&&x&&(b.lastIndex=b.global?x.index+x[0].length:S),p&&x&&x.length>1&&c.call(x[0],C,function(){for(T=1;T<arguments.length-2;T++)arguments[T]===void 0&&(x[T]=void 0)}),x}),e.exports=d},"94ca":function(e,t,r){var s=r("d039"),l=/#|\.prototype\./,u=function(p,y){var g=d[c(p)];return g==v?!0:g==f?!1:typeof y=="function"?s(y):!!y},c=u.normalize=function(p){return String(p).replace(l,".").toLowerCase()},d=u.data={},f=u.NATIVE="N",v=u.POLYFILL="P";e.exports=u},"99af":function(e,t,r){var s=r("23e7"),l=r("d039"),u=r("e8b5"),c=r("861d"),d=r("7b0b"),f=r("50c4"),v=r("8418"),p=r("65f0"),y=r("1dde"),g=r("b622"),E=r("2d00"),b=g("isConcatSpreadable"),S=9007199254740991,C="Maximum allowed index exceeded",x=E>=51||!l(function(){var A=[];return A[b]=!1,A.concat()[0]!==A}),T=y("concat"),O=function(A){if(!c(A))return!1;var _=A[b];return _!==void 0?!!_:u(A)},P=!x||!T;s({target:"Array",proto:!0,forced:P},{concat:function(_){var R=d(this),M=p(R,0),F=0,L,k,N,V,ae;for(L=-1,N=arguments.length;L<N;L++)if(ae=L===-1?R:arguments[L],O(ae)){if(V=f(ae.length),F+V>S)throw TypeError(C);for(k=0;k<V;k++,F++)k in ae&&v(M,F,ae[k])}else{if(F>=S)throw TypeError(C);v(M,F++,ae)}return M.length=F,M}})},"9bdd":function(e,t,r){var s=r("825a");e.exports=function(l,u,c,d){try{return d?u(s(c)[0],c[1]):u(c)}catch(v){var f=l.return;throw f!==void 0&&s(f.call(l)),v}}},"9bf2":function(e,t,r){var s=r("83ab"),l=r("0cfb"),u=r("825a"),c=r("c04e"),d=Object.defineProperty;t.f=s?d:function(v,p,y){if(u(v),p=c(p,!0),u(y),l)try{return d(v,p,y)}catch{}if("get"in y||"set"in y)throw TypeError("Accessors not supported");return"value"in y&&(v[p]=y.value),v}},"9ed3":function(e,t,r){var s=r("ae93").IteratorPrototype,l=r("7c73"),u=r("5c6c"),c=r("d44e"),d=r("3f8c"),f=function(){return this};e.exports=function(v,p,y){var g=p+" Iterator";return v.prototype=l(s,{next:u(1,y)}),c(v,g,!1,!0),d[g]=f,v}},"9f7f":function(e,t,r){var s=r("d039");function l(u,c){return RegExp(u,c)}t.UNSUPPORTED_Y=s(function(){var u=l("a","y");return u.lastIndex=2,u.exec("abcd")!=null}),t.BROKEN_CARET=s(function(){var u=l("^r","gy");return u.lastIndex=2,u.exec("str")!=null})},a2bf:function(e,t,r){var s=r("e8b5"),l=r("50c4"),u=r("0366"),c=function(d,f,v,p,y,g,E,b){for(var S=y,C=0,x=E?u(E,b,3):!1,T;C<p;){if(C in v){if(T=x?x(v[C],C,f):v[C],g>0&&s(T))S=c(d,f,T,l(T.length),S,g-1)-1;else{if(S>=9007199254740991)throw TypeError("Exceed the acceptable array length");d[S]=T}S++}C++}return S};e.exports=c},a352:function(e,t){e.exports=i},a434:function(e,t,r){var s=r("23e7"),l=r("23cb"),u=r("a691"),c=r("50c4"),d=r("7b0b"),f=r("65f0"),v=r("8418"),p=r("1dde"),y=r("ae40"),g=p("splice"),E=y("splice",{ACCESSORS:!0,0:0,1:2}),b=Math.max,S=Math.min,C=9007199254740991,x="Maximum allowed length exceeded";s({target:"Array",proto:!0,forced:!g||!E},{splice:function(O,P){var A=d(this),_=c(A.length),R=l(O,_),M=arguments.length,F,L,k,N,V,ae;if(M===0?F=L=0:M===1?(F=0,L=_-R):(F=M-2,L=S(b(u(P),0),_-R)),_+F-L>C)throw TypeError(x);for(k=f(A,L),N=0;N<L;N++)V=R+N,V in A&&v(k,N,A[V]);if(k.length=L,F<L){for(N=R;N<_-L;N++)V=N+L,ae=N+F,V in A?A[ae]=A[V]:delete A[ae];for(N=_;N>_-L+F;N--)delete A[N-1]}else if(F>L)for(N=_-L;N>R;N--)V=N+L-1,ae=N+F-1,V in A?A[ae]=A[V]:delete A[ae];for(N=0;N<F;N++)A[N+R]=arguments[N+2];return A.length=_-L+F,k}})},a4d3:function(e,t,r){var s=r("23e7"),l=r("da84"),u=r("d066"),c=r("c430"),d=r("83ab"),f=r("4930"),v=r("fdbf"),p=r("d039"),y=r("5135"),g=r("e8b5"),E=r("861d"),b=r("825a"),S=r("7b0b"),C=r("fc6a"),x=r("c04e"),T=r("5c6c"),O=r("7c73"),P=r("df75"),A=r("241c"),_=r("057f"),R=r("7418"),M=r("06cf"),F=r("9bf2"),L=r("d1e7"),k=r("9112"),N=r("6eeb"),V=r("5692"),ae=r("f772"),ve=r("d012"),Ue=r("90e3"),Ce=r("b622"),Se=r("e538"),Ae=r("746f"),B=r("d44e"),H=r("69f3"),Q=r("b727").forEach,ne=ae("hidden"),Me="Symbol",Pe="prototype",ft=Ce("toPrimitive"),xe=H.set,Je=H.getterFor(Me),Ye=Object[Pe],$e=l.Symbol,fn=u("JSON","stringify"),Mt=M.f,kt=F.f,ui=_.f,mo=L.f,Ct=V("symbols"),zt=V("op-symbols"),Fn=V("string-to-symbol-registry"),pr=V("symbol-to-string-registry"),gr=V("wks"),yr=l.QObject,mr=!yr||!yr[Pe]||!yr[Pe].findChild,Er=d&&p(function(){return O(kt({},"a",{get:function(){return kt(this,"a",{value:7}).a}})).a!=7})?function(ee,X,z){var pe=Mt(Ye,X);pe&&delete Ye[X],kt(ee,X,z),pe&&ee!==Ye&&kt(Ye,X,pe)}:kt,br=function(ee,X){var z=Ct[ee]=O($e[Pe]);return xe(z,{type:Me,tag:ee,description:X}),d||(z.description=X),z},I=v?function(ee){return typeof ee=="symbol"}:function(ee){return Object(ee)instanceof $e},D=function(X,z,pe){X===Ye&&D(zt,z,pe),b(X);var ge=x(z,!0);return b(pe),y(Ct,ge)?(pe.enumerable?(y(X,ne)&&X[ne][ge]&&(X[ne][ge]=!1),pe=O(pe,{enumerable:T(0,!1)})):(y(X,ne)||kt(X,ne,T(1,{})),X[ne][ge]=!0),Er(X,ge,pe)):kt(X,ge,pe)},w=function(X,z){b(X);var pe=C(z),ge=P(pe).concat(ye(pe));return Q(ge,function(ut){(!d||U.call(pe,ut))&&D(X,ut,pe[ut])}),X},G=function(X,z){return z===void 0?O(X):w(O(X),z)},U=function(X){var z=x(X,!0),pe=mo.call(this,z);return this===Ye&&y(Ct,z)&&!y(zt,z)?!1:pe||!y(this,z)||!y(Ct,z)||y(this,ne)&&this[ne][z]?pe:!0},q=function(X,z){var pe=C(X),ge=x(z,!0);if(!(pe===Ye&&y(Ct,ge)&&!y(zt,ge))){var ut=Mt(pe,ge);return ut&&y(Ct,ge)&&!(y(pe,ne)&&pe[ne][ge])&&(ut.enumerable=!0),ut}},oe=function(X){var z=ui(C(X)),pe=[];return Q(z,function(ge){!y(Ct,ge)&&!y(ve,ge)&&pe.push(ge)}),pe},ye=function(X){var z=X===Ye,pe=ui(z?zt:C(X)),ge=[];return Q(pe,function(ut){y(Ct,ut)&&(!z||y(Ye,ut))&&ge.push(Ct[ut])}),ge};if(f||($e=function(){if(this instanceof $e)throw TypeError("Symbol is not a constructor");var X=!arguments.length||arguments[0]===void 0?void 0:String(arguments[0]),z=Ue(X),pe=function(ge){this===Ye&&pe.call(zt,ge),y(this,ne)&&y(this[ne],z)&&(this[ne][z]=!1),Er(this,z,T(1,ge))};return d&&mr&&Er(Ye,z,{configurable:!0,set:pe}),br(z,X)},N($e[Pe],"toString",function(){return Je(this).tag}),N($e,"withoutSetter",function(ee){return br(Ue(ee),ee)}),L.f=U,F.f=D,M.f=q,A.f=_.f=oe,R.f=ye,Se.f=function(ee){return br(Ce(ee),ee)},d&&(kt($e[Pe],"description",{configurable:!0,get:function(){return Je(this).description}}),c||N(Ye,"propertyIsEnumerable",U,{unsafe:!0}))),s({global:!0,wrap:!0,forced:!f,sham:!f},{Symbol:$e}),Q(P(gr),function(ee){Ae(ee)}),s({target:Me,stat:!0,forced:!f},{for:function(ee){var X=String(ee);if(y(Fn,X))return Fn[X];var z=$e(X);return Fn[X]=z,pr[z]=X,z},keyFor:function(X){if(!I(X))throw TypeError(X+" is not a symbol");if(y(pr,X))return pr[X]},useSetter:function(){mr=!0},useSimple:function(){mr=!1}}),s({target:"Object",stat:!0,forced:!f,sham:!d},{create:G,defineProperty:D,defineProperties:w,getOwnPropertyDescriptor:q}),s({target:"Object",stat:!0,forced:!f},{getOwnPropertyNames:oe,getOwnPropertySymbols:ye}),s({target:"Object",stat:!0,forced:p(function(){R.f(1)})},{getOwnPropertySymbols:function(X){return R.f(S(X))}}),fn){var Ve=!f||p(function(){var ee=$e();return fn([ee])!="[null]"||fn({a:ee})!="{}"||fn(Object(ee))!="{}"});s({target:"JSON",stat:!0,forced:Ve},{stringify:function(X,z,pe){for(var ge=[X],ut=1,Eo;arguments.length>ut;)ge.push(arguments[ut++]);if(Eo=z,!(!E(z)&&X===void 0||I(X)))return g(z)||(z=function(ju,ci){if(typeof Eo=="function"&&(ci=Eo.call(this,ju,ci)),!I(ci))return ci}),ge[1]=z,fn.apply(null,ge)}})}$e[Pe][ft]||k($e[Pe],ft,$e[Pe].valueOf),B($e,Me),ve[ne]=!0},a630:function(e,t,r){var s=r("23e7"),l=r("4df4"),u=r("1c7e"),c=!u(function(d){Array.from(d)});s({target:"Array",stat:!0,forced:c},{from:l})},a640:function(e,t,r){var s=r("d039");e.exports=function(l,u){var c=[][l];return!!c&&s(function(){c.call(null,u||function(){throw 1},1)})}},a691:function(e,t){var r=Math.ceil,s=Math.floor;e.exports=function(l){return isNaN(l=+l)?0:(l>0?s:r)(l)}},ab13:function(e,t,r){var s=r("b622"),l=s("match");e.exports=function(u){var c=/./;try{"/./"[u](c)}catch{try{return c[l]=!1,"/./"[u](c)}catch{}}return!1}},ac1f:function(e,t,r){var s=r("23e7"),l=r("9263");s({target:"RegExp",proto:!0,forced:/./.exec!==l},{exec:l})},ad6d:function(e,t,r){var s=r("825a");e.exports=function(){var l=s(this),u="";return l.global&&(u+="g"),l.ignoreCase&&(u+="i"),l.multiline&&(u+="m"),l.dotAll&&(u+="s"),l.unicode&&(u+="u"),l.sticky&&(u+="y"),u}},ae40:function(e,t,r){var s=r("83ab"),l=r("d039"),u=r("5135"),c=Object.defineProperty,d={},f=function(v){throw v};e.exports=function(v,p){if(u(d,v))return d[v];p||(p={});var y=[][v],g=u(p,"ACCESSORS")?p.ACCESSORS:!1,E=u(p,0)?p[0]:f,b=u(p,1)?p[1]:void 0;return d[v]=!!y&&!l(function(){if(g&&!s)return!0;var S={length:-1};g?c(S,1,{enumerable:!0,get:f}):S[1]=1,y.call(S,E,b)})}},ae93:function(e,t,r){var s=r("e163"),l=r("9112"),u=r("5135"),c=r("b622"),d=r("c430"),f=c("iterator"),v=!1,p=function(){return this},y,g,E;[].keys&&(E=[].keys(),"next"in E?(g=s(s(E)),g!==Object.prototype&&(y=g)):v=!0),y==null&&(y={}),!d&&!u(y,f)&&l(y,f,p),e.exports={IteratorPrototype:y,BUGGY_SAFARI_ITERATORS:v}},b041:function(e,t,r){var s=r("00ee"),l=r("f5df");e.exports=s?{}.toString:function(){return"[object "+l(this)+"]"}},b0c0:function(e,t,r){var s=r("83ab"),l=r("9bf2").f,u=Function.prototype,c=u.toString,d=/^\s*function ([^ (]*)/,f="name";s&&!(f in u)&&l(u,f,{configurable:!0,get:function(){try{return c.call(this).match(d)[1]}catch{return""}}})},b622:function(e,t,r){var s=r("da84"),l=r("5692"),u=r("5135"),c=r("90e3"),d=r("4930"),f=r("fdbf"),v=l("wks"),p=s.Symbol,y=f?p:p&&p.withoutSetter||c;e.exports=function(g){return u(v,g)||(d&&u(p,g)?v[g]=p[g]:v[g]=y("Symbol."+g)),v[g]}},b64b:function(e,t,r){var s=r("23e7"),l=r("7b0b"),u=r("df75"),c=r("d039"),d=c(function(){u(1)});s({target:"Object",stat:!0,forced:d},{keys:function(v){return u(l(v))}})},b727:function(e,t,r){var s=r("0366"),l=r("44ad"),u=r("7b0b"),c=r("50c4"),d=r("65f0"),f=[].push,v=function(p){var y=p==1,g=p==2,E=p==3,b=p==4,S=p==6,C=p==5||S;return function(x,T,O,P){for(var A=u(x),_=l(A),R=s(T,O,3),M=c(_.length),F=0,L=P||d,k=y?L(x,M):g?L(x,0):void 0,N,V;M>F;F++)if((C||F in _)&&(N=_[F],V=R(N,F,A),p)){if(y)k[F]=V;else if(V)switch(p){case 3:return!0;case 5:return N;case 6:return F;case 2:f.call(k,N)}else if(b)return!1}return S?-1:E||b?b:k}};e.exports={forEach:v(0),map:v(1),filter:v(2),some:v(3),every:v(4),find:v(5),findIndex:v(6)}},c04e:function(e,t,r){var s=r("861d");e.exports=function(l,u){if(!s(l))return l;var c,d;if(u&&typeof(c=l.toString)=="function"&&!s(d=c.call(l))||typeof(c=l.valueOf)=="function"&&!s(d=c.call(l))||!u&&typeof(c=l.toString)=="function"&&!s(d=c.call(l)))return d;throw TypeError("Can't convert object to primitive value")}},c430:function(e,t){e.exports=!1},c6b6:function(e,t){var r={}.toString;e.exports=function(s){return r.call(s).slice(8,-1)}},c6cd:function(e,t,r){var s=r("da84"),l=r("ce4e"),u="__core-js_shared__",c=s[u]||l(u,{});e.exports=c},c740:function(e,t,r){var s=r("23e7"),l=r("b727").findIndex,u=r("44d2"),c=r("ae40"),d="findIndex",f=!0,v=c(d);d in[]&&Array(1)[d](function(){f=!1}),s({target:"Array",proto:!0,forced:f||!v},{findIndex:function(y){return l(this,y,arguments.length>1?arguments[1]:void 0)}}),u(d)},c8ba:function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch{typeof window=="object"&&(r=window)}e.exports=r},c975:function(e,t,r){var s=r("23e7"),l=r("4d64").indexOf,u=r("a640"),c=r("ae40"),d=[].indexOf,f=!!d&&1/[1].indexOf(1,-0)<0,v=u("indexOf"),p=c("indexOf",{ACCESSORS:!0,1:0});s({target:"Array",proto:!0,forced:f||!v||!p},{indexOf:function(g){return f?d.apply(this,arguments)||0:l(this,g,arguments.length>1?arguments[1]:void 0)}})},ca84:function(e,t,r){var s=r("5135"),l=r("fc6a"),u=r("4d64").indexOf,c=r("d012");e.exports=function(d,f){var v=l(d),p=0,y=[],g;for(g in v)!s(c,g)&&s(v,g)&&y.push(g);for(;f.length>p;)s(v,g=f[p++])&&(~u(y,g)||y.push(g));return y}},caad:function(e,t,r){var s=r("23e7"),l=r("4d64").includes,u=r("44d2"),c=r("ae40"),d=c("indexOf",{ACCESSORS:!0,1:0});s({target:"Array",proto:!0,forced:!d},{includes:function(v){return l(this,v,arguments.length>1?arguments[1]:void 0)}}),u("includes")},cc12:function(e,t,r){var s=r("da84"),l=r("861d"),u=s.document,c=l(u)&&l(u.createElement);e.exports=function(d){return c?u.createElement(d):{}}},ce4e:function(e,t,r){var s=r("da84"),l=r("9112");e.exports=function(u,c){try{l(s,u,c)}catch{s[u]=c}return c}},d012:function(e,t){e.exports={}},d039:function(e,t){e.exports=function(r){try{return!!r()}catch{return!0}}},d066:function(e,t,r){var s=r("428f"),l=r("da84"),u=function(c){return typeof c=="function"?c:void 0};e.exports=function(c,d){return arguments.length<2?u(s[c])||u(l[c]):s[c]&&s[c][d]||l[c]&&l[c][d]}},d1e7:function(e,t,r){var s={}.propertyIsEnumerable,l=Object.getOwnPropertyDescriptor,u=l&&!s.call({1:2},1);t.f=u?function(d){var f=l(this,d);return!!f&&f.enumerable}:s},d28b:function(e,t,r){var s=r("746f");s("iterator")},d2bb:function(e,t,r){var s=r("825a"),l=r("3bbe");e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var u=!1,c={},d;try{d=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set,d.call(c,[]),u=c instanceof Array}catch{}return function(v,p){return s(v),l(p),u?d.call(v,p):v.__proto__=p,v}}():void 0)},d3b7:function(e,t,r){var s=r("00ee"),l=r("6eeb"),u=r("b041");s||l(Object.prototype,"toString",u,{unsafe:!0})},d44e:function(e,t,r){var s=r("9bf2").f,l=r("5135"),u=r("b622"),c=u("toStringTag");e.exports=function(d,f,v){d&&!l(d=v?d:d.prototype,c)&&s(d,c,{configurable:!0,value:f})}},d58f:function(e,t,r){var s=r("1c0b"),l=r("7b0b"),u=r("44ad"),c=r("50c4"),d=function(f){return function(v,p,y,g){s(p);var E=l(v),b=u(E),S=c(E.length),C=f?S-1:0,x=f?-1:1;if(y<2)for(;;){if(C in b){g=b[C],C+=x;break}if(C+=x,f?C<0:S<=C)throw TypeError("Reduce of empty array with no initial value")}for(;f?C>=0:S>C;C+=x)C in b&&(g=p(g,b[C],C,E));return g}};e.exports={left:d(!1),right:d(!0)}},d784:function(e,t,r){r("ac1f");var s=r("6eeb"),l=r("d039"),u=r("b622"),c=r("9263"),d=r("9112"),f=u("species"),v=!l(function(){var b=/./;return b.exec=function(){var S=[];return S.groups={a:"7"},S},"".replace(b,"$<a>")!=="7"}),p=function(){return"a".replace(/./,"$0")==="$0"}(),y=u("replace"),g=function(){return/./[y]?/./[y]("a","$0")==="":!1}(),E=!l(function(){var b=/(?:)/,S=b.exec;b.exec=function(){return S.apply(this,arguments)};var C="ab".split(b);return C.length!==2||C[0]!=="a"||C[1]!=="b"});e.exports=function(b,S,C,x){var T=u(b),O=!l(function(){var F={};return F[T]=function(){return 7},""[b](F)!=7}),P=O&&!l(function(){var F=!1,L=/a/;return b==="split"&&(L={},L.constructor={},L.constructor[f]=function(){return L},L.flags="",L[T]=/./[T]),L.exec=function(){return F=!0,null},L[T](""),!F});if(!O||!P||b==="replace"&&!(v&&p&&!g)||b==="split"&&!E){var A=/./[T],_=C(T,""[b],function(F,L,k,N,V){return L.exec===c?O&&!V?{done:!0,value:A.call(L,k,N)}:{done:!0,value:F.call(k,L,N)}:{done:!1}},{REPLACE_KEEPS_$0:p,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:g}),R=_[0],M=_[1];s(String.prototype,b,R),s(RegExp.prototype,T,S==2?function(F,L){return M.call(F,this,L)}:function(F){return M.call(F,this)})}x&&d(RegExp.prototype[T],"sham",!0)}},d81d:function(e,t,r){var s=r("23e7"),l=r("b727").map,u=r("1dde"),c=r("ae40"),d=u("map"),f=c("map");s({target:"Array",proto:!0,forced:!d||!f},{map:function(p){return l(this,p,arguments.length>1?arguments[1]:void 0)}})},da84:function(e,t,r){(function(s){var l=function(u){return u&&u.Math==Math&&u};e.exports=l(typeof globalThis=="object"&&globalThis)||l(typeof window=="object"&&window)||l(typeof self=="object"&&self)||l(typeof s=="object"&&s)||Function("return this")()}).call(this,r("c8ba"))},dbb4:function(e,t,r){var s=r("23e7"),l=r("83ab"),u=r("56ef"),c=r("fc6a"),d=r("06cf"),f=r("8418");s({target:"Object",stat:!0,sham:!l},{getOwnPropertyDescriptors:function(p){for(var y=c(p),g=d.f,E=u(y),b={},S=0,C,x;E.length>S;)x=g(y,C=E[S++]),x!==void 0&&f(b,C,x);return b}})},dbf1:function(e,t,r){(function(s){r.d(t,"a",function(){return u});function l(){return typeof window<"u"?window.console:s.console}var u=l()}).call(this,r("c8ba"))},ddb0:function(e,t,r){var s=r("da84"),l=r("fdbc"),u=r("e260"),c=r("9112"),d=r("b622"),f=d("iterator"),v=d("toStringTag"),p=u.values;for(var y in l){var g=s[y],E=g&&g.prototype;if(E){if(E[f]!==p)try{c(E,f,p)}catch{E[f]=p}if(E[v]||c(E,v,y),l[y]){for(var b in u)if(E[b]!==u[b])try{c(E,b,u[b])}catch{E[b]=u[b]}}}}},df75:function(e,t,r){var s=r("ca84"),l=r("7839");e.exports=Object.keys||function(c){return s(c,l)}},e01a:function(e,t,r){var s=r("23e7"),l=r("83ab"),u=r("da84"),c=r("5135"),d=r("861d"),f=r("9bf2").f,v=r("e893"),p=u.Symbol;if(l&&typeof p=="function"&&(!("description"in p.prototype)||p().description!==void 0)){var y={},g=function(){var T=arguments.length<1||arguments[0]===void 0?void 0:String(arguments[0]),O=this instanceof g?new p(T):T===void 0?p():p(T);return T===""&&(y[O]=!0),O};v(g,p);var E=g.prototype=p.prototype;E.constructor=g;var b=E.toString,S=String(p("test"))=="Symbol(test)",C=/^Symbol\((.*)\)[^)]+$/;f(E,"description",{configurable:!0,get:function(){var T=d(this)?this.valueOf():this,O=b.call(T);if(c(y,T))return"";var P=S?O.slice(7,-1):O.replace(C,"$1");return P===""?void 0:P}}),s({global:!0,forced:!0},{Symbol:g})}},e163:function(e,t,r){var s=r("5135"),l=r("7b0b"),u=r("f772"),c=r("e177"),d=u("IE_PROTO"),f=Object.prototype;e.exports=c?Object.getPrototypeOf:function(v){return v=l(v),s(v,d)?v[d]:typeof v.constructor=="function"&&v instanceof v.constructor?v.constructor.prototype:v instanceof Object?f:null}},e177:function(e,t,r){var s=r("d039");e.exports=!s(function(){function l(){}return l.prototype.constructor=null,Object.getPrototypeOf(new l)!==l.prototype})},e260:function(e,t,r){var s=r("fc6a"),l=r("44d2"),u=r("3f8c"),c=r("69f3"),d=r("7dd0"),f="Array Iterator",v=c.set,p=c.getterFor(f);e.exports=d(Array,"Array",function(y,g){v(this,{type:f,target:s(y),index:0,kind:g})},function(){var y=p(this),g=y.target,E=y.kind,b=y.index++;return!g||b>=g.length?(y.target=void 0,{value:void 0,done:!0}):E=="keys"?{value:b,done:!1}:E=="values"?{value:g[b],done:!1}:{value:[b,g[b]],done:!1}},"values"),u.Arguments=u.Array,l("keys"),l("values"),l("entries")},e439:function(e,t,r){var s=r("23e7"),l=r("d039"),u=r("fc6a"),c=r("06cf").f,d=r("83ab"),f=l(function(){c(1)}),v=!d||f;s({target:"Object",stat:!0,forced:v,sham:!d},{getOwnPropertyDescriptor:function(y,g){return c(u(y),g)}})},e538:function(e,t,r){var s=r("b622");t.f=s},e893:function(e,t,r){var s=r("5135"),l=r("56ef"),u=r("06cf"),c=r("9bf2");e.exports=function(d,f){for(var v=l(f),p=c.f,y=u.f,g=0;g<v.length;g++){var E=v[g];s(d,E)||p(d,E,y(f,E))}}},e8b5:function(e,t,r){var s=r("c6b6");e.exports=Array.isArray||function(u){return s(u)=="Array"}},e95a:function(e,t,r){var s=r("b622"),l=r("3f8c"),u=s("iterator"),c=Array.prototype;e.exports=function(d){return d!==void 0&&(l.Array===d||c[u]===d)}},f5df:function(e,t,r){var s=r("00ee"),l=r("c6b6"),u=r("b622"),c=u("toStringTag"),d=l(function(){return arguments}())=="Arguments",f=function(v,p){try{return v[p]}catch{}};e.exports=s?l:function(v){var p,y,g;return v===void 0?"Undefined":v===null?"Null":typeof(y=f(p=Object(v),c))=="string"?y:d?l(p):(g=l(p))=="Object"&&typeof p.callee=="function"?"Arguments":g}},f772:function(e,t,r){var s=r("5692"),l=r("90e3"),u=s("keys");e.exports=function(c){return u[c]||(u[c]=l(c))}},fb15:function(e,t,r){if(r.r(t),typeof window<"u"){var s=window.document.currentScript;{var l=r("8875");s=l(),"currentScript"in document||Object.defineProperty(document,"currentScript",{get:l})}var u=s&&s.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);u&&(r.p=u[1])}r("99af"),r("4de4"),r("4160"),r("c975"),r("d81d"),r("a434"),r("159b"),r("a4d3"),r("e439"),r("dbb4"),r("b64b");function c(I,D,w){return D in I?Object.defineProperty(I,D,{value:w,enumerable:!0,configurable:!0,writable:!0}):I[D]=w,I}function d(I,D){var w=Object.keys(I);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(I);D&&(G=G.filter(function(U){return Object.getOwnPropertyDescriptor(I,U).enumerable})),w.push.apply(w,G)}return w}function f(I){for(var D=1;D<arguments.length;D++){var w=arguments[D]!=null?arguments[D]:{};D%2?d(Object(w),!0).forEach(function(G){c(I,G,w[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(I,Object.getOwnPropertyDescriptors(w)):d(Object(w)).forEach(function(G){Object.defineProperty(I,G,Object.getOwnPropertyDescriptor(w,G))})}return I}function v(I){if(Array.isArray(I))return I}r("e01a"),r("d28b"),r("e260"),r("d3b7"),r("3ca3"),r("ddb0");function p(I,D){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(I)))){var w=[],G=!0,U=!1,q=void 0;try{for(var oe=I[Symbol.iterator](),ye;!(G=(ye=oe.next()).done)&&(w.push(ye.value),!(D&&w.length===D));G=!0);}catch(Ve){U=!0,q=Ve}finally{try{!G&&oe.return!=null&&oe.return()}finally{if(U)throw q}}return w}}r("a630"),r("fb6a"),r("b0c0"),r("25f0");function y(I,D){(D==null||D>I.length)&&(D=I.length);for(var w=0,G=new Array(D);w<D;w++)G[w]=I[w];return G}function g(I,D){if(I){if(typeof I=="string")return y(I,D);var w=Object.prototype.toString.call(I).slice(8,-1);if(w==="Object"&&I.constructor&&(w=I.constructor.name),w==="Map"||w==="Set")return Array.from(I);if(w==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(w))return y(I,D)}}function E(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function b(I,D){return v(I)||p(I,D)||g(I,D)||E()}function S(I){if(Array.isArray(I))return y(I)}function C(I){if(typeof Symbol<"u"&&Symbol.iterator in Object(I))return Array.from(I)}function x(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function T(I){return S(I)||C(I)||g(I)||x()}var O=r("a352"),P=r.n(O);function A(I){I.parentElement!==null&&I.parentElement.removeChild(I)}function _(I,D,w){var G=w===0?I.children[0]:I.children[w-1].nextSibling;I.insertBefore(D,G)}var R=r("dbf1");r("13d5"),r("4fad"),r("ac1f"),r("5319");function M(I){var D=Object.create(null);return function(G){var U=D[G];return U||(D[G]=I(G))}}var F=/-(\w)/g,L=M(function(I){return I.replace(F,function(D,w){return w.toUpperCase()})});r("5db7"),r("73d9");var k=["Start","Add","Remove","Update","End"],N=["Choose","Unchoose","Sort","Filter","Clone"],V=["Move"],ae=[V,k,N].flatMap(function(I){return I}).map(function(I){return"on".concat(I)}),ve={manage:V,manageAndEmit:k,emit:N};function Ue(I){return ae.indexOf(I)!==-1}r("caad"),r("2ca0");var Ce=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","link","main","map","mark","math","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rb","rp","rt","rtc","ruby","s","samp","script","section","select","slot","small","source","span","strong","style","sub","summary","sup","svg","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr"];function Se(I){return Ce.includes(I)}function Ae(I){return["transition-group","TransitionGroup"].includes(I)}function B(I){return["id","class","role","style"].includes(I)||I.startsWith("data-")||I.startsWith("aria-")||I.startsWith("on")}function H(I){return I.reduce(function(D,w){var G=b(w,2),U=G[0],q=G[1];return D[U]=q,D},{})}function Q(I){var D=I.$attrs,w=I.componentData,G=w===void 0?{}:w,U=H(Object.entries(D).filter(function(q){var oe=b(q,2),ye=oe[0];return oe[1],B(ye)}));return f(f({},U),G)}function ne(I){var D=I.$attrs,w=I.callBackBuilder,G=H(Me(D));Object.entries(w).forEach(function(q){var oe=b(q,2),ye=oe[0],Ve=oe[1];ve[ye].forEach(function(ee){G["on".concat(ee)]=Ve(ee)})});var U="[data-draggable]".concat(G.draggable||"");return f(f({},G),{},{draggable:U})}function Me(I){return Object.entries(I).filter(function(D){var w=b(D,2),G=w[0];return w[1],!B(G)}).map(function(D){var w=b(D,2),G=w[0],U=w[1];return[L(G),U]}).filter(function(D){var w=b(D,2),G=w[0];return w[1],!Ue(G)})}r("c740");function Pe(I,D){if(!(I instanceof D))throw new TypeError("Cannot call a class as a function")}function ft(I,D){for(var w=0;w<D.length;w++){var G=D[w];G.enumerable=G.enumerable||!1,G.configurable=!0,"value"in G&&(G.writable=!0),Object.defineProperty(I,G.key,G)}}function xe(I,D,w){return D&&ft(I.prototype,D),I}var Je=function(D){var w=D.el;return w},Ye=function(D,w){return D.__draggable_context=w},$e=function(D){return D.__draggable_context},fn=function(){function I(D){var w=D.nodes,G=w.header,U=w.default,q=w.footer,oe=D.root,ye=D.realList;Pe(this,I),this.defaultNodes=U,this.children=[].concat(T(G),T(U),T(q)),this.externalComponent=oe.externalComponent,this.rootTransition=oe.transition,this.tag=oe.tag,this.realList=ye}return xe(I,[{key:"render",value:function(w,G){var U=this.tag,q=this.children,oe=this._isRootComponent,ye=oe?{default:function(){return q}}:q;return w(U,G,ye)}},{key:"updated",value:function(){var w=this.defaultNodes,G=this.realList;w.forEach(function(U,q){Ye(Je(U),{element:G[q],index:q})})}},{key:"getUnderlyingVm",value:function(w){return $e(w)}},{key:"getVmIndexFromDomIndex",value:function(w,G){var U=this.defaultNodes,q=U.length,oe=G.children,ye=oe.item(w);if(ye===null)return q;var Ve=$e(ye);if(Ve)return Ve.index;if(q===0)return 0;var ee=Je(U[0]),X=T(oe).findIndex(function(z){return z===ee});return w<X?0:q}},{key:"_isRootComponent",get:function(){return this.externalComponent||this.rootTransition}}]),I}(),Mt=r("8bbf");function kt(I,D){var w=I[D];return w?w():[]}function ui(I){var D=I.$slots,w=I.realList,G=I.getKey,U=w||[],q=["header","footer"].map(function(z){return kt(D,z)}),oe=b(q,2),ye=oe[0],Ve=oe[1],ee=D.item;if(!ee)throw new Error("draggable element must have an item slot");var X=U.flatMap(function(z,pe){return ee({element:z,index:pe}).map(function(ge){return ge.key=G(z),ge.props=f(f({},ge.props||{}),{},{"data-draggable":!0}),ge})});if(X.length!==U.length)throw new Error("Item slot must have only one child");return{header:ye,footer:Ve,default:X}}function mo(I){var D=Ae(I),w=!Se(I)&&!D;return{transition:D,externalComponent:w,tag:w?Object(Mt.resolveComponent)(I):D?Mt.TransitionGroup:I}}function Ct(I){var D=I.$slots,w=I.tag,G=I.realList,U=I.getKey,q=ui({$slots:D,realList:G,getKey:U}),oe=mo(w);return new fn({nodes:q,root:oe,realList:G})}function zt(I,D){var w=this;Object(Mt.nextTick)(function(){return w.$emit(I.toLowerCase(),D)})}function Fn(I){var D=this;return function(w,G){if(D.realList!==null)return D["onDrag".concat(I)](w,G)}}function pr(I){var D=this,w=Fn.call(this,I);return function(G,U){w.call(D,G,U),zt.call(D,I,G)}}var gr=null,yr={list:{type:Array,required:!1,default:null},modelValue:{type:Array,required:!1,default:null},itemKey:{type:[String,Function],required:!0},clone:{type:Function,default:function(D){return D}},tag:{type:String,default:"div"},move:{type:Function,default:null},componentData:{type:Object,required:!1,default:null}},mr=["update:modelValue","change"].concat(T([].concat(T(ve.manageAndEmit),T(ve.emit)).map(function(I){return I.toLowerCase()}))),Er=Object(Mt.defineComponent)({name:"draggable",inheritAttrs:!1,props:yr,emits:mr,data:function(){return{error:!1}},render:function(){try{this.error=!1;var D=this.$slots,w=this.$attrs,G=this.tag,U=this.componentData,q=this.realList,oe=this.getKey,ye=Ct({$slots:D,tag:G,realList:q,getKey:oe});this.componentStructure=ye;var Ve=Q({$attrs:w,componentData:U});return ye.render(Mt.h,Ve)}catch(ee){return this.error=!0,Object(Mt.h)("pre",{style:{color:"red"}},ee.stack)}},created:function(){this.list!==null&&this.modelValue!==null&&R.a.error("modelValue and list props are mutually exclusive! Please set one or another.")},mounted:function(){var D=this;if(!this.error){var w=this.$attrs,G=this.$el,U=this.componentStructure;U.updated();var q=ne({$attrs:w,callBackBuilder:{manageAndEmit:function(Ve){return pr.call(D,Ve)},emit:function(Ve){return zt.bind(D,Ve)},manage:function(Ve){return Fn.call(D,Ve)}}}),oe=G.nodeType===1?G:G.parentElement;this._sortable=new P.a(oe,q),this.targetDomElement=oe,oe.__draggable_component__=this}},updated:function(){this.componentStructure.updated()},beforeUnmount:function(){this._sortable!==void 0&&this._sortable.destroy()},computed:{realList:function(){var D=this.list;return D||this.modelValue},getKey:function(){var D=this.itemKey;return typeof D=="function"?D:function(w){return w[D]}}},watch:{$attrs:{handler:function(D){var w=this._sortable;w&&Me(D).forEach(function(G){var U=b(G,2),q=U[0],oe=U[1];w.option(q,oe)})},deep:!0}},methods:{getUnderlyingVm:function(D){return this.componentStructure.getUnderlyingVm(D)||null},getUnderlyingPotencialDraggableComponent:function(D){return D.__draggable_component__},emitChanges:function(D){var w=this;Object(Mt.nextTick)(function(){return w.$emit("change",D)})},alterList:function(D){if(this.list){D(this.list);return}var w=T(this.modelValue);D(w),this.$emit("update:modelValue",w)},spliceList:function(){var D=arguments,w=function(U){return U.splice.apply(U,T(D))};this.alterList(w)},updatePosition:function(D,w){var G=function(q){return q.splice(w,0,q.splice(D,1)[0])};this.alterList(G)},getRelatedContextFromMoveEvent:function(D){var w=D.to,G=D.related,U=this.getUnderlyingPotencialDraggableComponent(w);if(!U)return{component:U};var q=U.realList,oe={list:q,component:U};if(w!==G&&q){var ye=U.getUnderlyingVm(G)||{};return f(f({},ye),oe)}return oe},getVmIndexFromDomIndex:function(D){return this.componentStructure.getVmIndexFromDomIndex(D,this.targetDomElement)},onDragStart:function(D){this.context=this.getUnderlyingVm(D.item),D.item._underlying_vm_=this.clone(this.context.element),gr=D.item},onDragAdd:function(D){var w=D.item._underlying_vm_;if(w!==void 0){A(D.item);var G=this.getVmIndexFromDomIndex(D.newIndex);this.spliceList(G,0,w);var U={element:w,newIndex:G};this.emitChanges({added:U})}},onDragRemove:function(D){if(_(this.$el,D.item,D.oldIndex),D.pullMode==="clone"){A(D.clone);return}var w=this.context,G=w.index,U=w.element;this.spliceList(G,1);var q={element:U,oldIndex:G};this.emitChanges({removed:q})},onDragUpdate:function(D){A(D.item),_(D.from,D.item,D.oldIndex);var w=this.context.index,G=this.getVmIndexFromDomIndex(D.newIndex);this.updatePosition(w,G);var U={element:this.context.element,oldIndex:w,newIndex:G};this.emitChanges({moved:U})},computeFutureIndex:function(D,w){if(!D.element)return 0;var G=T(w.to.children).filter(function(ye){return ye.style.display!=="none"}),U=G.indexOf(w.related),q=D.component.getVmIndexFromDomIndex(U),oe=G.indexOf(gr)!==-1;return oe||!w.willInsertAfter?q:q+1},onDragMove:function(D,w){var G=this.move,U=this.realList;if(!G||!U)return!0;var q=this.getRelatedContextFromMoveEvent(D),oe=this.computeFutureIndex(q,D),ye=f(f({},this.context),{},{futureIndex:oe}),Ve=f(f({},D),{},{relatedContext:q,draggedContext:ye});return G(Ve,w)},onDragEnd:function(){gr=null}}}),br=Er;t.default=br},fb6a:function(e,t,r){var s=r("23e7"),l=r("861d"),u=r("e8b5"),c=r("23cb"),d=r("50c4"),f=r("fc6a"),v=r("8418"),p=r("b622"),y=r("1dde"),g=r("ae40"),E=y("slice"),b=g("slice",{ACCESSORS:!0,0:0,1:2}),S=p("species"),C=[].slice,x=Math.max;s({target:"Array",proto:!0,forced:!E||!b},{slice:function(O,P){var A=f(this),_=d(A.length),R=c(O,_),M=c(P===void 0?_:P,_),F,L,k;if(u(A)&&(F=A.constructor,typeof F=="function"&&(F===Array||u(F.prototype))?F=void 0:l(F)&&(F=F[S],F===null&&(F=void 0)),F===Array||F===void 0))return C.call(A,R,M);for(L=new(F===void 0?Array:F)(x(M-R,0)),k=0;R<M;R++,k++)R in A&&v(L,k,A[R]);return L.length=k,L}})},fc6a:function(e,t,r){var s=r("44ad"),l=r("1d80");e.exports=function(u){return s(l(u))}},fdbc:function(e,t){e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},fdbf:function(e,t,r){var s=r("4930");e.exports=s&&!Symbol.sham&&typeof Symbol.iterator=="symbol"}}).default})})(Dl);var vd=Dl.exports;const pd=Ju(vd);function nr(o){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?nr=function(a){return typeof a}:nr=function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},nr(o)}function $(o,a){if(!(o instanceof a))throw new TypeError("Cannot call a class as a function")}function fs(o,a){for(var n=0;n<a.length;n++){var i=a[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(o,i.key,i)}}function J(o,a,n){return a&&fs(o.prototype,a),n&&fs(o,n),o}function h(o,a,n){return a in o?Object.defineProperty(o,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):o[a]=n,o}function Ee(o,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function");o.prototype=Object.create(a&&a.prototype,{constructor:{value:o,writable:!0,configurable:!0}}),a&&Wo(o,a)}function _e(o){return _e=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},_e(o)}function Wo(o,a){return Wo=Object.setPrototypeOf||function(i,e){return i.__proto__=e,i},Wo(o,a)}function gd(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function m(o){if(o===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o}function yd(o,a){return a&&(typeof a=="object"||typeof a=="function")?a:m(o)}function be(o){var a=gd();return function(){var i=_e(o),e;if(a){var t=_e(this).constructor;e=Reflect.construct(i,arguments,t)}else e=i.apply(this,arguments);return yd(this,e)}}function md(o,a){for(;!Object.prototype.hasOwnProperty.call(o,a)&&(o=_e(o),o!==null););return o}function Ge(o,a,n){return typeof Reflect<"u"&&Reflect.get?Ge=Reflect.get:Ge=function(e,t,r){var s=md(e,t);if(s){var l=Object.getOwnPropertyDescriptor(s,t);return l.get?l.get.call(r):l.value}},Ge(o,a,n||o)}function Ri(o,a){return bd(o)||Cd(o,a)||Bl(o,a)||Pd()}function ar(o){return Ed(o)||Sd(o)||Bl(o)||xd()}function Ed(o){if(Array.isArray(o))return Ko(o)}function bd(o){if(Array.isArray(o))return o}function Sd(o){if(typeof Symbol<"u"&&o[Symbol.iterator]!=null||o["@@iterator"]!=null)return Array.from(o)}function Cd(o,a){var n=o==null?null:typeof Symbol<"u"&&o[Symbol.iterator]||o["@@iterator"];if(n!=null){var i=[],e=!0,t=!1,r,s;try{for(n=n.call(o);!(e=(r=n.next()).done)&&(i.push(r.value),!(a&&i.length===a));e=!0);}catch(l){t=!0,s=l}finally{try{!e&&n.return!=null&&n.return()}finally{if(t)throw s}}return i}}function Bl(o,a){if(o){if(typeof o=="string")return Ko(o,a);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor&&(n=o.constructor.name),n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ko(o,a)}}function Ko(o,a){(a==null||a>o.length)&&(a=o.length);for(var n=0,i=new Array(a);n<a;n++)i[n]=o[n];return i}function xd(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Pd(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pn(o,a,n){return o==="*"?!0:o.length>0?o.indexOf(a)!==-1:!n}function W(o,a,n){var i;o=o||{},a=a||{};var e=o,t=a;for(i in t)e[i]=t[i];return o}function zo(o){return Object.prototype.toString.call(o)==="[object Number]"}function Be(o){return typeof o=="string"}function Ul(o){return typeof o=="boolean"}function sr(o){return o==null?!1:Object.prototype.toString.call(o)==="[object Object]"}function Td(o){return Object.prototype.toString.call(o)==="[object Date]"}function In(o){return Object.prototype.toString.call(o)==="[object Function]"}function Ki(o){if(Be(o))return""+o;if(Ul(o))return!!o;if(Td(o))return new Date(o.getTime());if(In(o))return o;if(Array.isArray(o)){for(var a=[],n=0;n<o.length;n++)a.push(Ki(o[n]));return a}else if(sr(o)){var i={};for(var e in o)i[e]=Ki(o[e]);return i}else return o}function zi(o,a,n,i){var e={},t,r,s={};for(n=n||[],i=i||[],r=0;r<n.length;r++)e[n[r]]=!0;for(r=0;r<i.length;r++)s[i[r]]=!0;var l=Ki(o);for(r in a)if(l[r]==null||s[r])l[r]=a[r];else if(e[r])t=[],t.push.apply(t,Array.isArray(l[r])?l[r]:[l[r]]),t.push(a[r]),l[r]=t;else if(Be(a[r])||Ul(a[r])||In(a[r])||zo(a[r]))l[r]=a[r];else if(Array.isArray(a[r]))t=[],Array.isArray(l[r])&&t.push.apply(t,l[r]),t.push.apply(t,a[r]),l[r]=t;else if(sr(a[r])){sr(l[r])||(l[r]={});for(var u in a[r])l[r][u]=a[r][u]}return l}function Vl(o,a,n){for(var i=0;i<n.length;i++){var e=n[i][0][n[i][1]].apply(n[i][0],n[i][2]);if(e===a)return e}return o}function Od(o,a,n,i){var e=function(s){var l=s.match(/(\${.*?})/g);if(l!=null)for(var u=0;u<l.length;u++){var c=a[l[u].substring(2,l[u].length-1)]||"";c!=null&&(s=s.replace(l[u],c))}if(l=s.match(/({{.*?}})/g),l!=null)for(var d=0;d<l.length;d++){var f=a[l[d].substring(2,l[d].length-2)]||"";f!=null&&(s=s.replace(l[d],f))}return s},t=function r(s){if(s!=null){if(Be(s))return e(s);if(In(s)&&!i&&(s.name||"").indexOf(n)===0)return s(a);if(Array.isArray(s)){for(var l=[],u=0;u<s.length;u++)l.push(r(s[u]));return l}else if(sr(s)){var c={};for(var d in s)c[d]=r(s[d]);return c}else return s}};return t(o)}function K(o,a){if(o)for(var n=0;n<o.length;n++)a(o[n]);else return null}function un(o,a){if(o){for(var n=0;n<o.length;n++)if(a(o[n]))return n}return-1}function Ad(o,a){var n=[];if(o)for(var i=0;i<o.length;i++)a(o[i])&&n.push(i);return n}function Ta(o,a){var n=un(o,a);return n===-1?null:o[n]}function Dd(o,a){var n=Ad(o,a);return n.map(function(i){return o[i]})}function Hl(o,a){var n=null;return o.forEach(function(i){a(i)&&(n=i)}),n}function Id(o){var a=[];return o.forEach(function(n){a.push(n)}),a}function Ze(o,a){var n=un(o,a);return n>-1&&o.splice(n,1),n!==-1}function Ei(o){if(Array.fromArray!=null)return Array.from(o);var a=[];return Array.prototype.push.apply(a,o),a}function hs(o,a){var n=o.indexOf(a);return n>-1&&o.splice(n,1),n!==-1}function Yl(o,a,n,i){var e=o[a];return e==null&&(e=[],o[a]=e),e[i?"unshift":"push"](n),e}function Pr(o,a,n){return o.indexOf(a)===-1?(o.push(a),!0):!1}var Qe=[];for(var Tr=0;Tr<256;Tr++)Qe[Tr]=(Tr<16?"0":"")+Tr.toString(16);function Ke(){var o=Math.random()*4294967295|0,a=Math.random()*4294967295|0,n=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return Qe[o&255]+Qe[o>>8&255]+Qe[o>>16&255]+Qe[o>>24&255]+"-"+Qe[a&255]+Qe[a>>8&255]+"-"+Qe[a>>16&15|64]+Qe[a>>24&255]+"-"+Qe[n&63|128]+Qe[n>>8&255]+"-"+Qe[n>>16&255]+Qe[n>>24&255]+Qe[i&255]+Qe[i>>8&255]+Qe[i>>16&255]+Qe[i>>24&255]}function Zi(o,a,n){var i={x:o.x-a.x,y:o.y-a.y},e=Math.cos(n/360*Math.PI*2),t=Math.sin(n/360*Math.PI*2);return{x:i.x*e-i.y*t+a.x,y:i.y*e+i.x*t+a.y,cr:e,sr:t}}function Oa(o){if(o==null)return null;for(var a=o.replace(/^\s\s*/,""),n=/\s/,i=a.length;n.test(a.charAt(--i)););return a.slice(0,i+1)}function _d(o,a){o=o.length==null||typeof o=="string"?[o]:o;for(var n=0;n<o.length;n++)a(o[n])}function Xl(o,a){for(var n=[],i=0;i<o.length;i++)n.push(a(o[i]));return n}function We(){for(var o=arguments.length,a=new Array(o),n=0;n<o;n++)a[n]=arguments[n];if(typeof console<"u")try{var i=arguments[arguments.length-1];console.log(i)}catch{}}function Ji(o){return o<0?-1:o>0?1:0}function bi(o,a,n){return function(){var i=null;try{a!=null&&(i=a.apply(this,arguments))}catch(e){We("jsPlumb function failed : "+e)}if(o!=null&&(n==null||i!==n))try{i=o.apply(this,arguments)}catch(e){We("wrapped function failed : "+e)}return i}}function vs(o,a,n){return o.has(a)||o.set(a,n()),o.get(a)}function $l(o,a){for(var n=o.__proto__;n!=null;){if(n instanceof a)return!0;n=n.__proto__}return!1}function wd(o,a,n,i){if(a.length===0)a.push(o);else{for(var e=i?-1:1,t=0,r=a.length,s=Math.floor((t+r)/2);r>t;){var l=n(o,a[s])*e;l<0?r=s:t=s+1,s=Math.floor((t+r)/2)}a.splice(s,0,o)}}function _n(o,a,n){n=n||o.parentNode;for(var i=n.querySelectorAll(a),e=0;e<i.length;e++)if(i[e]===o)return!0;return!1}function Jr(o,a){o.stopPropagation?o.stopPropagation():o.returnValue=!1,!a&&o.preventDefault&&o.preventDefault()}function Vt(o,a,n,i){if(i&&_n(o,a,n))return o;for(o=o.parentNode;o!=null&&o!==n;){if(_n(o,a))return o;o=o.parentNode}}function ht(o){return o.srcElement||o.target}function Md(o,a,n){a=Oa(a),typeof o.className.baseVal<"u"?o.className.baseVal=a:o.className=a;try{var i=o.classList;if(i!=null){for(;i.length>0;)i.remove(i.item(0));for(var e=0;e<n.length;e++)n[e]&&i.add(n[e])}}catch(t){We("WARN: cannot set class list",t)}}function Aa(o){return o.className!=null?typeof o.className.baseVal>"u"?o.className:o.className.baseVal:""}function Wl(o,a,n){var i=a==null?[]:Array.isArray(a)?a:a.split(/\s+/),e=n==null?[]:Array.isArray(n)?n:n.split(/\s+/),t=Aa(o),r=t.split(/\s+/),s=function(u,c){for(var d=0;d<c.length;d++)if(u)r.indexOf(c[d])===-1&&r.push(c[d]);else{var f=r.indexOf(c[d]);f!==-1&&r.splice(f,1)}};s(!0,i),s(!1,e),Md(o,r.join(" "),r)}function Qr(o){return!Be(o)&&!Array.isArray(o)&&o.length!=null&&o.documentElement==null&&o.nodeType==null}function kd(o){return Aa(o)}function Sn(o,a){var n=function(e,t){if(e!=null&&t!=null&&t.length>0)if(e.classList){var r=Oa(t).split(/\s+/);K(r,function(s){e.classList.add(s)})}else Wl(e,t)};Qr(o)?K(o,function(i){return n(i,a)}):n(o,a)}function Ld(o,a){return o.classList?o.classList.contains(a):Aa(o).indexOf(a)!==-1}function Zo(o,a){var n=function(e,t){if(e!=null&&t!=null&&t.length>0)if(e.classList){var r=Oa(t).split(/\s+/);r.forEach(function(s){e.classList.remove(s)})}else Wl(e,null,t)};Qr(o)?K(o,function(i){return n(i,a)}):n(o,a)}function Nd(o,a){var n=this,i=function(t,r){t!=null&&r!=null&&r.length>0&&(t.classList?t.classList.toggle(r):n.hasClass(t,r)?n.removeClass(t,r):n.addClass(t,r))};Qr(o)?K(o,function(e){return i(e,a)}):i(o,a)}function Kl(o,a,n,i){return zl(null,o,a,n,i)}function zl(o,a,n,i,e){var t=o==null?document.createElement(a):document.createElementNS(o,a),r;n=n||{};for(r in n)t.style[r]=n[r];i&&(t.className=i),e=e||{};for(r in e)t.setAttribute(r,""+e[r]);return t}function Qn(o){var a=o.getBoundingClientRect(),n=document.body,i=document.documentElement,e=window.pageYOffset||i.scrollTop||n.scrollTop,t=window.pageXOffset||i.scrollLeft||n.scrollLeft,r=i.clientTop||n.clientTop||0,s=i.clientLeft||n.clientLeft||0,l=a.top+e-r,u=a.left+t-s;return{x:Math.round(u),y:Math.round(l)}}function Rd(o){return{w:o.offsetWidth,h:o.offsetHeight}}function Fd(o){try{return{w:parseFloat(o.width.baseVal.value),h:parseFloat(o.height.baseVal.value)}}catch{return{w:0,h:0}}}function Gd(o){try{return{x:parseFloat(o.x.baseVal.value),y:parseFloat(o.y.baseVal.value)}}catch{return{x:0,y:0}}}function Si(o,a){var n=a.getContainer().getBoundingClientRect(),i=o.getBoundingClientRect(),e=a.currentZoom;return{x:(i.left-n.left)/e,y:(i.top-n.top)/e}}function Or(o,a){var n=o.getBoundingClientRect(),i=a.currentZoom;return{w:n.width/i,h:n.height/i}}var wn;(function(o){o.SVG="SVG",o.HTML="HTML"})(wn||(wn={}));function Jo(o){return o instanceof SVGElement?wn.SVG:wn.HTML}function jd(o){return Jo(o)===wn.SVG}function Mn(){for(var o=arguments.length,a=new Array(o),n=0;n<o;n++)a[n]=arguments[n];return a.map(function(i){return"."+i}).join(",")}function Bd(){for(var o=arguments.length,a=new Array(o),n=0;n<o;n++)a[n]=arguments[n];return a.join(" ")}function vo(){for(var o=arguments.length,a=new Array(o),n=0;n<o;n++)a[n]=arguments[n];return a.map(function(i){return"["+i+"]"}).join(",")}var Qo="source",Zl="target",qo="block",lr="none",qr="absolute",ps="fixed",Ud="static",Jl="data-jtk-group",rn="data-jtk-managed",Fi="data-jtk-not-draggable",gs="tabindex",Vd="data-jtk-scope",Ql=Vd+"-",ql="checkCondition",Hd="checkDropAllowed",Da="jtk-connector",Yd="jtk-connector-outline",Xd="jtk-connected",rr="jtk-endpoint",$d="jtk-endpoint-connected",Wd="jtk-endpoint-full",Ia="jtk-floating-endpoint",Kd="jtk-endpoint-drop-allowed",zd="jtk-endpoint-drop-forbidden",Zd="jtk-endpoint-anchor",Ci="jtk-group-collapsed",Ar="jtk-group-expanded",po="jtk-overlay",Jd="anchor:changed",_a="connection",eu="internal.connection",tu="connection:detach",wa="connection:move",Qd="container:change",qd="endpoint:replaced",nu="internal.endpoint:unregistered",Ma="internal.connection:detached",ru="element:manage",ef="group:added",tf="group:collapse",nf="group:expand",rf="group:member:added",of="group:member:removed",af="group:removed",iu="maxConnections",sf="group:nested:added",lf="group:nested:removed",ou="element:unmanage",au="zoom",ir="isDetachAllowed",uf="beforeDrag",su="beforeDrop",lu="beforeDetach",cf="beforeStartDetach",Ie=vo(rn),df="Cannot establish connection: source endpoint is full",ff="Cannot establish connection: target endpoint is full",hf="Cannot establish connection: source does not exist",vf="Cannot establish connection: target does not exist",pf="connectionOverlays",ys={"stroke-linejoin":"stroke-linejoin","stroke-dashoffset":"stroke-dashoffset","stroke-linecap":"stroke-linecap"},Dr="stroke-dasharray",Mo="dashstyle",gf="fill",yf="stroke",mf="stroke-width",Ef="strokeWidth",uu="svg",ea="path",ms={svg:"http://www.w3.org/2000/svg"};function $t(o,a){for(var n in a)o.setAttribute(n,""+a[n])}function Wt(o,a){return a=a||{},a.version="1.1",a.xmlns=ms.svg,zl(ms.svg,o,null,null,a)}function cu(o){return"position:absolute;left:"+o[0]+"px;top:"+o[1]+"px"}function ta(o,a,n){if(a.setAttribute(gf,n.fill?n.fill:lr),a.setAttribute(yf,n.stroke?n.stroke:lr),n.strokeWidth&&a.setAttribute(mf,n.strokeWidth),n[Mo]&&n[Ef]&&!n[Dr]){var i=n[Mo].indexOf(",")===-1?" ":",",e=n[Mo].split(i),t="";K(e,function(s){t+=Math.floor(s*n.strokeWidth)+i}),a.setAttribute(Dr,t)}else n[Dr]&&a.setAttribute(Dr,n[Dr]);for(var r in ys)n[r]&&a.setAttribute(ys[r],n[r])}function Gi(o,a,n){o.childNodes.length>n?o.insertBefore(a,o.childNodes[n]):o.appendChild(a)}function Oe(o,a,n){var i=[o,a];return i.join(":")}var Es="data-jtk-container",bf="data-jtk-group-content",xi="data-jtk-enabled",ko="data-jtk-scope",Rn="endpoint",jt="element",Bt="connection",du="div",at="click",Ht="contextmenu",gt="dblclick",It="dbltap",Sf="focus",de="mousedown",ka="mouseenter",La="mouseexit",ze="mousemove",fe="mouseup",Et="mouseout",bt="mouseover",_t="tap",Cf="touchstart",xf="touchend",Pf="touchmove",Tf="drag:move",Of="drag:stop",Af="drag:start",Qi="revert",Df="connection:abort",bs="connection:drag",Ss=Oe(jt,at),If=Oe(jt,gt),Cs=Oe(jt,It),_f=Oe(jt,Et),wf=Oe(jt,bt),Mf=Oe(jt,ze),kf=Oe(jt,fe),Lf=Oe(jt,de),Nf=Oe(jt,Ht),xs=Oe(jt,_t),Rf=Oe(Rn,at),Ff=Oe(Rn,gt),Gf=Oe(Rn,Et),jf=Oe(Rn,bt),Bf=Oe(Rn,fe),Uf=Oe(Rn,de),Vf=Oe(Bt,at),Hf=Oe(Bt,gt),Yf=Oe(Bt,It),Xf=Oe(Bt,Et),$f=Oe(Bt,bt),Wf=Oe(Bt,fe),Kf=Oe(Bt,de),zf=Oe(Bt,Ht),Zf=Oe(Bt,_t),Ps="position",Tt=Mn(Da),gn=Mn(rr),Jf=vo(Jl),Qf=vo(bf),Ut=Mn(po),cn;(function(o){o.Circle="Circle",o.Ellipse="Ellipse",o.Triangle="Triangle",o.Diamond="Diamond",o.Rectangle="Rectangle",o.Square="Square"})(cn||(cn={}));var Gt;(function(o){o.Assign="Assign",o.AutoDefault="AutoDefault",o.Bottom="Bottom",o.BottomLeft="BottomLeft",o.BottomRight="BottomRight",o.Center="Center",o.Continuous="Continuous",o.ContinuousBottom="ContinuousBottom",o.ContinuousLeft="ContinuousLeft",o.ContinuousRight="ContinuousRight",o.ContinuousTop="ContinuousTop",o.ContinuousLeftRight="ContinuousLeftRight",o.ContinuousTopBottom="ContinuousTopBottom",o.Left="Left",o.Perimeter="Perimeter",o.Right="Right",o.Top="Top",o.TopLeft="TopLeft",o.TopRight="TopRight"})(Gt||(Gt={}));function qf(){return{d:1/0,x:null,y:null,l:null,x1:null,y1:null,x2:null,y2:null}}function qi(){return{xmin:1/0,xmax:-1/0,ymin:1/0,ymax:-1/0}}var Na=function(){function o(a){$(this,o),this.params=a,h(this,"x1",void 0),h(this,"x2",void 0),h(this,"y1",void 0),h(this,"y2",void 0),h(this,"extents",qi()),h(this,"type",void 0),this.x1=a.x1,this.y1=a.y1,this.x2=a.x2,this.y2=a.y2}return J(o,[{key:"findClosestPointOnPath",value:function(n,i){return qf()}},{key:"lineIntersection",value:function(n,i,e,t){return[]}},{key:"boxIntersection",value:function(n,i,e,t){var r=[];return r.push.apply(r,this.lineIntersection(n,i,n+e,i)),r.push.apply(r,this.lineIntersection(n+e,i,n+e,i+t)),r.push.apply(r,this.lineIntersection(n+e,i+t,n,i+t)),r.push.apply(r,this.lineIntersection(n,i+t,n,i)),r}},{key:"boundingBoxIntersection",value:function(n){return this.boxIntersection(n.x,n.y,n.w,n.h)}}]),o}(),fu="undefined",eo="default",hu="true",er="false",Tn="*",Ir,_r;function eh(o,a,n,i,e,t,r){return new Touch({target:o,identifier:Ke(),pageX:a,pageY:n,screenX:i,screenY:e,clientX:t||i,clientY:r||e})}function th(){var o=[];return o.push.apply(o,arguments),o.item=function(a){return this[a]},o}function nh(o,a,n,i,e,t,r){return th(eh(o,a,n,i,e,t,r))}function ur(o,a,n){n=n||o.parentNode;for(var i=n.querySelectorAll(a),e=0;e<i.length;e++)if(i[e]===o)return!0;return!1}function ei(o){return o.srcElement||o.target}function na(o,a,n,i){if(i){var e=o.composedPath?o.composedPath():o.path;if(typeof e<"u"&&e.indexOf)return{path:e,end:e.indexOf(n)};var t={path:[],end:-1},r=function s(l){t.path.push(l),l===n?t.end=t.path.length-1:l.parentNode!=null&&s(l.parentNode)};return r(a),t}else return{path:[a],end:1}}function rh(o,a){var n=0,i;for(n=0,i=o.length;n<i&&o[n][0]!==a;n++);n<o.length&&o.splice(n,1)}var ih=1;function Wr(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints!=null&&navigator.maxTouchPoints>0}function ji(){return"onmousedown"in document.documentElement}var Yt=(Ir={},h(Ir,de,Cf),h(Ir,fe,xf),h(Ir,ze,Pf),Ir),oh="page",ah="screen",sh="client";function Ra(o,a){if(o==null)return{x:0,y:0};var n=vu(o),i=ch(n,0);return{x:i[a+"X"],y:i[a+"Y"]}}function to(o){return Ra(o,oh)}function lh(o){return Ra(o,ah)}function uh(o){return Ra(o,sh)}function ch(o,a){return o.item?o.item(a):o[a]}function vu(o){return o.touches&&o.touches.length>0?o.touches:o.changedTouches&&o.changedTouches.length>0?o.changedTouches:o.targetTouches&&o.targetTouches.length>0?o.targetTouches:[o]}function dh(o){return vu(o).length}function no(o,a,n,i,e){if(gu(o,a,n),i.__tauid=n.__tauid,o.addEventListener)o.addEventListener(a,n,!1,e);else if(o.attachEvent){var t=a+n.__tauid;o["e"+t]=n,o[t]=function(){o["e"+t]&&o["e"+t](window.event)},o.attachEvent("on"+a,o[t])}}function ti(o,a,n){var i=this;n!=null&&pu(o,function(e){if(fh(e,a,n),n.__tauid!=null){if(e.removeEventListener)e.removeEventListener(a,n,!1),Wr()&&Yt[a]&&e.removeEventListener(Yt[a],n,!1);else if(i.detachEvent){var t=a+n.__tauid;e[t]&&e.detachEvent("on"+a,e[t]),e[t]=null,e["e"+t]=null}}n.__taTouchProxy&&ti(o,n.__taTouchProxy[1],n.__taTouchProxy[0])})}function pu(o,a){if(o!=null)for(var n=typeof o=="string"?document.querySelectorAll(o):o.length!=null?o:[o],i=0;i<n.length;i++)a(n[i])}function gu(o,a,n){var i=ih++;return o.__ta=o.__ta||{},o.__ta[a]=o.__ta[a]||{},o.__ta[a][i]=n,n.__tauid=i,i}function fh(o,a,n){if(o.__ta&&o.__ta[a]&&delete o.__ta[a][n.__tauid],n.__taExtra){for(var i=0;i<n.__taExtra.length;i++)ti(o,n.__taExtra[i][0],n.__taExtra[i][1]);n.__taExtra.length=0}n.__taUnstore&&n.__taUnstore()}var hh=/:not\(([^)]+)\)/;function ro(o,a,n,i){if(o==null)return n;var e=o.split(","),t=[],r=[];K(e,function(l){var u=l.match(hh);u!=null?r.push(u[1]):t.push(l)}),r.length>0&&t.length===0&&t.push(Tn);var s=function l(u){l.__tauid=n.__tauid;var c=ei(u),d=!1,f=c,v=na(u,c,a,o!=null);if(v.end!=-1)for(var p=0;!d&&p<v.end;p++){f=v.path[p];for(var y=0;y<r.length;y++)if(ur(f,r[y],a))return;for(var g=0;!d&&g<t.length;g++)if(ur(f,t[g],a)){n.apply(f,[u,f]),d=!0;break}}};return vh(n,i,s),s}function vh(o,a,n){o.__taExtra=o.__taExtra||[],o.__taExtra.push([a,n])}var Bi=function(a,n,i,e,t){if(Wr()&&Yt[n]){var r=ro(e,a,i,Yt[n]);no(a,Yt[n],r,i,t)}n===Sf&&a.getAttribute(gs)==null&&a.setAttribute(gs,"1"),no(a,n,ro(e,a,i,n),i,t)},Lo=(_r={},h(_r,_t,{touches:1,taps:1}),h(_r,It,{touches:1,taps:2}),h(_r,Ht,{touches:2,taps:1}),_r);function Ts(o,a,n,i){for(var e in n.__tamee[o])n.__tamee[o].hasOwnProperty(e)&&n.__tamee[o][e].apply(i,[a])}var ph=function(){function o(){$(this,o)}return J(o,null,[{key:"generate",value:function(n,i){return function(e,t,r,s){if(t==Ht&&ji())Bi(e,t,r,s);else{if(e.__taTapHandler==null){var l=e.__taTapHandler={tap:[],dbltap:[],down:!1,taps:0,downSelectors:[]},u=function(p){for(var y=ei(p),g=na(p,y,e,s!=null),E=!1,b=0;b<g.end;b++){if(E)return;y=g.path[b];for(var S=0;S<l.downSelectors.length;S++)if(l.downSelectors[S]==null||ur(y,l.downSelectors[S],e)){l.down=!0,setTimeout(d,n),setTimeout(f,i),E=!0;break}}},c=function(p){if(l.down){var y=ei(p),g,E;l.taps++;var b=dh(p);for(var S in Lo)if(Lo.hasOwnProperty(S)){var C=Lo[S];if(C.touches===b&&(C.taps===1||C.taps===l.taps))for(var x=0;x<l[S].length;x++){E=na(p,y,e,l[S][x][1]!=null);for(var T=0;T<E.end;T++)if(g=E.path[T],l[S][x][1]==null||ur(g,l[S][x][1],e)){l[S][x][0].apply(g,[p,g]);break}}}}},d=function(){l.down=!1},f=function(){l.taps=0};e.__taTapHandler.downHandler=u,e.__taTapHandler.upHandler=c,Bi(e,de,u),Bi(e,fe,c)}e.__taTapHandler.downSelectors.push(s),e.__taTapHandler[t].push([r,s]),r.__taUnstore=function(){e.__taTapHandler!=null&&(Ze(e.__taTapHandler.downSelectors,function(v){return v===s}),rh(e.__taTapHandler[t],r),e.__taTapHandler.downSelectors.length===0&&(ti(e,de,e.__taTapHandler.downHandler),ti(e,fe,e.__taTapHandler.upHandler),delete e.__taTapHandler))}}}}}]),o}(),gh=function(){function o(){$(this,o)}return J(o,null,[{key:"generate",value:function(){var n=[];return function(i,e,t,r){if(!i.__tamee){i.__tamee={over:!1,mouseenter:[],mouseexit:[]};var s=function(c){var d=ei(c);(r==null&&d==i&&!i.__tamee.over||ur(d,r,i)&&(d.__tamee==null||!d.__tamee.over))&&(Ts(ka,c,i,d),d.__tamee=d.__tamee||{},d.__tamee.over=!0,n.push(d))},l=function(c){for(var d=ei(c),f=0;f<n.length;f++)d==n[f]&&!ur(c.relatedTarget||c.toElement,"*",d)&&(d.__tamee.over=!1,n.splice(f,1),Ts(La,c,i,d))};no(i,bt,ro(r,i,s,bt),s),no(i,Et,ro(r,i,l,Et),l)}t.__taUnstore=function(){delete i.__tamee[e][t.__tauid]},gu(i,e,t),i.__tamee[e][t.__tauid]=t}}}]),o}(),Fa=function(){function o(a){$(this,o),h(this,"clickThreshold",void 0),h(this,"dblClickThreshold",void 0),h(this,"tapHandler",void 0),h(this,"mouseEnterExitHandler",void 0),a=a||{},this.clickThreshold=a.clickThreshold||250,this.dblClickThreshold=a.dblClickThreshold||450,this.mouseEnterExitHandler=gh.generate(),this.tapHandler=ph.generate(this.clickThreshold,this.dblClickThreshold)}return J(o,[{key:"_doBind",value:function(n,i,e,t,r){if(e!=null){var s=n;i===_t||i===It||i===Ht?this.tapHandler(s,i,e,t,r):i===ka||i==La?this.mouseEnterExitHandler(s,i,e,t,r):Bi(s,i,e,t,r)}}},{key:"on",value:function(n,i,e,t,r){var s=t==null?null:e,l=t??e;return this._doBind(n,i,l,s,r),this}},{key:"off",value:function(n,i,e){return ti(n,i,e),this}},{key:"trigger",value:function(n,i,e,t,r){var s=ji()&&(typeof MouseEvent>"u"||e==null||e.constructor===MouseEvent),l=Wr()&&!ji()&&Yt[i]?Yt[i]:i,u=!(Wr()&&!ji()&&Yt[i]),c=to(e),d=lh(e),f=uh(e);return pu(n,function(v){var p;e=e||{screenX:d.x,screenY:d.y,clientX:f.x,clientY:f.y};var y=function(C){t&&(C.payload=t)},g={TouchEvent:function(C){var x=nh(v,c.x,c.y,d.x,d.y,f.x,f.y),T=C.initTouchEvent||C.initEvent;T(l,!0,!0,window,null,d.x,d.y,f.x,f.y,!1,!1,!1,!1,x,x,x,1,0)},MouseEvents:function(C){C.initMouseEvent(l,!0,!0,window,r??1,d.x,d.y,f.x,f.y,!1,!1,!1,!1,1,v)}},E=!u&&!s&&Wr()&&Yt[i],b=E?"TouchEvent":"MouseEvents";p=document.createEvent(b),g[b](p),y(p),v.dispatchEvent(p)}),this}}]),o}(),yh=[null,[1,-1],[1,1],[-1,1],[-1,-1]],mh=[null,[-1,-1],[-1,1],[1,1],[1,-1]],yn=2*Math.PI;function cr(o,a){return a.x===o.x?a.y>o.y?1/0:-1/0:a.y===o.y?a.x>o.x?0:-0:(a.y-o.y)/(a.x-o.x)}function Eh(o,a){return-1/cr(o,a)}function ra(o,a){return Math.sqrt(Math.pow(a.y-o.y,2)+Math.pow(a.x-o.x,2))}function Ga(o,a){return a.x>o.x||a.x==o.x?a.y>o.y?2:1:a.y>o.y?3:4}function bh(o,a){var n=cr(o,a),i=Math.atan(n),e=Ga(o,a);return(e==4||e==3)&&(i+=Math.PI),i<0&&(i+=2*Math.PI),i}function yu(o,a){var n=o.x,i=o.x+o.w,e=o.y,t=o.y+o.h,r=a.x,s=a.x+a.w,l=a.y,u=a.y+a.h;return n<=r&&r<=i&&e<=l&&l<=t||n<=s&&s<=i&&e<=l&&l<=t||n<=r&&r<=i&&e<=u&&u<=t||n<=s&&r<=i&&e<=u&&u<=t||r<=n&&n<=s&&l<=e&&e<=u||r<=i&&i<=s&&l<=e&&e<=u||r<=n&&n<=s&&l<=t&&t<=u||r<=i&&n<=s&&l<=t&&t<=u}function Cn(o,a,n){var i=cr(o,a),e=Ga(o,a),t=n>0?yh[e]:mh[e],r=Math.atan(i),s=Math.abs(n*Math.sin(r))*t[1],l=Math.abs(n*Math.cos(r))*t[0];return{x:o.x+l,y:o.y+s}}function Sh(o,a,n){var i=cr(o,a),e=Math.atan(-1/i),t=n/2*Math.sin(e),r=n/2*Math.cos(e);return[{x:a.x+r,y:a.y+t},{x:a.x-r,y:a.y-t}]}function Ch(o,a,n,i){n=n??(a.thresholdX==null?a.w/2:a.thresholdX),i=i??(a.thresholdY==null?a.h/2:a.thresholdY);var e=Math.floor(o.x/a.w),t=a.w*e,r=t+a.w,s=Math.abs(o.x-t)<=n?t:Math.abs(r-o.x)<=n?r:o.x,l=Math.floor(o.y/a.h),u=a.h*l,c=u+a.h,d=Math.abs(o.y-u)<=i?u:Math.abs(c-o.y)<=i?c:o.y;return{x:s,y:d}}function xh(o,a,n){if(_n(a,n,o))return a;for(var i=a.parentNode;i!=null&&i!==o;){if(_n(i,n,o))return i;i=i.parentNode}}function Ph(o){return typeof o=="function"?(o._katavorioId=Ke(),o._katavorioId):o}function Os(o,a,n){var i=a.parentNode,e=o.getSize(i),t=o.getSize(a),r=n.x,s=r+t.w,l=n.y,u=l+t.h;return s>0&&r<e.w&&u>0&&l<e.h}function Th(o,a,n){for(var i=null,e=a.getAttribute("katavorio-draggable"),t=e!=null?"[katavorio-draggable='"+e+"'] ":"",r=0;r<o.length;r++)if(i=xh(a,n,t+o[r].selector),i!=null){if(o[r].filter){var s=_n(n,o[r].filter,i),l=o[r].filterExclude===!0;if(l&&!s||s)return null}return[o[r],i]}return null}var mu="start",Eu="beforeStart",bu="drag",Oh="drop",Ah="over",Dh="out",Su="stop",Cu="katavorio-draggable",Ih=Cu,_h=10,wh=10,No=function(){return!0},Mh=function(){return!1},Fr={delegatedDraggable:"katavorio-delegated-draggable",draggable:Ih,drag:"katavorio-drag",selected:"katavorio-drag-selected",noSelect:"katavorio-drag-no-select",ghostProxy:"katavorio-ghost-proxy",clonedDrag:"katavorio-clone-drag"},wt;(function(o){o.absolutePosition="absolutePosition",o.transform="transform",o.xyAttributes="xyAttributes"})(wt||(wt={}));var ja=new Map;ja.set(wt.absolutePosition,function(o,a){o.style.left="".concat(a.x,"px"),o.style.top="".concat(a.y,"px")});ja.set(wt.xyAttributes,function(o,a){o.setAttribute("x","".concat(a.x)),o.setAttribute("y","".concat(a.y))});var Ba=new Map;Ba.set(wt.absolutePosition,function(o){return{x:o.offsetLeft,y:o.offsetTop}});Ba.set(wt.xyAttributes,function(o){return{x:parseFloat(o.getAttribute("x")),y:parseFloat(o.getAttribute("y"))}});var Ua=new Map;Ua.set(wt.absolutePosition,function(o,a){o.style.width="".concat(a.w,"px"),o.style.height="".concat(a.h,"px")});Ua.set(wt.xyAttributes,function(o,a){o.setAttribute("width","".concat(a.w)),o.setAttribute("height","".concat(a.h))});var Va=new Map;Va.set(wt.absolutePosition,function(o){return{w:o.offsetWidth,h:o.offsetHeight}});Va.set(wt.xyAttributes,function(o){return{w:parseFloat(o.getAttribute("width")),h:parseFloat(o.getAttribute("height"))}});var Ro=[Su,mu,bu,Oh,Ah,Dh,Eu],kh=function(){},Vn=function(a,n){if(a!=null){a=!Be(a)&&a.tagName==null&&a.length!=null?a:[a];for(var i=0;i<a.length;i++)n.apply(a[i],[a[i]])}},Lh=function(a,n,i){var e=a.srcElement||a.target;return!_n(e,i.getInputFilterSelector(),n)},Nh=function(){function o(a,n){$(this,o),this.el=a,this.manager=n,h(this,"_class",void 0),h(this,"uuid",Ke()),h(this,"enabled",!0),h(this,"scopes",[]),h(this,"eventManager",void 0),this.eventManager=n.eventManager}return J(o,[{key:"setEnabled",value:function(n){this.enabled=n}},{key:"isEnabled",value:function(){return this.enabled}},{key:"toggleEnabled",value:function(){this.enabled=!this.enabled}},{key:"addScope",value:function(n){var i={};Vn(this.scopes,function(t){i[t]=!0}),Vn(n?n.split(/\s+/):[],function(t){i[t]=!0}),this.scopes.length=0;for(var e in i)this.scopes.push(e)}},{key:"removeScope",value:function(n){var i={};Vn(this.scopes,function(t){i[t]=!0}),Vn(n?n.split(/\s+/):[],function(t){delete i[t]}),this.scopes.length=0;for(var e in i)this.scopes.push(e)}},{key:"toggleScope",value:function(n){var i={};Vn(this.scopes,function(t){i[t]=!0}),Vn(n?n.split(/\s+/):[],function(t){i[t]?delete i[t]:i[t]=!0}),this.scopes.length=0;for(var e in i)this.scopes.push(e)}}]),o}();function Rh(o){return{w:o.parentNode.offsetWidth+o.parentNode.scrollLeft,h:o.parentNode.offsetHeight+o.parentNode.scrollTop}}var Kr;(function(o){o.notNegative="notNegative",o.parent="parent",o.parentEnclosed="parentEnclosed"})(Kr||(Kr={}));var Fh=function(o){Ee(n,o);var a=be(n);function n(i,e,t){var r;if($(this,n),r=a.call(this,i,t),h(m(r),"_class",void 0),h(m(r),"rightButtonCanDrag",void 0),h(m(r),"consumeStartEvent",void 0),h(m(r),"clone",void 0),h(m(r),"scroll",void 0),h(m(r),"trackScroll",void 0),h(m(r),"_downAt",void 0),h(m(r),"_posAtDown",void 0),h(m(r),"_pagePosAtDown",void 0),h(m(r),"_pageDelta",{x:0,y:0}),h(m(r),"_moving",void 0),h(m(r),"_lastPosition",void 0),h(m(r),"_lastScrollValues",{x:0,y:0}),h(m(r),"_initialScroll",{x:0,y:0}),h(m(r),"_size",void 0),h(m(r),"_currentParentPosition",void 0),h(m(r),"_ghostParentPosition",void 0),h(m(r),"_dragEl",void 0),h(m(r),"_multipleDrop",void 0),h(m(r),"_ghostProxyOffsets",void 0),h(m(r),"_ghostDx",void 0),h(m(r),"_ghostDy",void 0),h(m(r),"_isConstrained",!1),h(m(r),"_ghostProxyParent",void 0),h(m(r),"_useGhostProxy",void 0),h(m(r),"_ghostProxyFunction",void 0),h(m(r),"_activeSelectorParams",void 0),h(m(r),"_availableSelectors",[]),h(m(r),"_canDrag",void 0),h(m(r),"_consumeFilteredEvents",void 0),h(m(r),"_parent",void 0),h(m(r),"_ignoreZoom",void 0),h(m(r),"_filters",{}),h(m(r),"_constrainRect",void 0),h(m(r),"_elementToDrag",void 0),h(m(r),"downListener",void 0),h(m(r),"moveListener",void 0),h(m(r),"upListener",void 0),h(m(r),"scrollTracker",void 0),h(m(r),"listeners",{start:[],drag:[],stop:[],over:[],out:[],beforeStart:[],revert:[]}),r._class=r.manager.css.draggable,Sn(r.el,r._class),r.downListener=r._downListener.bind(m(r)),r.upListener=r._upListener.bind(m(r)),r.moveListener=r._moveListener.bind(m(r)),r.rightButtonCanDrag=e.rightButtonCanDrag===!0,r.consumeStartEvent=e.consumeStartEvent!==!1,r._dragEl=r.el,r.clone=e.clone===!0,r.scroll=e.scroll===!0,r.trackScroll=e.trackScroll!==!1,r._multipleDrop=e.multipleDrop!==!1,r._canDrag=e.canDrag||No,r._consumeFilteredEvents=e.consumeFilteredEvents,r._parent=e.parent,r._ignoreZoom=e.ignoreZoom===!0,r._ghostProxyParent=e.ghostProxyParent,r.trackScroll&&(r.scrollTracker=r._trackScroll.bind(m(r)),document.addEventListener("scroll",r.scrollTracker)),e.ghostProxy===!0?r._useGhostProxy=No:e.ghostProxy&&typeof e.ghostProxy=="function"?r._useGhostProxy=e.ghostProxy:r._useGhostProxy=function(l,u){return r._activeSelectorParams&&r._activeSelectorParams.useGhostProxy?r._activeSelectorParams.useGhostProxy(l,u):!1},e.makeGhostProxy?r._ghostProxyFunction=e.makeGhostProxy:r._ghostProxyFunction=function(l){return r._activeSelectorParams&&r._activeSelectorParams.makeGhostProxy?r._activeSelectorParams.makeGhostProxy(l):l.cloneNode(!0)},e.selector){var s=r.el.getAttribute(Cu);s==null&&(s=""+new Date().getTime(),r.el.setAttribute("katavorio-draggable",s)),r._availableSelectors.push(e)}return r.eventManager.on(r.el,de,r.downListener),r}return J(n,[{key:"_trackScroll",value:function(e){if(this._moving){var t={x:document.documentElement.scrollLeft,y:document.documentElement.scrollTop},r=t.x-this._lastScrollValues.x,s=t.y-this._lastScrollValues.y,l={x:r+this._lastPosition.x,y:s+this._lastPosition.y},u=l.x-this._downAt.x,c=l.y-this._downAt.y,d=this._ignoreZoom?1:this.manager.getZoom();this._dragEl&&this._dragEl.parentNode&&(u+=this._dragEl.parentNode.scrollLeft-this._initialScroll.x,c+=this._dragEl.parentNode.scrollTop-this._initialScroll.y),u/=d,c/=d,this.moveBy(u,c,e),this._lastPosition=l,this._lastScrollValues=t}}},{key:"on",value:function(e,t){this.listeners[e]&&this.listeners[e].push(t)}},{key:"off",value:function(e,t){if(this.listeners[e]){for(var r=[],s=0;s<this.listeners[e].length;s++)this.listeners[e][s]!==t&&r.push(this.listeners[e][s]);this.listeners[e]=r}}},{key:"_upListener",value:function(e){this._downAt&&(this._downAt=null,this.eventManager.off(document,ze,this.moveListener),this.eventManager.off(document,fe,this.upListener),Zo(document.body,Fr.noSelect),this.unmark(e),this.stop(e),this._moving=!1,this.clone?(this._dragEl&&this._dragEl.parentNode&&this._dragEl.parentNode.removeChild(this._dragEl),this._dragEl=null):this._activeSelectorParams&&this._activeSelectorParams.revertFunction&&this._activeSelectorParams.revertFunction(this._dragEl,this.manager.getPosition(this._dragEl))===!0&&(this.manager.setPosition(this._dragEl,this._posAtDown),this._dispatch(Qi,this._dragEl)))}},{key:"_downListener",value:function(e){if(!e.defaultPrevented){var t=this.rightButtonCanDrag||e.which!==3&&e.button!==2;if(t&&this.isEnabled()&&this._canDrag()){var r=this._testFilter(e)&&Lh(e,this.el,this.manager);if(r){this._activeSelectorParams=null,this._elementToDrag=null,this._availableSelectors.length===0&&console.log("JSPLUMB: no available drag selectors");var s=e.target||e.srcElement,l=Th(this._availableSelectors,this.el,s);if(l!=null&&(this._activeSelectorParams=l[0],this._elementToDrag=l[1]),this._activeSelectorParams==null||this._elementToDrag==null)return;var u=this._activeSelectorParams.dragInit?this._activeSelectorParams.dragInit(this._elementToDrag,e):null;if(u!=null&&(this._elementToDrag=u),this.clone)if(this._dragEl=this._elementToDrag.cloneNode(!0),Sn(this._dragEl,Fr.clonedDrag),this._dragEl.setAttribute("id",null),this._dragEl.style.position="absolute",this._parent!=null){var c=this.manager.getPosition(this.el);this._dragEl.style.left=c.x+"px",this._dragEl.style.top=c.y+"px",this._parent.appendChild(this._dragEl)}else{var d=Qn(this._elementToDrag);this._dragEl.style.left=d.x+"px",this._dragEl.style.top=d.y+"px",document.body.appendChild(this._dragEl)}else this._dragEl=this._elementToDrag;this.consumeStartEvent&&Jr(e),this._downAt=to(e),this._dragEl&&this._dragEl.parentNode&&(this._initialScroll={x:this._dragEl.parentNode.scrollLeft,y:this._dragEl.parentNode.scrollTop}),this._posAtDown=this.manager.getPosition(this._dragEl),this._pagePosAtDown=Qn(this._dragEl),this._pageDelta={x:this._pagePosAtDown.x-this._posAtDown.x,y:this._pagePosAtDown.y-this._posAtDown.y},this._size=this.manager.getSize(this._dragEl),this.eventManager.on(document,ze,this.moveListener),this.eventManager.on(document,fe,this.upListener),Sn(document.body,Fr.noSelect),this._dispatch(Eu,{el:this.el,pos:this._posAtDown,e,drag:this,size:this._size})}else this._consumeFilteredEvents&&Jr(e)}}}},{key:"_moveListener",value:function(e){if(this._downAt){if(!this._moving){var t=this._dispatch(mu,{el:this.el,pos:this._posAtDown,e,drag:this,size:this._size});if(t!==!1){if(!this._downAt)return;this.mark(t),this._moving=!0}else this.abort()}if(this._downAt){var r=to(e),s=r.x-this._downAt.x,l=r.y-this._downAt.y,u=this._ignoreZoom?1:this.manager.getZoom();this._lastPosition={x:r.x,y:r.y},this._lastScrollValues={x:document.documentElement.scrollLeft,y:document.documentElement.scrollTop},this._dragEl&&this._dragEl.parentNode&&(s+=this._dragEl.parentNode.scrollLeft-this._initialScroll.x,l+=this._dragEl.parentNode.scrollTop-this._initialScroll.y),s/=u,l/=u,this.moveBy(s,l,e)}}}},{key:"getDragDelta",value:function(){return this._posAtDown!=null&&this._downAt!=null?{x:this._downAt.x-this._posAtDown.x,y:this._downAt.y-this._posAtDown.y}:{x:0,y:0}}},{key:"mark",value:function(e){this._posAtDown=this.manager.getPosition(this._dragEl),this._pagePosAtDown=Qn(this._dragEl),this._pageDelta={x:this._pagePosAtDown.x-this._posAtDown.x,y:this._pagePosAtDown.y-this._posAtDown.y},this._size=this.manager.getSize(this._dragEl),Sn(this._dragEl,this.manager.css.drag),this._constrainRect=Rh(this._dragEl),this._ghostDx=0,this._ghostDy=0}},{key:"unmark",value:function(e){this._isConstrained&&this._useGhostProxy(this._elementToDrag,this._dragEl)?(this._ghostProxyOffsets={x:this._dragEl.offsetLeft-this._ghostDx,y:this._dragEl.offsetTop-this._ghostDy},this._dragEl.parentNode.removeChild(this._dragEl),this._dragEl=this._elementToDrag):this._ghostProxyOffsets=null,Zo(this._dragEl,this.manager.css.drag),this._isConstrained=!1}},{key:"moveBy",value:function(e,t,r){var s=this.toGrid({x:this._posAtDown.x+e,y:this._posAtDown.y+t}),l=this._doConstrain(s,this._dragEl,this._constrainRect,this._size,r);if(l!=null){if(this._useGhostProxy(this.el,this._dragEl))if(s.x!==l.x||s.y!==l.y){if(!this._isConstrained){var u=this._ghostProxyFunction(this._elementToDrag);Sn(u,Fr.ghostProxy),this._ghostProxyParent?(this._ghostProxyParent.appendChild(u),this._currentParentPosition=Qn(this._elementToDrag.parentNode),this._ghostParentPosition=Qn(this._ghostProxyParent),this._ghostDx=this._currentParentPosition.x-this._ghostParentPosition.x,this._ghostDy=this._currentParentPosition.y-this._ghostParentPosition.y):this._elementToDrag.parentNode.appendChild(u),this._dragEl=u,this._isConstrained=!0}l=s}else this._isConstrained&&(this._dragEl.parentNode.removeChild(this._dragEl),this._dragEl=this._elementToDrag,this._isConstrained=!1,this._currentParentPosition=null,this._ghostParentPosition=null,this._ghostDx=0,this._ghostDy=0);this.manager.setPosition(this._dragEl,{x:l.x+this._ghostDx,y:l.y+this._ghostDy}),this._dispatch(bu,{el:this.el,pos:l,e:r,drag:this,size:this._size,originalPos:this._posAtDown})}}},{key:"abort",value:function(){this._downAt!=null&&this._upListener()}},{key:"getDragElement",value:function(e){return e?this._elementToDrag||this.el:this._dragEl||this.el}},{key:"stop",value:function(e,t){if(t||this._moving){var r=[],s=this.manager.getPosition(this._dragEl);r.push([this._dragEl,s,this,this._size]),this._dispatch(Su,{el:this._dragEl,pos:this._ghostProxyOffsets||s,finalPos:s,e,drag:this,selection:r,size:this._size,originalPos:{x:this._posAtDown.x,y:this._posAtDown.y}})}else this._moving||this._activeSelectorParams.dragAbort&&this._activeSelectorParams.dragAbort(this._elementToDrag)}},{key:"_dispatch",value:function(e,t){var r=null;if(this._activeSelectorParams&&this._activeSelectorParams[e])r=this._activeSelectorParams[e](t);else if(this.listeners[e])for(var s=0;s<this.listeners[e].length;s++)try{var l=this.listeners[e][s](t);l!=null&&(r=l)}catch{}return r}},{key:"resolveGrid",value:function(){var e={grid:null,thresholdX:_h/2,thresholdY:wh/2};return this._activeSelectorParams!=null&&this._activeSelectorParams.grid!=null&&(e.grid=this._activeSelectorParams.grid,this._activeSelectorParams.snapThreshold!=null&&(e.thresholdX=this._activeSelectorParams.snapThreshold,e.thresholdY=this._activeSelectorParams.snapThreshold)),e}},{key:"toGrid",value:function(e){var t=this.resolveGrid(),r=t.grid,s=t.thresholdX,l=t.thresholdY;if(r==null)return e;var u=r?r.w/2:s,c=r?r.h/2:l;return Ch(e,r,u,c)}},{key:"setUseGhostProxy",value:function(e){this._useGhostProxy=e?No:Mh}},{key:"_doConstrain",value:function(e,t,r,s,l){return this._activeSelectorParams!=null&&this._activeSelectorParams.constrainFunction&&typeof this._activeSelectorParams.constrainFunction=="function"?this._activeSelectorParams.constrainFunction(e,t,r,s,l):e}},{key:"_testFilter",value:function(e){for(var t in this._filters){var r=this._filters[t],s=r[0](e);if(r[1]&&(s=!s),!s)return!1}return!0}},{key:"addFilter",value:function(e,t){var r=this;if(e){var s=Ph(e);this._filters[s]=[function(l){var u=l.srcElement||l.target,c;return Be(e)?c=_n(u,e,r.el):typeof e=="function"&&(c=e(l,r.el)),c},t!==!1]}}},{key:"removeFilter",value:function(e){var t=typeof e=="function"?e._katavorioId:e;delete this._filters[t]}},{key:"clearAllFilters",value:function(){this._filters={}}},{key:"addSelector",value:function(e,t){e.selector&&(t?this._availableSelectors.unshift(e):this._availableSelectors.push(e))}},{key:"destroy",value:function(){this.eventManager.off(this.el,de,this.downListener),this.eventManager.off(document,ze,this.moveListener),this.eventManager.off(document,fe,this.upListener),this.downListener=null,this.upListener=null,this.moveListener=null,this.scrollTracker!=null&&document.removeEventListener("scroll",this.scrollTracker)}}]),n}(Nh),Gh=["input","textarea","select","button","option"],jh=Gh.join(","),Bh=function(){function o(a){$(this,o),h(this,"eventManager",void 0),h(this,"zoom",1),h(this,"css",{}),h(this,"inputFilterSelector",void 0),h(this,"positioningStrategy",void 0),h(this,"_positionSetter",void 0),h(this,"_positionGetter",void 0),h(this,"_sizeSetter",void 0),h(this,"_sizeGetter",void 0),a=a||{},this.inputFilterSelector=a.inputFilterSelector||jh,this.eventManager=new Fa,this.zoom=a.zoom||1,this.positioningStrategy=a.positioningStrategy||wt.absolutePosition,this._positionGetter=Ba.get(this.positioningStrategy),this._positionSetter=ja.get(this.positioningStrategy),this._sizeGetter=Va.get(this.positioningStrategy),this._sizeSetter=Ua.get(this.positioningStrategy);var n=a.css||{};W(this.css,n)}return J(o,[{key:"getPosition",value:function(n){return this._positionGetter(n)}},{key:"setPosition",value:function(n,i){this._positionSetter(n,i)}},{key:"getSize",value:function(n){return this._sizeGetter(n)}},{key:"getZoom",value:function(){return this.zoom}},{key:"setZoom",value:function(n){this.zoom=n}},{key:"_prepareParams",value:function(n){n=n||{};var i={events:{}},e;for(e in n)i[e]=n[e];for(e=0;e<Ro.length;e++)i.events[Ro[e]]=n[Ro[e]]||kh;return i}},{key:"getInputFilterSelector",value:function(){return this.inputFilterSelector}},{key:"setInputFilterSelector",value:function(n){return this.inputFilterSelector=n,this}},{key:"draggable",value:function(n,i){if(n._katavorioDrag==null){var e=this._prepareParams(i),t=new Fh(n,e,this);return Sn(n,Fr.delegatedDraggable),n._katavorioDrag=t,t}else return n._katavorioDrag}},{key:"destroyDraggable",value:function(n){n._katavorioDrag&&(n._katavorioDrag.destroy(),delete n._katavorioDrag)}}]),o}(),Ui="jtk-drag-selected",Uh=function(){function o(a){$(this,o),this.instance=a,h(this,"_dragSelection",[]),h(this,"_dragSizes",new Map),h(this,"_dragElements",new Map),h(this,"_dragElementStartPositions",new Map),h(this,"_dragElementPositions",new Map),h(this,"__activeSet",void 0)}return J(o,[{key:"_activeSet",get:function(){return this.__activeSet==null?this._dragSelection:this.__activeSet}},{key:"length",get:function(){return this._dragSelection.length}},{key:"filterActiveSet",value:function(n){var i=this;this.__activeSet=[],K(this._dragSelection,function(e){n(e)&&i.__activeSet.push(e)})}},{key:"clear",value:function(){var n=this;this.reset(),K(this._dragSelection,function(i){return n.instance.removeClass(i.jel,Ui)}),this._dragSelection.length=0}},{key:"reset",value:function(){this._dragElementStartPositions.clear(),this._dragElementPositions.clear(),this._dragSizes.clear(),this._dragElements.clear(),this.__activeSet=null}},{key:"initialisePositions",value:function(){var n=this;K(this._activeSet,function(i){var e=n.instance.viewport.getPosition(i.id),t={x:parseInt(""+i.jel.offsetLeft,10),y:parseInt(""+i.jel.offsetTop,10)};n._dragElementStartPositions.set(i.id,t),n._dragElementPositions.set(i.id,t),n._dragSizes.set(i.id,{w:e.w,h:e.h})})}},{key:"updatePositions",value:function(n,i,e){var t=this,r=n.x-i.x,s=n.y-i.y;K(this._activeSet,function(l){var u=t._dragElementStartPositions.get(l.id);if(u){var c=u.x+r,d=u.y+s,f=t._dragSizes.get(l.id),v={x:c,y:d,w:f.w,h:f.h};if(l.jel._jsPlumbParentGroup&&l.jel._jsPlumbParentGroup.constrain){var p={w:l.jel.parentNode.offsetWidth+l.jel.parentNode.scrollLeft,h:l.jel.parentNode.offsetHeight+l.jel.parentNode.scrollTop};v.x=Math.max(v.x,0),v.y=Math.max(v.y,0),v.x=Math.min(v.x,p.w-f.w),v.y=Math.min(v.y,p.h-f.h)}t._dragElementPositions.set(l.id,{x:c,y:d}),l.jel.style.left=v.x+"px",l.jel.style.top=v.y+"px",e(l.jel,l.id,f,v)}})}},{key:"each",value:function(n){var i=this;K(this._activeSet,function(e){var t=i._dragSizes.get(e.id),r=i._dragElementPositions.get(e.id),s=i._dragElementStartPositions.get(e.id);n(e.jel,e.id,r,t,s)})}},{key:"add",value:function(n,i){var e=n;i=i||this.instance.getId(e);var t=un(this._dragSelection,function(r){return r.id===i});t===-1&&(this.instance.addClass(n,Ui),this._dragSelection.push({id:i,jel:e}))}},{key:"remove",value:function(n){var i=this,e=n;this._dragSelection=this._dragSelection.filter(function(t){var r=t.jel!==e;return r||i.instance.removeClass(t.jel,Ui),r})}},{key:"toggle",value:function(n){var i=n,e=un(this._dragSelection,function(t){return t.jel===i});e!==-1?this.remove(i):this.add(n)}}]),o}(),Vh="jtk-delegated-draggable",Hh="jtk-draggable",Yh="jtk-drag",Xh="jtk-ghost-proxy",an="jtk-drag-active",$h="jtk-dragged",sn="jtk-drag-hover",Wh=function(){function o(a,n,i){var e=this;$(this,o),this.instance=a,this.dragSelection=n,h(this,"collicat",void 0),h(this,"drag",void 0),h(this,"_draggables",{}),h(this,"_dlist",[]),h(this,"_elementsWithEndpoints",{}),h(this,"_draggablesForElements",{}),h(this,"handlers",[]),h(this,"_trackScroll",void 0),h(this,"_filtersToAdd",[]),this.collicat=new Bh({zoom:this.instance.currentZoom,css:{noSelect:this.instance.dragSelectClass,delegatedDraggable:Vh,draggable:Hh,drag:Yh,selected:Ui,active:an,hover:sn,ghostProxy:Xh}}),this.instance.bind(au,function(t){e.collicat.setZoom(t)}),i=i||{},this._trackScroll=i.trackScroll!==!1}return J(o,[{key:"addHandler",value:function(n,i){var e=this,t=W({selector:n.selector},i||{});t.start=bi(t.start,function(l){return n.onStart(l)},!1),t.drag=bi(t.drag,function(l){return n.onDrag(l)}),t.stop=bi(t.stop,function(l){return n.onStop(l)});var r=(n.onBeforeStart||function(l){}).bind(n);if(t.beforeStart=bi(t.beforeStart,function(l){return r(l)}),t.dragInit=function(l,u){return n.onDragInit(l,u)},t.dragAbort=function(l){return n.onDragAbort(l)},n.useGhostProxy&&(t.useGhostProxy=n.useGhostProxy,t.makeGhostProxy=n.makeGhostProxy),t.constrainFunction==null&&t.containment!=null)switch(t.containment){case Kr.notNegative:{t.constrainFunction=function(l,u,c,d){return{x:Math.max(0,Math.min(l.x)),y:Math.max(0,Math.min(l.y))}};break}case Kr.parent:{var s=t.containmentPadding||5;t.constrainFunction=function(l,u,c,d){var f=l.x<0?0:l.x>c.w-s?c.w-s:l.x,v=l.y<0?0:l.y>c.h-s?c.h-s:l.y;return{x:f,y:v}};break}case Kr.parentEnclosed:{t.constrainFunction=function(l,u,c,d){var f=l.x<0?0:l.x+d.w>c.w?c.w-d.w:l.x,v=l.y<0?0:l.y+d.h>c.h?c.h-d.h:l.y;return{x:f,y:v}};break}}this.drag==null?(t.trackScroll=this._trackScroll,this.drag=this.collicat.draggable(this.instance.getContainer(),t),K(this._filtersToAdd,function(l){return e.drag.addFilter(l[0],l[1])}),this.drag.on(Qi,function(l){e.instance.revalidate(l)})):this.drag.addSelector(t),this.handlers.push({handler:n,options:t}),n.init(this.drag)}},{key:"addSelector",value:function(n,i){this.drag&&this.drag.addSelector(n,i)}},{key:"addFilter",value:function(n,i){this.drag==null?this._filtersToAdd.push([n,i===!0]):this.drag.addFilter(n,i)}},{key:"removeFilter",value:function(n){this.drag!=null&&this.drag.removeFilter(n)}},{key:"setFilters",value:function(n){var i=this;K(n,function(e){i.drag.addFilter(e[0],e[1])})}},{key:"reset",value:function(){var n=[];if(K(this.handlers,function(t){t.handler.reset()}),this.handlers.length=0,this.drag!=null){var i=this.drag._filters;for(var e in i)n.push([e,i[e][1]]);this.collicat.destroyDraggable(this.instance.getContainer())}return delete this.drag,n}},{key:"setOption",value:function(n,i){var e=Ta(this.handlers,function(t){return t.handler===n});e!=null&&W(e.options,i||{})}}]),o}();function Kh(o,a){return Be(a)?{id:a,active:!0}:{id:a.id,active:a.active}}function zh(o,a){var n=Hl(o.members,function(i){return i.el===a});return n!==null?n.active===!0:!1}function Zh(o){for(var a=[],n=o._jsPlumbParentGroup;n!=null;)a.push(n.el),n=n.group;return a}var ia=function(){function o(a,n){$(this,o),this.instance=a,this._dragSelection=n,h(this,"selector","> "+Ie+":not("+Mn(po)+")"),h(this,"_dragOffset",null),h(this,"_groupLocations",[]),h(this,"_intersectingGroups",[]),h(this,"_currentDragParentGroup",null),h(this,"_dragGroupByElementIdMap",{}),h(this,"_dragGroupMap",{}),h(this,"_currentDragGroup",null),h(this,"_currentDragGroupOffsets",new Map),h(this,"_currentDragGroupSizes",new Map),h(this,"_currentDragGroupOriginalPositions",new Map),h(this,"_dragPayload",null),h(this,"drag",void 0),h(this,"originalPosition",void 0)}return J(o,[{key:"onDragInit",value:function(n){return null}},{key:"onDragAbort",value:function(n){return null}},{key:"getDropGroup",value:function(){var n=null;if(this._intersectingGroups.length>0){var i=this._intersectingGroups[0].groupLoc.group,e=this._intersectingGroups[0].intersectingElement,t=e._jsPlumbParentGroup;t!==i&&(t==null||!t.overrideDrop(e,i))&&(n=this._intersectingGroups[0])}return n}},{key:"onStop",value:function(n){var i,e=this,t=n.drag.getDragElement(),r=this.getDropGroup(),s=[];s.push({el:t,id:this.instance.getId(t),pos:n.finalPos,originalGroup:t._jsPlumbParentGroup,redrawResult:null,originalPos:n.originalPos,reverted:!1,dropGroup:r!=null?r.groupLoc.group:null});function l(p,y,g,E,b){var S=g.x,C=g.y;if(p._jsPlumbParentGroup&&p._jsPlumbParentGroup.constrain){var x={w:p.parentNode.offsetWidth+p.parentNode.scrollLeft,h:p.parentNode.offsetHeight+p.parentNode.scrollTop};S=Math.max(S,0),C=Math.max(C,0),S=Math.min(S,x.w-E.w),C=Math.min(C,x.h-E.h),g.x=S,g.y=C}s.push({el:p,id:y,pos:g,originalPos:b,originalGroup:p._jsPlumbParentGroup,redrawResult:null,reverted:!1,dropGroup:r==null?void 0:r.groupLoc.group})}if(this._dragSelection.each(function(p,y,g,E,b){p!==n.el&&l(p,y,{x:g.x,y:g.y},E,b)}),(i=this._currentDragGroup)===null||i===void 0||i.members.forEach(function(p){if(p.el!==n.el){var y=e._currentDragGroupOffsets.get(p.elId),g=e._currentDragGroupSizes.get(p.elId),E={x:n.finalPos.x+y[0].x,y:n.finalPos.y+y[0].y};l(p.el,p.elId,E,g,e._currentDragGroupOriginalPositions.get(p.elId))}}),K(s,function(p){var y=p.originalGroup!=null,g=y&&Os(e.instance,p.el,p.pos),E={x:0,y:0};if(y&&!g){if(r==null){var b=e._pruneOrOrphan(p,!0,!0);b.pos!=null?p.pos=b.pos.pos:!b.pruned&&p.originalGroup.revert&&(p.pos=p.originalPos,p.reverted=!0)}}else y&&g&&(E=e._computeOffsetByParentGroup(p.originalGroup));r!=null&&!g?e.instance.groupManager.addToGroup(r.groupLoc.group,!1,p.el):p.dropGroup=null,p.reverted&&e.instance.setPosition(p.el,p.pos),p.redrawResult=e.instance.setElementPosition(p.el,p.pos.x+E.x,p.pos.y+E.y),e.instance.removeClass(p.el,$h),e.instance.select({source:p.el}).removeClass(e.instance.elementDraggingClass+" "+e.instance.sourceElementDraggingClass,!0),e.instance.select({target:p.el}).removeClass(e.instance.elementDraggingClass+" "+e.instance.targetElementDraggingClass,!0)}),s[0].originalGroup!=null){var u=t._jsPlumbParentGroup;if(u!==s[0].originalGroup){var c=n.drag.getDragElement(!0);if(s[0].originalGroup.ghost){var d=this.instance.getPosition(this.instance.getGroupContentArea(u)),f=this.instance.getPosition(this.instance.getGroupContentArea(s[0].originalGroup)),v={x:f.x+n.pos.x-d.x,y:f.y+n.pos.y-d.y};c.style.left=v.x+"px",c.style.top=v.y+"px",this.instance.revalidate(c)}}}this.instance.fire(Of,{elements:s,e:n.e,el:t,payload:this._dragPayload}),this._cleanup()}},{key:"_cleanup",value:function(){var n=this;K(this._groupLocations,function(i){n.instance.removeClass(i.el,an),n.instance.removeClass(i.el,sn)}),this._currentDragParentGroup=null,this._groupLocations.length=0,this.instance.hoverSuspended=!1,this._dragOffset=null,this._dragSelection.reset(),this._dragPayload=null,this._currentDragGroupOffsets.clear(),this._currentDragGroupSizes.clear(),this._currentDragGroupOriginalPositions.clear(),this._currentDragGroup=null}},{key:"reset",value:function(){}},{key:"init",value:function(n){this.drag=n}},{key:"onDrag",value:function(n){var i=this,e=n.drag.getDragElement(),t=this.instance.getId(e),r=n.pos,s=this.instance.viewport.getPosition(t),l={x:r.x,y:r.y};this._intersectingGroups.length=0,this._dragOffset!=null&&(l.x+=this._dragOffset.x,l.y+=this._dragOffset.y);var u=function(f,v,p){if(p){var y=new Set;K(i._groupLocations,function(g){!y.has(g.group.id)&&yu(v,g.r)?(g.group!==i._currentDragParentGroup&&i.instance.addClass(g.el,sn),i._intersectingGroups.push({groupLoc:g,intersectingElement:n.drag.getDragElement(!0),d:0}),K(i.instance.groupManager.getAncestors(g.group),function(E){return y.add(E.id)})):i.instance.removeClass(g.el,sn)})}i.instance.setElementPosition(f,v.x,v.y),i.instance.fire(Tf,{el:f,e:n.e,pos:{x:v.x,y:v.y},originalPosition:i.originalPosition,payload:i._dragPayload})},c={x:l.x,y:l.y,w:s.w,h:s.h};u(e,c,!0),this._dragSelection.updatePositions(r,this.originalPosition,function(d,f,v,p){u(d,p,!1)}),this._currentDragGroupOffsets.forEach(function(d,f){var v=i._currentDragGroupSizes.get(f),p={x:c.x+d[0].x,y:c.y+d[0].y,w:v.w,h:v.h};d[1].style.left=p.x+"px",d[1].style.top=p.y+"px",u(d[1],p,!1)})}},{key:"_computeOffsetByParentGroup",value:function(n){var i=this.instance.getPosition(n.el),e=n.contentArea;if(e!==n.el){var t=this.instance.getPosition(e);i.x+=t.x,i.y+=t.y}if(n.el._jsPlumbParentGroup){var r=this._computeOffsetByParentGroup(n.el._jsPlumbParentGroup);i.x+=r.x,i.y+=r.y}return i}},{key:"onStart",value:function(n){var i=this,e=n.drag.getDragElement(),t=this.instance.getPosition(e);this.originalPosition={x:n.pos.x,y:n.pos.y},e._jsPlumbParentGroup&&(this._dragOffset=this._computeOffsetByParentGroup(e._jsPlumbParentGroup),this._currentDragParentGroup=e._jsPlumbParentGroup);var r=!0,s=e.getAttribute(Fi);if((this.instance.elementsDraggable===!1||s!=null&&s!==er)&&(r=!1),r){this._groupLocations.length=0,this._intersectingGroups.length=0,this.instance.hoverSuspended=!0;var l=n.drag.getDragElement(!0),u=l.querySelectorAll(Ie),c=Zh(l),d=[];Array.prototype.push.apply(d,u),Array.prototype.push.apply(d,c),this._dragSelection.filterActiveSet(function(y){return d.indexOf(y.jel)===-1}),this._dragSelection.initialisePositions();var f=function(g,E,b){if(!g._isJsPlumbGroup||i.instance.allowNestedGroups){var S=!g._jsPlumbParentGroup,C=S||g._jsPlumbParentGroup.dropOverride!==!0,x=!S&&(g._jsPlumbParentGroup.ghost||g._jsPlumbParentGroup.constrain!==!0);(S||C&&x)&&(K(i.instance.groupManager.getGroups(),function(T){var O=g._jsPlumbGroup;if(T.droppable!==!1&&T.enabled!==!1&&g._jsPlumbGroup!==T&&!i.instance.groupManager.isDescendant(T,O)){var P=T.el,A=i.instance.getId(P),_=i.instance.viewport.getPosition(A),R={x:_.x,y:_.y,w:_.w,h:_.h},M={el:P,r:R,group:T};i._groupLocations.push(M),T!==i._currentDragParentGroup&&i.instance.addClass(P,an)}}),i._groupLocations.sort(function(T,O){return i.instance.groupManager.isDescendant(T.group,O.group)?-1:i.instance.groupManager.isAncestor(O.group,T.group)?1:0}))}return i.instance.select({source:g}).addClass(i.instance.elementDraggingClass+" "+i.instance.sourceElementDraggingClass,!0),i.instance.select({target:g}).addClass(i.instance.elementDraggingClass+" "+i.instance.targetElementDraggingClass,!0),i.instance.fire(Af,{el:g,e:n.e,originalPosition:i.originalPosition,pos:i.originalPosition,dragGroup:E,dragGroupMemberSpec:b})},v=this.instance.getId(e);this._currentDragGroup=this._dragGroupByElementIdMap[v],this._currentDragGroup&&!zh(this._currentDragGroup,e)&&(this._currentDragGroup=null);var p=f(e);if(p===!1)return this._cleanup(),!1;this._dragPayload=p,this._currentDragGroup!=null&&(this._currentDragGroupOffsets.clear(),this._currentDragGroupSizes.clear(),this._currentDragGroup.members.forEach(function(y){var g=i.instance.viewport.getPosition(y.elId);i._currentDragGroupOffsets.set(y.elId,[{x:g.x-t.x,y:g.y-t.y},y.el]),i._currentDragGroupSizes.set(y.elId,g),i._currentDragGroupOriginalPositions.set(y.elId,{x:g.x,y:g.y}),f(y.el,i._currentDragGroup,y)}))}return r}},{key:"addToDragGroup",value:function(n){var i=this,e=Kh(this.instance,n),t=this._dragGroupMap[e.id];t==null&&(t={id:e.id,members:new Set},this._dragGroupMap[e.id]=t);for(var r=arguments.length,s=new Array(r>1?r-1:0),l=1;l<r;l++)s[l-1]=arguments[l];this.removeFromDragGroup.apply(this,s),K(s,function(u){var c=i.instance.getId(u);t.members.add({elId:c,el:u,active:e.active}),i._dragGroupByElementIdMap[c]=t})}},{key:"removeFromDragGroup",value:function(){for(var n=this,i=arguments.length,e=new Array(i),t=0;t<i;t++)e[t]=arguments[t];K(e,function(r){var s=n.instance.getId(r),l=n._dragGroupByElementIdMap[s];if(l!=null){var u=new Set;l.members.forEach(function(c){c.el!==r&&u.add(c)}),l.members=u,delete n._dragGroupByElementIdMap[s]}})}},{key:"setDragGroupState",value:function(n){for(var i=this,e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];var s=t.map(function(l){return i.instance.getId(l)});K(s,function(l){var u=i._dragGroupByElementIdMap[l];if(u!=null){var c=Hl(u.members,function(d){return d.elId===l});c!=null&&(c.active=n)}})}},{key:"clearDragGroup",value:function(n){var i=this,e=this._dragGroupMap[n];e!=null&&(e.members.forEach(function(t){delete i._dragGroupByElementIdMap[t.elId]}),e.members.clear())}},{key:"_pruneOrOrphan",value:function(n,i,e){var t=n.el,r={pruned:!1,pos:null};if(e||!Os(this.instance,t,n.pos)){var s=t._jsPlumbParentGroup;s.prune?(t._isJsPlumbGroup?this.instance.removeGroup(t._jsPlumbGroup):s.remove(n.el,!0),r.pruned=!0):s.orphan&&(r.pos=this.instance.groupManager.orphan(n.el,i),t._isJsPlumbGroup?s.removeGroup(t._jsPlumbGroup):s.remove(n.el))}return r}}]),o}(),As={},Ds={},Is={},ln={get:function(a,n,i){var e=As[n];if(e)return new e(a,i);throw{message:"jsPlumb: unknown endpoint type '"+n+"'"}},clone:function(a){var n=Is[a.type];return ln.get(a.endpoint,a.type,n.getParams(a))},compute:function(a,n,i,e){var t=Ds[a.type];if(t!=null)return t(a,n,i,e);We("jsPlumb: cannot find endpoint calculator for endpoint of type ",a.type)},registerHandler:function(a){Is[a.type]=a,As[a.type]=a.cls,Ds[a.type]=a.compute}},vr=function(){function o(a,n){$(this,o),this.endpoint=a,h(this,"typeId",void 0),h(this,"x",void 0),h(this,"y",void 0),h(this,"w",void 0),h(this,"h",void 0),h(this,"computedValue",void 0),h(this,"bounds",qi()),h(this,"classes",[]),h(this,"instance",void 0),h(this,"type",void 0),n=n||{},this.instance=a.instance,a.cssClass&&this.classes.push(a.cssClass),n.cssClass&&this.classes.push(n.cssClass)}return J(o,[{key:"addClass",value:function(n){this.classes.push(n),this.instance.addEndpointClass(this.endpoint,n)}},{key:"removeClass",value:function(n){this.classes=this.classes.filter(function(i){return i!==n}),this.instance.removeEndpointClass(this.endpoint,n)}},{key:"compute",value:function(n,i,e){this.computedValue=ln.compute(this,n,i,e),this.bounds.xmin=this.x,this.bounds.ymin=this.y,this.bounds.xmax=this.x+this.w,this.bounds.ymax=this.y+this.h}},{key:"setVisible",value:function(n){this.instance.setEndpointVisible(this.endpoint,n)}}]),o}(),Hn,Yn,Xn,dr;(function(o){o.top="top",o.left="left",o.right="right",o.bottom="bottom"})(dr||(dr={}));var He=dr.top,rt=dr.left,et=dr.right,lt=dr.bottom,Jh=[rt,et],Qh=[He,lt],qh=function(){function o(a,n,i){$(this,o),this.instance=a,this.element=n,h(this,"isFloating",!0),h(this,"isContinuous",void 0),h(this,"isDynamic",void 0),h(this,"locations",[]),h(this,"currentLocation",0),h(this,"locked",!1),h(this,"cssClass",""),h(this,"timestamp",null),h(this,"type","Floating"),h(this,"id",Ke()),h(this,"orientation",[0,0]),h(this,"size",void 0),this.size=a.viewport.getPosition(i),this.locations.push({x:.5,y:.5,ox:this.orientation[0],oy:this.orientation[1],offx:0,offy:0,iox:this.orientation[0],ioy:this.orientation[1],cls:""})}return J(o,[{key:"_updateOrientationInRouter",value:function(){this.instance.router.setAnchorOrientation(this,[this.locations[0].ox,this.locations[0].oy])}},{key:"over",value:function(n){this.orientation=this.instance.router.getEndpointOrientation(n),this.locations[0].ox=this.orientation[0],this.locations[0].oy=this.orientation[1],this._updateOrientationInRouter()}},{key:"out",value:function(){this.orientation=null,this.locations[0].ox=this.locations[0].iox,this.locations[0].oy=this.locations[0].ioy,this._updateOrientationInRouter()}}]),o}(),_s=(Hn={},h(Hn,He,lt),h(Hn,et,rt),h(Hn,rt,et),h(Hn,lt,He),Hn),xu=(Yn={},h(Yn,He,et),h(Yn,et,lt),h(Yn,rt,He),h(Yn,lt,rt),Yn),Pu=(Xn={},h(Xn,He,rt),h(Xn,et,He),h(Xn,rt,lt),h(Xn,lt,et),Xn);function ev(o){return o.faces.length===0?He:o.faces[0]}function Gr(o,a){return o.faces.indexOf(a)!==-1}function tv(o,a){return(o.clockwise?xu:Pu)[a]}function nv(o,a){return(o.clockwise?Pu:xu)[a]}function ws(o,a){return o.lockedAxis==null?o.lockedFace==null?Gr(o,a)===!0:o.lockedFace===a:o.lockedAxis.indexOf(a)!==-1}function rv(o,a){if(Gr(o,a))return a;if(Gr(o,_s[a]))return _s[a];var n=tv(o,a);if(Gr(o,n))return n;var i=nv(o,a);return Gr(o,i)?i:a}var Ms={x:.5,y:0,ox:0,oy:-1,offx:0,offy:0},ks={x:.5,y:1,ox:0,oy:1,offx:0,offy:0},Ls={x:0,y:.5,ox:-1,oy:0,offx:0,offy:0},Ns={x:1,y:.5,ox:1,oy:0,offx:0,offy:0},iv={x:0,y:0,ox:0,oy:-1,offx:0,offy:0},ov={x:1,y:0,ox:1,oy:-1,offx:0,offy:0},av={x:0,y:1,ox:0,oy:1,offx:0,offy:0},sv={x:1,y:1,ox:0,oy:1,offx:0,offy:0},lv={x:.5,y:.5,ox:0,oy:0,offx:0,offy:0},Tu={Top:[Ms],Bottom:[ks],Left:[Ls],Right:[Ns],TopLeft:[iv],TopRight:[ov],BottomLeft:[av],BottomRight:[sv],Center:[lv],AutoDefault:[Ms,Ls,ks,Ns]},uv={Continuous:{faces:[He,rt,lt,et]},ContinuousTop:{faces:[He]},ContinuousRight:{faces:[et]},ContinuousBottom:{faces:[lt]},ContinuousLeft:{faces:[rt]},ContinuousLeftRight:{faces:[rt,et]},ContinuousTopBottom:{faces:[He,lt]}};function Rs(o,a){if(a=a||{},o===Gt.Perimeter)return yv(a);var n=Tu[o];if(n!=null)return io(o,Xl(n,function(i){return W({iox:i.ox,ioy:i.oy},i)}),a);if(n=uv[o],n!=null)return fv(o,n.faces,a);throw{message:"jsPlumb: unknown anchor type '"+o+"'"}}function io(o,a,n){return{type:o,locations:a,currentLocation:0,locked:!1,id:Ke(),isFloating:!1,isContinuous:!1,isDynamic:a.length>1,timestamp:null,cssClass:n.cssClass||""}}function cv(o,a,n){return new qh(o,a,n)}var dv="currentFace";function fv(o,a,n){var i={type:o,locations:[],currentLocation:0,locked:!1,id:Ke(),cssClass:n.cssClass||"",isFloating:!1,isContinuous:!0,timestamp:null,faces:n.faces||a,lockedFace:null,lockedAxis:null,clockwise:n.clockwise!==!1,__currentFace:null};return Object.defineProperty(i,dv,{get:function(){return this.__currentFace},set:function(t){this.__currentFace=rv(this,t)}}),i}function Fs(o){return o.length<7&&o.every(zo)||o.length===7&&o.slice(0,5).every(zo)&&Be(o[6])}function jr(o){if(Be(o))return Rs(o,null);if(Array.isArray(o))if(Fs(o)){var a=o;return io(null,[{x:a[0],y:a[1],ox:a[2],oy:a[3],offx:a[4]==null?0:a[4],offy:a[5]==null?0:a[5],iox:a[2],ioy:a[3],cls:a[6]||""}],{cssClass:a[6]||""})}else{var n=Xl(o,function(e){if(Be(e)){var t=Tu[e];return t!=null?W({iox:t[0].ox,ioy:t[0].oy,cls:""},t[0]):null}else if(Fs(e))return{x:e[0],y:e[1],ox:e[2],oy:e[3],offx:e[4]==null?0:e[4],offy:e[5]==null?0:e[5],iox:e[2],ioy:e[3],cls:e[6]||""}}).filter(function(e){return e!=null});return io("Dynamic",n,{})}else{var i=o;return Rs(i.type,i.options)}}function Ou(o){for(var a=.5,n=Math.PI*2/o,i=[],e=0,t=0;t<o;t++){var r=a+a*Math.sin(e),s=a+a*Math.cos(e);i.push({x:r,y:s,ox:0,oy:0,offx:0,offy:0,iox:0,ioy:0,cls:""}),e+=n}return i}function hv(o,a){for(var n=a/o.length,i=[],e=function(s,l,u,c,d,f,v){n=a*d;for(var p=(u-s)/n,y=(c-l)/n,g=0;g<n;g++)i.push({x:s+p*g,y:l+y*g,ox:f??0,oy:v??0,offx:0,offy:0,iox:0,ioy:0,cls:""})},t=0;t<o.length;t++)e.apply(null,o[t]);return i}function Ha(o,a){for(var n=[],i=0;i<o.length;i++)n.push([o[i][0],o[i][1],o[i][2],o[i][3],1/o.length,o[i][4],o[i][5]]);return hv(n,a)}function Au(o){return Ha([[0,0,1,0,0,-1],[1,0,1,1,1,0],[1,1,0,1,0,1],[0,1,0,0,-1,0]],o)}function vv(o){return Ha([[.5,0,1,.5],[1,.5,.5,1],[.5,1,0,.5],[0,.5,.5,0]],o)}function pv(o){return Ha([[.5,0,1,1],[1,1,0,1],[0,1,.5,0]],o)}function gv(o,a){for(var n=[],i=a/180*Math.PI,e=0;e<o.length;e++){var t=o[e].x-.5,r=o[e].y-.5;n.push({x:.5+(t*Math.cos(i)-r*Math.sin(i)),y:.5+(t*Math.sin(i)+r*Math.cos(i)),ox:o[e].ox,oy:o[e].oy,offx:0,offy:0,iox:0,ioy:0,cls:""})}return n}var dn=new Map;dn.set(cn.Circle,Ou);dn.set(cn.Ellipse,Ou);dn.set(cn.Rectangle,Au);dn.set(cn.Square,Au);dn.set(cn.Diamond,vv);dn.set(cn.Triangle,pv);function yv(o){o=o||{};var a=o.anchorCount||60,n=o.shape;if(!n)throw new Error("no shape supplied to Perimeter Anchor type");if(!dn.has(n))throw new Error("Shape ["+n+"] is unknown by Perimeter Anchor type");var i=dn.get(n)(a);o.rotation&&(i=gv(i,o.rotation));var e=io(Gt.Perimeter,i,o),t=W(e,{shape:n});return t}var Gs=function(){function o(a,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;$(this,o),this.selector=a,this.def=n,this.exclude=i,h(this,"id",void 0),h(this,"redrop",void 0),this.id=Ke(),this.redrop=n.def.redrop||Du}return J(o,[{key:"setEnabled",value:function(n){this.def.enabled=n}},{key:"isEnabled",value:function(){return this.def.enabled!==!1}}]),o}(),Du="strict",mv="any",Ev="anySource",bv="anyTarget",Sv="anySourceOrTarget";function Cv(o,a,n,i,e,t){var r=cv(t,i,e),s={paintStyle:o.getPaintStyle(),preparedAnchor:r,element:i,scope:o.scope,cssClass:[Ia,o.cssClass].join(" ")};a!=null&&($l(a,vr)?s.existingEndpoint=a:s.endpoint=a);var l=t._internal_newEndpoint(s);return t._paintEndpoint(l,{}),l}function xv(o,a,n,i,e){for(var t=o.target||o.srcElement,r=!1,s=i.getSelector(a,n),l=0;l<s.length;l++)if(s[l]===t){r=!0;break}return e?!r:r}var Pv=Mn(an,sn),js="sourceSelectorEndpoint",Bs=function(){function o(a){$(this,o),this.instance=a,h(this,"jpc",void 0),h(this,"existingJpc",void 0),h(this,"_originalAnchorSpec",void 0),h(this,"ep",void 0),h(this,"endpointRepresentation",void 0),h(this,"canvasElement",void 0),h(this,"_activeDefinition",void 0),h(this,"placeholderInfo",{id:null,element:null}),h(this,"floatingIndex",void 0),h(this,"floatingId",void 0),h(this,"floatingElement",void 0),h(this,"floatingEndpoint",void 0),h(this,"floatingAnchor",void 0),h(this,"_stopped",void 0),h(this,"inPlaceCopy",void 0),h(this,"endpointDropTargets",[]),h(this,"currentDropTarget",null),h(this,"payload",void 0),h(this,"floatingConnections",{}),h(this,"_forceReattach",void 0),h(this,"_forceDetach",void 0),h(this,"mousedownHandler",void 0),h(this,"mouseupHandler",void 0),h(this,"selector",Mn(rr));var n=a.getContainer();this.mousedownHandler=this._mousedownHandler.bind(this),this.mouseupHandler=this._mouseupHandler.bind(this),a.on(n,de,Ie,this.mousedownHandler),a.on(n,fe,[Ie,Mn(rr)].join(","),this.mouseupHandler)}return J(o,[{key:"_resolveDragParent",value:function(n,i){var e=this.instance.getContainer(),t=Vt(i,Ie,e,!0);if(n.parentSelector!=null){var r=Vt(i,n.parentSelector,e,!0);return r!=null&&(t=Vt(r.parentNode,Ie,e,!1)),r||t}else return t}},{key:"_mousedownHandler",value:function(n){var i,e;if(!(n.which===3||n.button===2)){var t=n.target||n.srcElement;if(e=this._getSourceDefinition(n),!(e!=null&&(i=this._resolveDragParent(e.def.def,t),i==null||i.getAttribute(xi)===er))&&e){var r=n.currentTarget,s;if(t.getAttribute(xi)!==er){if(Jr(n),this._activeDefinition=e,s=e.def.def,s.canAcceptNewConnection!=null&&!s.canAcceptNewConnection(i,n))return!1;var l=nl(n,i,this.instance.currentZoom),u={element:i};if(W(u,s),u.isTemporarySource=!0,s.scope)u.scope=s.scope;else{var c=t.getAttribute(ko);c!=null&&(u.scope=c)}var d=s.parameterExtractor?s.parameterExtractor(i,t,n):{};if(u=zi(u,d),u.maxConnections!=null&&u.maxConnections>=0){var f=this.instance.select({source:i}).length;if(f>=u.maxConnections)return Jr(n),s.onMaxConnections&&s.onMaxConnections({element:i,maxConnections:u.maxConnections},n),n.stopImmediatePropagation&&n.stopImmediatePropagation(),!1}if(s.anchorPositionFinder){var v=s.anchorPositionFinder(i,l,s,n);v!=null&&(u.anchor=v)}this._originalAnchorSpec=u.anchor||(this.instance.areDefaultAnchorsSet()?this.instance.defaults.anchors[0]:this.instance.defaults.anchor);var p=this.instance.router.prepareAnchor(this._originalAnchorSpec),y=[l.x,l.y,0,0];if(p.locations.length>0)y[2]=p.locations[0].ox,y[3]=p.locations[0].oy;else if(p.isContinuous){var g=l.x<.5?l.x:1-l.x,E=l.y<.5?l.y:1-l.y;y[2]=g<E?l.x<.5?-1:1:0,y[3]=E<g?l.y<.5?-1:1:0}u.anchor=y,u.deleteOnEmpty=!0,this.ep=this.instance._internal_newEndpoint(u);var b={};if(s.extract){for(var S in s.extract){var C=t.getAttribute(S);C&&(b[s.extract[S]]=C)}this.ep.mergeParameters(b)}if(u.uniqueEndpoint){var x=this.ep.elementId,T=this.instance.getManagedData(x,js,e.id);T==null?(this.instance.setManagedData(x,js,e.id,this.ep),this.ep.deleteOnEmpty=!1):this.ep.finalEndpoint=T}r._jsPlumbOrphanedEndpoints=r._jsPlumbOrphanedEndpoints||[],r._jsPlumbOrphanedEndpoints.push(this.ep),this.instance.trigger(this.ep.endpoint.canvas,de,n,b)}}}}},{key:"_mouseupHandler",value:function(n){var i=n.currentTarget||n.srcElement;i._jsPlumbOrphanedEndpoints&&(_d(i._jsPlumbOrphanedEndpoints,this.instance._maybePruneEndpoint.bind(this.instance)),i._jsPlumbOrphanedEndpoints.length=0),this._activeDefinition=null}},{key:"onDragInit",value:function(n){var i=Si(n,this.instance),e=Or(n,this.instance);return this._makeDraggablePlaceholder(i,e),this.placeholderInfo.element.jtk=n.jtk,this.placeholderInfo.element}},{key:"onDragAbort",value:function(n){this._cleanupDraggablePlaceholder()}},{key:"_makeDraggablePlaceholder",value:function(n,i){this.placeholderInfo=this.placeholderInfo||{};var e=Kl(du,{position:"absolute"});this.instance._appendElementToContainer(e);var t=this.instance.getId(e);return this.instance.setPosition(e,n),e.style.width=i.w+"px",e.style.height=i.h+"px",this.instance.manage(e),this.placeholderInfo.id=t,this.placeholderInfo.element=e,e}},{key:"_cleanupDraggablePlaceholder",value:function(){this.placeholderInfo.element&&(this.instance.unmanage(this.placeholderInfo.element,!0),delete this.placeholderInfo.element,delete this.placeholderInfo.id)}},{key:"reset",value:function(){var n=this.instance.getContainer();this.instance.off(n,fe,this.mouseupHandler),this.instance.off(n,de,this.mousedownHandler)}},{key:"init",value:function(n){}},{key:"startNewConnectionDrag",value:function(n,i){this.jpc=this.instance._newConnection({sourceEndpoint:this.ep,targetEndpoint:this.floatingEndpoint,source:this.ep.element,target:this.placeholderInfo.element,paintStyle:this.ep.connectorStyle,hoverPaintStyle:this.ep.connectorHoverStyle,connector:this.ep.connector,overlays:this.ep.connectorOverlays,type:this.ep.edgeType,cssClass:this.ep.connectorClass,hoverClass:this.ep.connectorHoverClass,scope:n,data:i}),this.jpc.pending=!0,this.jpc.addClass(this.instance.draggingClass),this.ep.addClass(this.instance.draggingClass),this.instance.fire(bs,this.jpc)}},{key:"startExistingConnectionDrag",value:function(){this.existingJpc=!0,this.instance.setHover(this.jpc,!1);var n=this.jpc.endpoints[0].id===this.ep.id?0:1;this.ep.detachFromConnection(this.jpc,null,!0),this.floatingEndpoint.addConnection(this.jpc),this.instance.fire(bs,this.jpc),this.instance.sourceOrTargetChanged(this.jpc.endpoints[n].elementId,this.placeholderInfo.id,this.jpc,this.placeholderInfo.element,n),this.jpc.suspendedEndpoint=this.jpc.endpoints[n],this.jpc.suspendedElement=this.jpc.endpoints[n].element,this.jpc.suspendedElementId=this.jpc.endpoints[n].elementId,this.jpc.suspendedElementType=n===0?Qo:Zl,this.instance.setHover(this.jpc.suspendedEndpoint,!1),this.floatingEndpoint.referenceEndpoint=this.jpc.suspendedEndpoint,this.floatingEndpoint.mergeParameters(this.jpc.suspendedEndpoint.parameters),this.jpc.endpoints[n]=this.floatingEndpoint,this.jpc.addClass(this.instance.draggingClass),this.floatingId=this.placeholderInfo.id,this.floatingIndex=n,this.instance._refreshEndpoint(this.ep)}},{key:"_shouldStartDrag",value:function(){var n=!0;this.ep.enabled||(n=!1),this.jpc==null&&!this.ep.isSource&&!this.ep.isTemporarySource&&(n=!1),this.ep.isSource&&this.ep.isFull()&&!(this.jpc!=null&&this.ep.dragAllowedWhenFull)&&(n=!1),this.jpc!=null&&!this.jpc.isDetachable(this.ep)&&(this.ep.isFull()?n=!1:this.jpc=null);var i={},e=this.instance.checkCondition(this.jpc==null?uf:cf,{endpoint:this.ep,source:this.ep.element,sourceId:this.ep.elementId,connection:this.jpc});return e===!1?n=!1:nr(e)==="object"?(i=e,W(i,this.payload||{})):i=this.payload||{},[n,i]}},{key:"_createFloatingEndpoint",value:function(n){var i=this.ep.endpoint;if(this.ep.edgeType!=null){var e=this.instance._deriveEndpointAndAnchorSpec(this.ep.edgeType);i=e.endpoints[1]}this.floatingEndpoint=Cv(this.ep,i,n,this.placeholderInfo.element,this.placeholderInfo.id,this.instance),this.floatingAnchor=this.floatingEndpoint._anchor,this.floatingEndpoint.deleteOnEmpty=!0,this.floatingElement=this.floatingEndpoint.endpoint.canvas,this.floatingId=this.instance.getId(this.floatingElement)}},{key:"_populateTargets",value:function(n,i){var e=this,t=this.jpc&&this.jpc.endpoints[0]===this.ep,r,s=this.instance.getContainer().querySelectorAll([".",rr,"[",Ql,this.ep.scope,"]:not(.",Ia,")"].join(""));if(K(s,function(d){if((e.jpc!=null||d!==n)&&d!==e.floatingElement&&(e.jpc!=null||!d.jtk.endpoint.isFull())&&(t&&d.jtk.endpoint.isSource||!t&&d.jtk.endpoint.isTarget)){var f=Si(d,e.instance),v=Or(d,e.instance);r={x:f.x,y:f.y,w:v.w,h:v.h},e.endpointDropTargets.push({el:d,targetEl:d,r,endpoint:d.jtk.endpoint,def:null}),e.instance.addClass(d,an)}}),t){var l=Ta(this.instance.sourceSelectors,function(d){return d.isEnabled()&&(d.def.def.scope==null||d.def.def.scope===e.ep.scope)});if(l!=null){var u=this._findTargetZones(l);K(u,function(d){if(d.getAttribute(xi)!==er){var f=d.getAttribute(ko);if(f!=null&&f!==e.ep.scope)return;var v={r:null,el:d};v.targetEl=Vt(d,Ie,e.instance.getContainer(),!0);var p=Si(v.el,e.instance),y=Or(v.el,e.instance);v.r={x:p.x,y:p.y,w:y.w,h:y.h},l.def.def.rank!=null&&(v.rank=l.def.def.rank),v.def=l.def,e.endpointDropTargets.push(v),e.instance.addClass(v.targetEl,an)}})}}else{var c=Dd(this.instance.targetSelectors,function(d){return d.isEnabled()});c.forEach(function(d){var f=e._findTargetZones(d);K(f,function(v){if(v.getAttribute(xi)!==er){var p=v.getAttribute(ko);if(p!=null&&p!==e.ep.scope)return;var y={r:null,el:v};if(d.def.def.parentSelector!=null&&(y.targetEl=Vt(v,d.def.def.parentSelector,e.instance.getContainer(),!0)),y.targetEl==null&&(y.targetEl=Vt(v,Ie,e.instance.getContainer(),!0)),(d.def.def.allowLoopback===!1||e._activeDefinition&&e._activeDefinition.def.def.allowLoopback===!1)&&y.targetEl===e.ep.element||d.def.def.canAcceptNewConnection!=null&&!d.def.def.canAcceptNewConnection(y.targetEl,i))return;var g=d.def.def.maxConnections;if(g!=null&&g!==-1&&e.instance.select({target:y.targetEl}).length>=g)return;var E=Si(v,e.instance),b=Or(v,e.instance);y.r={x:E.x,y:E.y,w:b.w,h:b.h},y.def=d.def,d.def.def.rank!=null&&(y.rank=d.def.def.rank),e.endpointDropTargets.push(y),e.instance.addClass(y.targetEl,an)}})})}this.endpointDropTargets.sort(function(d,f){if(d.targetEl._isJsPlumbGroup&&!f.targetEl._isJsPlumbGroup)return 1;if(!d.targetEl._isJsPlumbGroup&&f.targetEl._isJsPlumbGroup)return-1;if(d.targetEl._isJsPlumbGroup&&f.targetEl._isJsPlumbGroup){if(e.instance.groupManager.isAncestor(d.targetEl._jsPlumbGroup,f.targetEl._jsPlumbGroup))return-1;if(e.instance.groupManager.isAncestor(f.targetEl._jsPlumbGroup,d.targetEl._jsPlumbGroup))return 1}else if(d.rank!=null&&f.rank!=null){if(d.rank>f.rank)return-1;if(d.rank<f.rank)return 1}else return 0})}},{key:"_findTargetZones",value:function(n){var i;if(n.redrop===mv){var e=this.instance.targetSelectors.map(function(r){return r.selector});e.push.apply(e,ar(this.instance.sourceSelectors.map(function(r){return r.selector}))),e.push(Ie),i=e.join(",")}else if(n.redrop===Du)i=n.selector;else if(n.redrop===Ev)i=this.instance.sourceSelectors.map(function(r){return r.selector}).join(",");else if(n.redrop===bv)i=this.instance.targetSelectors.map(function(r){return r.selector}).join(",");else if(n.redrop===Sv){var t=this.instance.targetSelectors.map(function(r){return r.selector});t.push.apply(t,ar(this.instance.sourceSelectors.map(function(r){return r.selector}))),i=t.join(",")}return this.instance.getContainer().querySelectorAll(i)}},{key:"onStart",value:function(n){this.endpointDropTargets.length=0,this.currentDropTarget=null,this._stopped=!1;var i=n.drag.getDragElement();if(this.ep=i.jtk.endpoint,!this.ep)return!1;this.endpointRepresentation=this.ep.endpoint,this.canvasElement=this.endpointRepresentation.canvas,this.jpc=this.ep.connectorSelector();var e=this._shouldStartDrag(),t=Ri(e,2),r=t[0],s=t[1];if(r===!1)return this._stopped=!0,!1;this.instance.setHover(this.ep,!1),this.instance.isConnectionBeingDragged=!0,this.jpc&&!this.ep.isFull()&&this.ep.isSource&&(this.jpc=null),this._createFloatingEndpoint(this.canvasElement),this._populateTargets(this.canvasElement,n.e),this.jpc==null?this.startNewConnectionDrag(this.ep.scope,s):this.startExistingConnectionDrag(),this._registerFloatingConnection(this.placeholderInfo,this.jpc),this.instance.currentlyDragging=!0}},{key:"onBeforeStart",value:function(n){this.payload=n.e.payload||{}}},{key:"onDrag",value:function(n){if(this._stopped)return!0;if(this.placeholderInfo.element){var i=Or(this.floatingElement,this.instance);this.instance.setElementPosition(this.placeholderInfo.element,n.pos.x,n.pos.y);for(var e={x:n.pos.x,y:n.pos.y,w:i.w,h:i.h},t,r,s,l=0;l<this.endpointDropTargets.length;l++)if(yu(e,this.endpointDropTargets[l].r)){t=this.endpointDropTargets[l];break}if(t!==this.currentDropTarget&&this.currentDropTarget!=null&&(r=this._getFloatingAnchorIndex(),this.instance.removeClass(this.currentDropTarget.el,sn),this.currentDropTarget.endpoint&&(this.currentDropTarget.endpoint.endpoint.removeClass(this.instance.endpointDropAllowedClass),this.currentDropTarget.endpoint.endpoint.removeClass(this.instance.endpointDropForbiddenClass)),this.floatingAnchor.out()),t!=null&&(this.instance.addClass(t.el,sn),r=this._getFloatingAnchorIndex(),t.endpoint!=null))if(s=t.endpoint.isSource&&r===0||t.endpoint.isTarget&&r!==0||this.jpc.suspendedEndpoint&&t.endpoint.referenceEndpoint&&t.endpoint.referenceEndpoint.id===this.jpc.suspendedEndpoint.id,s){var u=this.instance.checkCondition(Hd,{sourceEndpoint:this.jpc.endpoints[r],targetEndpoint:t.endpoint.endpoint,connection:this.jpc});u?(t.endpoint.endpoint.addClass(this.instance.endpointDropAllowedClass),t.endpoint.endpoint.removeClass(this.instance.endpointDropForbiddenClass)):(t.endpoint.endpoint.removeClass(this.instance.endpointDropAllowedClass),t.endpoint.endpoint.addClass(this.instance.endpointDropForbiddenClass)),this.floatingAnchor.over(t.endpoint),this.instance._paintConnection(this.jpc)}else t=null;this.currentDropTarget=t}}},{key:"_maybeCleanup",value:function(n){n._mtNew&&n.connections.length===0?this.instance.deleteEndpoint(n):delete n._mtNew}},{key:"_reattachOrDiscard",value:function(n){var i=this.jpc.suspendedEndpoint!=null,e=this._getFloatingAnchorIndex();return i&&this._shouldReattach()?(e===0?(this.jpc.source=this.jpc.suspendedElement,this.jpc.sourceId=this.jpc.suspendedElementId):(this.jpc.target=this.jpc.suspendedElement,this.jpc.targetId=this.jpc.suspendedElementId),this._doForceReattach(e),!0):(this._discard(e,n),!1)}},{key:"onStop",value:function(n){var i=this,e=n.e;this.instance.isConnectionBeingDragged=!1,this.instance.currentlyDragging=!1;var t=Bd(sn,an),r=this.instance.getContainer().querySelectorAll(Pv);if(K(r,function(f){i.instance.removeClass(f,t)}),this.jpc&&this.jpc.endpoints!=null){var s=this.jpc.suspendedEndpoint!=null,l=this._getFloatingAnchorIndex(),u=this.jpc.suspendedEndpoint,c;if(this.currentDropTarget!=null)if(c=this._getDropEndpoint(n,this.jpc),c==null)this._reattachOrDiscard(n.e);else if(u&&u.id===c.id)this._doForceReattach(l);else if(!c.enabled)this._reattachOrDiscard(n.e);else if(c.isFull())c.fire(iu,{endpoint:this,connection:this.jpc,maxConnections:this.instance.defaults.maxConnections},e),this._reattachOrDiscard(n.e);else{l===0?(this.jpc.source=c.element,this.jpc.sourceId=c.elementId):(this.jpc.target=c.element,this.jpc.targetId=c.elementId);var d=!0;s&&this.jpc.suspendedEndpoint.id!==c.id&&(!this.jpc.isDetachAllowed(this.jpc)||!this.jpc.endpoints[l].isDetachAllowed(this.jpc)||!this.jpc.suspendedEndpoint.isDetachAllowed(this.jpc)||!this.instance.checkCondition("beforeDetach",this.jpc))&&(d=!1),d=d&&c.isDropAllowed(this.jpc.sourceId,this.jpc.targetId,this.jpc.scope,this.jpc,c),d?this._drop(c,l,e,d):this._reattachOrDiscard(n.e)}else this._reattachOrDiscard(n.e);this.instance._refreshEndpoint(this.ep),this.ep.removeClass(this.instance.draggingClass),this._cleanupDraggablePlaceholder(),this.jpc.removeClass(this.instance.draggingClass),delete this.jpc.suspendedEndpoint,delete this.jpc.suspendedElement,delete this.jpc.suspendedElementType,delete this.jpc.suspendedElementId,delete this.jpc.suspendedIndex,delete this.floatingId,delete this.floatingIndex,delete this.floatingElement,delete this.floatingEndpoint,delete this.floatingAnchor,delete this.jpc.pending,c!=null&&this._maybeCleanup(c)}}},{key:"_getSourceDefinition",value:function(n){for(var i,e=this.instance.getContainer(),t=0;t<this.instance.sourceSelectors.length;t++)if(i=this.instance.sourceSelectors[t],i.isEnabled()){var r=xv(n,e,i.selector,this.instance,i.exclude);if(r!==!1)return i}}},{key:"_getDropEndpoint",value:function(n,i){var e;if(this.currentDropTarget.endpoint==null){var t=this.currentDropTarget.def,r=n.e.target||n.e.srcElement;if(t==null)return null;var s=this.currentDropTarget.targetEl,l=nl(n.e,s,this.instance.currentZoom),u=this.instance._deriveEndpointAndAnchorSpec(i.getType().join(" "),!0),c=u.endpoints?W(n,{endpoint:t.def.endpoint||u.endpoints[1],cssClass:t.def.cssClass||"",source:t.def.source===!0,target:t.def.target===!0}):n,d=this.instance.validAnchorsSpec(u.anchors)?u.anchors:this.instance.areDefaultAnchorsSet()?this.instance.defaults.anchors:null,f=t.def.anchor,v=t.def.anchorPositionFinder?t.def.anchorPositionFinder(s,l,t.def,n.e):null,p=v??f??(d!=null&&d[1]!=null?d[1]:null);p!=null&&(c=W(c,{anchor:p})),t.def.portId!=null&&(c.portId=t.def.portId);var y=t.def.parameterExtractor?t.def.parameterExtractor(this.currentDropTarget.el,r,n.e):{};if(c=zi(c,y),c.element=s,e=this.instance._internal_newEndpoint(c),e._mtNew=!0,e.deleteOnEmpty=!0,t.def.parameters&&e.mergeParameters(t.def.parameters),t.def.extract){var g={};for(var E in t.def.extract){var b=this.currentDropTarget.el.getAttribute(E);b&&(g[t.def.extract[E]]=b)}e.mergeParameters(g)}}else e=this.currentDropTarget.endpoint;return e&&(e.removeClass(this.instance.endpointDropAllowedClass),e.removeClass(this.instance.endpointDropForbiddenClass)),e}},{key:"_doForceReattach",value:function(n){this.floatingEndpoint.detachFromConnection(this.jpc,null,!0),this.jpc.endpoints[n]=this.jpc.suspendedEndpoint,this.instance.setHover(this.jpc,!1),this.jpc._forceDetach=!0,this.jpc.suspendedEndpoint.addConnection(this.jpc),this.instance.sourceOrTargetChanged(this.floatingId,this.jpc.suspendedEndpoint.elementId,this.jpc,this.jpc.suspendedEndpoint.element,n),this.instance.deleteEndpoint(this.floatingEndpoint),this.instance.repaint(this.jpc.source),delete this.jpc._forceDetach}},{key:"_shouldReattach",value:function(){if(this.jpc.isReattach()||this.jpc._forceReattach)return!0;var n=this.jpc.suspendedEndpoint,i=this.jpc.suspendedElementType==Qo?1:0,e=this.jpc.endpoints[i];return!Vl(!0,!1,[[n,ir,[this.jpc]],[e,ir,[this.jpc]],[this.jpc,ir,[this.jpc]],[this.instance,ql,[lu,this.jpc]]])}},{key:"_discard",value:function(n,i){this.jpc.pending?this.instance.fire(Df,this.jpc,i):(n===0?(this.jpc.source=this.jpc.suspendedEndpoint.element,this.jpc.sourceId=this.jpc.suspendedEndpoint.elementId):(this.jpc.target=this.jpc.suspendedEndpoint.element,this.jpc.targetId=this.jpc.suspendedEndpoint.elementId),this.jpc.endpoints[n]=this.jpc.suspendedEndpoint),this.floatingEndpoint&&this.floatingEndpoint.detachFromConnection(this.jpc),this.instance.deleteConnection(this.jpc,{originalEvent:i,force:!0})}},{key:"_drop",value:function(n,i,e,t){if(this.jpc.endpoints[i].detachFromConnection(this.jpc),this.jpc.suspendedEndpoint&&this.jpc.suspendedEndpoint.detachFromConnection(this.jpc),this.jpc.endpoints[i]=n,n.addConnection(this.jpc),this.jpc.suspendedEndpoint){var r=this.jpc.suspendedEndpoint.elementId;this.instance.fireMoveEvent({index:i,originalSourceId:i===0?r:this.jpc.sourceId,newSourceId:i===0?n.elementId:this.jpc.sourceId,originalTargetId:i===1?r:this.jpc.targetId,newTargetId:i===1?n.elementId:this.jpc.targetId,originalEndpoint:this.jpc.suspendedEndpoint,connection:this.jpc,newEndpoint:n},e)}if(i===1?this.instance.sourceOrTargetChanged(this.floatingId,this.jpc.targetId,this.jpc,this.jpc.target,1):this.instance.sourceOrTargetChanged(this.floatingId,this.jpc.sourceId,this.jpc,this.jpc.source,0),this.jpc.endpoints[0].finalEndpoint){var s=this.jpc.endpoints[0];s.detachFromConnection(this.jpc),this.jpc.endpoints[0]=this.jpc.endpoints[0].finalEndpoint,this.jpc.endpoints[0].addConnection(this.jpc)}sr(t)&&this.jpc.mergeData(t),this._originalAnchorSpec&&(this.jpc.endpoints[0].setAnchor(this._originalAnchorSpec),this._originalAnchorSpec=null),this.instance._finaliseConnection(this.jpc,null,e),this.instance.setHover(this.jpc,!1),this.instance.revalidate(this.jpc.endpoints[0].element)}},{key:"_registerFloatingConnection",value:function(n,i){this.floatingConnections[n.id]=i}},{key:"_getFloatingAnchorIndex",value:function(){return this.floatingIndex==null?1:this.floatingIndex}}]),o}(),Us=function(o){Ee(n,o);var a=be(n);function n(i,e){var t;return $(this,n),t=a.call(this,i,e),t.instance=i,t.dragSelection=e,h(m(t),"selector",[">",Jf,Ie].join(" ")),h(m(t),"doRevalidate",void 0),t.doRevalidate=t._revalidate.bind(m(t)),t}return J(n,[{key:"reset",value:function(){this.drag.off(Qi,this.doRevalidate)}},{key:"_revalidate",value:function(e){this.instance.revalidate(e)}},{key:"init",value:function(e){this.drag=e,e.on(Qi,this.doRevalidate)}},{key:"useGhostProxy",value:function(e,t){var r=t._jsPlumbParentGroup;return r==null?!1:r.ghost===!0}},{key:"makeGhostProxy",value:function(e){var t=e,r=t.cloneNode(!0);return r._jsPlumbParentGroup=t._jsPlumbParentGroup,r}}]),n}(ia),Ya=function(){function o(a,n){$(this,o),this.instance=a,this.overlay=n,h(this,"htmlElementOverlay",void 0),this.htmlElementOverlay=n}return J(o,null,[{key:"getElement",value:function(n,i,e){if(n.canvas==null){if(e&&i){n.canvas=e(i);var t=n.instance.overlayClass+" "+(n.cssClass?n.cssClass:"");n.instance.addClass(n.canvas,t)}else n.canvas=Kl(du,{},n.instance.overlayClass+" "+(n.cssClass?n.cssClass:""));n.instance.setAttribute(n.canvas,"jtk-overlay-id",n.id);for(var r in n.attributes)n.instance.setAttribute(n.canvas,r,n.attributes[r]);n.canvas.style.position=qr,n.instance._appendElement(n.canvas,n.instance.getContainer()),n.instance.getId(n.canvas);var s="translate(-50%, -50%)";n.canvas.style.webkitTransform=s,n.canvas.style.mozTransform=s,n.canvas.style.msTransform=s,n.canvas.style.oTransform=s,n.canvas.style.transform=s,n.isVisible()||(n.canvas.style.display=lr),n.canvas.jtk={overlay:n}}return n.canvas}},{key:"destroy",value:function(n){n.canvas&&n.canvas.parentNode&&n.canvas.parentNode.removeChild(n.canvas),delete n.canvas,delete n.cachedDimensions}},{key:"_getDimensions",value:function(n,i){return(n.cachedDimensions==null||i)&&(n.cachedDimensions={w:1,h:1}),n.cachedDimensions}}]),o}(),si=function(){function o(){$(this,o),h(this,"_listeners",{}),h(this,"eventsSuspended",!1),h(this,"tick",!1),h(this,"eventsToDieOn",{ready:!0}),h(this,"queue",[])}return J(o,[{key:"fire",value:function(n,i,e){var t=null;if(this.tick)this.queue.unshift(arguments);else{if(this.tick=!0,!this.eventsSuspended&&this._listeners[n]){var r=this._listeners[n].length,s=0,l=!1;if(!this.shouldFireEvent||this.shouldFireEvent(n,i,e))for(;!l&&s<r&&t!==!1;){if(this.eventsToDieOn[n])this._listeners[n][s](i,e);else try{t=this._listeners[n][s](i,e)}catch(u){We("jsPlumb: fire failed for event "+n+" : "+(u.message||u))}s++,(this._listeners==null||this._listeners[n]==null)&&(l=!0)}}this.tick=!1,this._drain()}return t}},{key:"_drain",value:function(){var n=this.queue.pop();n&&this.fire.apply(this,n)}},{key:"unbind",value:function(n,i){if(arguments.length===0)this._listeners={};else if(arguments.length===1){if(typeof n=="string")delete this._listeners[n];else if(n.__jsPlumb){var e;for(var t in n.__jsPlumb)e=n.__jsPlumb[t],hs(this._listeners[e]||[],n)}}else arguments.length===2&&hs(this._listeners[n]||[],i);return this}},{key:"getListener",value:function(n){return this._listeners[n]||[]}},{key:"isSuspendEvents",value:function(){return this.eventsSuspended}},{key:"setSuspendEvents",value:function(n){this.eventsSuspended=n}},{key:"bind",value:function(n,i,e){var t=this,r=function(u){Yl(t._listeners,u,i,e),i.__jsPlumb=i.__jsPlumb||{},i.__jsPlumb[Ke()]=u};if(typeof n=="string")r(n);else if(n.length!=null)for(var s=0;s<n.length;s++)r(n[s]);return this}},{key:"silently",value:function(n){this.setSuspendEvents(!0);try{n()}catch(i){We("Cannot execute silent function "+i)}this.setSuspendEvents(!1)}}]),o}();(function(o){Ee(n,o);var a=be(n);function n(){return $(this,n),a.apply(this,arguments)}return J(n,[{key:"shouldFireEvent",value:function(e,t,r){return!0}}]),n})(si);function oa(o){var a=null;return Be(o)?a={type:o,options:{}}:a=o,a.options.id=a.options.id||Ke(),a}var go=function(o){Ee(n,o);var a=be(n);function n(i,e,t){var r;$(this,n),r=a.call(this),r.instance=i,r.component=e,h(m(r),"id",void 0),h(m(r),"type",void 0),h(m(r),"cssClass",void 0),h(m(r),"visible",!0),h(m(r),"location",void 0),h(m(r),"events",void 0),h(m(r),"attributes",void 0),t=t||{},r.id=t.id||Ke(),r.cssClass=t.cssClass||"",r.setLocation(t.location),r.events=t.events||{},r.attributes=t.attributes||{};for(var s in r.events)r.bind(s,r.events[s]);return r}return J(n,[{key:"setLocation",value:function(e){var t=this.location==null?.5:this.location;if(e!=null)try{var r=typeof e=="string"?parseFloat(e):e;isNaN(r)||(t=r)}catch{}this.location=t}},{key:"shouldFireEvent",value:function(e,t,r){return!0}},{key:"setVisible",value:function(e){this.visible=e,this.instance.setOverlayVisible(this,e)}},{key:"isVisible",value:function(){return this.visible}}]),n}(si),Vs={},kn={get:function(a,n,i,e){var t=Vs[n];if(t)return new t(a,i,e);throw{message:"jsPlumb: unknown overlay type '"+n+"'"}},register:function(a,n){Vs[a]=n}},Ln=function(o){Ee(n,o);var a=be(n);function n(i,e,t){var r;return $(this,n),r=a.call(this,i,e,t),r.instance=i,r.component=e,h(m(r),"label",void 0),h(m(r),"labelText",void 0),h(m(r),"type",n.type),h(m(r),"cachedDimensions",void 0),t=t||{label:""},r.setLabel(t.label),r}return J(n,[{key:"getLabel",value:function(){return In(this.label)?this.label(this):this.labelText}},{key:"setLabel",value:function(e){this.label=e,this.labelText=null,this.instance.updateLabel(this)}},{key:"getDimensions",value:function(){return{w:1,h:1}}},{key:"updateFrom",value:function(e){e.label!=null&&this.setLabel(e.label),e.location!=null&&(this.setLocation(e.location),this.instance.updateLabel(this))}}]),n}(go);h(Ln,"type","Label");function Jt(o){return o.type===Ln.type}kn.register(Ln.type,Ln);function Pi(o){return o==null?null:o.split(" ").filter(function(a){return a!=null&&a.length>0})}function Hs(o,a,n){for(var i in a)o[i]=n}var Tv="connector",Ov="override",Av="cssClass",Ys="__default",Dv="anchor",Iv="anchors",Br="__label",_v="jtk-default-label",Iu="overlay",wv="labelLocation",Xs="add",$s="remove";function $n(o,a){if(o.getDefaultType){var n=o.getTypeDescriptor(),i={},e=o.getDefaultType(),t=W({},e);Hs(i,e,Ys),o._types.forEach(function(r){if(r!==Ys){var s=o.instance.getType(r,n);if(s!=null){var l=new Set([Tv,Dv,Iv]);if(s.mergeStrategy===Ov)for(var u in s)l.add(u);t=zi(t,s,[Av],Id(l)),Hs(i,s,r)}}}),a&&(t=Od(t,a,"_")),o.applyType(t,i)}}function Fo(o,a){var n=o.instance.getType(a,o.getTypeDescriptor());n!=null&&n.cssClass&&o.removeClass(n.cssClass)}function Ws(o){if(o.paintStyle&&o.hoverPaintStyle){var a={};W(a,o.paintStyle),W(a,o.hoverPaintStyle),o.hoverPaintStyle=a}}function Mv(o,a){var n={cssClass:a.cssClass,id:Br,component:o},i=W(n,a);return new Ln(o.instance,o,i)}function kv(o,a){var n=null;if(Be(a))n=kn.get(o.instance,a,o,{});else if(a.type!=null&&a.options!=null){var i=a,e=W({},i.options);n=kn.get(o.instance,i.type,o,e)}else n=a;return n.id=n.id||Ke(),o.cacheTypeItem(Iu,n,n.id),o.overlays[n.id]=n,n}var _u=function(o){Ee(n,o);var a=be(n);function n(i,e){var t;if($(this,n),t=a.call(this),t.instance=i,h(m(t),"defaultLabelLocation",.5),h(m(t),"overlays",{}),h(m(t),"overlayPositions",{}),h(m(t),"overlayPlacements",{}),h(m(t),"clone",void 0),h(m(t),"deleted",void 0),h(m(t),"segment",void 0),h(m(t),"x",void 0),h(m(t),"y",void 0),h(m(t),"w",void 0),h(m(t),"h",void 0),h(m(t),"id",void 0),h(m(t),"visible",!0),h(m(t),"typeId",void 0),h(m(t),"params",{}),h(m(t),"paintStyle",void 0),h(m(t),"hoverPaintStyle",void 0),h(m(t),"paintStyleInUse",void 0),h(m(t),"_hover",!1),h(m(t),"lastPaintedAt",void 0),h(m(t),"data",void 0),h(m(t),"_defaultType",void 0),h(m(t),"events",void 0),h(m(t),"parameters",void 0),h(m(t),"_types",void 0),h(m(t),"_typeCache",void 0),h(m(t),"cssClass",void 0),h(m(t),"hoverClass",void 0),h(m(t),"beforeDetach",void 0),h(m(t),"beforeDrop",void 0),e=e||{},t.cssClass=e.cssClass||"",t.hoverClass=e.hoverClass||i.defaults.hoverClass,t.beforeDetach=e.beforeDetach,t.beforeDrop=e.beforeDrop,t._types=new Set,t._typeCache={},t.parameters=Ki(e.parameters||{}),t.id=e.id||t.getIdPrefix()+new Date().getTime(),t._defaultType={parameters:t.parameters,scope:e.scope||t.instance.defaultScope,overlays:{}},e.events)for(var r in e.events)t.bind(r,e.events[r]);t.clone=function(){var v=Object.create(t.constructor.prototype);return t.constructor.apply(v,[i,e]),v},t.overlays={},t.overlayPositions={};var s=e.overlays||[],l={},u=t.getDefaultOverlayKey();if(u){var c=t.instance.defaults[u];c&&s.push.apply(s,ar(c));for(var d=0;d<s.length;d++){var f=oa(s[d]);l[f.options.id]=f}}return t._defaultType.overlays=l,e.label&&(t.getDefaultType().overlays[Br]={type:Ln.type,options:{label:e.label,location:e.labelLocation||t.defaultLabelLocation,id:Br,cssClass:_v}}),t}return J(n,[{key:"isDetachAllowed",value:function(e){var t=!0;if(this.beforeDetach)try{t=this.beforeDetach(e)}catch(r){We("jsPlumb: beforeDetach callback failed",r)}return t}},{key:"isDropAllowed",value:function(e,t,r,s,l){var u,c={sourceId:e,targetId:t,scope:r,connection:s,dropEndpoint:l};if(this.beforeDrop)try{u=this.beforeDrop(c)}catch(d){We("jsPlumb: beforeDrop callback failed",d)}else u=this.instance.checkCondition(su,c);return u}},{key:"getDefaultType",value:function(){return this._defaultType}},{key:"appendToDefaultType",value:function(e){for(var t in e)this._defaultType[t]=e[t]}},{key:"getId",value:function(){return this.id}},{key:"cacheTypeItem",value:function(e,t,r){this._typeCache[r]=this._typeCache[r]||{},this._typeCache[r][e]=t}},{key:"getCachedTypeItem",value:function(e,t){return this._typeCache[t]?this._typeCache[t][e]:null}},{key:"setType",value:function(e,t){this.clearTypes(),(Pi(e)||[]).forEach(this._types.add,this._types),$n(this,t)}},{key:"getType",value:function(){return Array.from(this._types.keys())}},{key:"reapplyTypes",value:function(e){$n(this,e)}},{key:"hasType",value:function(e){return this._types.has(e)}},{key:"addType",value:function(e,t){var r=Pi(e),s=!1;if(r!=null){for(var l=0,u=r.length;l<u;l++)this._types.has(r[l])||(this._types.add(r[l]),s=!0);s&&$n(this,t)}}},{key:"removeType",value:function(e,t){var r=this,s=Pi(e),l=!1,u=function(v){return r._types.has(v)?(Fo(r,v),r._types.delete(v),!0):!1};if(s!=null){for(var c=0,d=s.length;c<d;c++)l=u(s[c])||l;l&&$n(this,t)}}},{key:"clearTypes",value:function(e){var t=this;this._types.forEach(function(r){Fo(t,r)}),this._types.clear(),$n(this,e)}},{key:"toggleType",value:function(e,t){var r=Pi(e);if(r!=null){for(var s=0,l=r.length;s<l;s++)this._types.has(r[s])?(Fo(this,r[s]),this._types.delete(r[s])):this._types.add(r[s]);$n(this,t)}}},{key:"applyType",value:function(e,t){if(this.setPaintStyle(e.paintStyle),this.setHoverPaintStyle(e.hoverPaintStyle),this.mergeParameters(e.parameters),this.paintStyleInUse=this.getPaintStyle(),e.overlays){var r={},s;for(s in e.overlays){var l=this.overlays[e.overlays[s].options.id];if(l)l.updateFrom(e.overlays[s].options),r[e.overlays[s].options.id]=!0,this.instance.reattachOverlay(l,this);else{var u=this.getCachedTypeItem(Iu,e.overlays[s].options.id);u!=null?(this.instance.reattachOverlay(u,this),u.setVisible(!0),u.updateFrom(e.overlays[s].options),this.overlays[u.id]=u):u=this.addOverlay(e.overlays[s]),r[u.id]=!0}}for(s in this.overlays)r[this.overlays[s].id]==null&&this.removeOverlay(this.overlays[s].id,!0)}}},{key:"setPaintStyle",value:function(e){this.paintStyle=e,this.paintStyleInUse=this.paintStyle,Ws(this)}},{key:"getPaintStyle",value:function(){return this.paintStyle}},{key:"setHoverPaintStyle",value:function(e){this.hoverPaintStyle=e,Ws(this)}},{key:"getHoverPaintStyle",value:function(){return this.hoverPaintStyle}},{key:"destroy",value:function(){for(var e in this.overlays)this.instance.destroyOverlay(this.overlays[e]);this.overlays={},this.overlayPositions={},this.unbind(),this.clone=null}},{key:"isHover",value:function(){return this._hover}},{key:"mergeParameters",value:function(e){e!=null&&W(this.parameters,e)}},{key:"setVisible",value:function(e){this.visible=e,e?this.showOverlays():this.hideOverlays()}},{key:"isVisible",value:function(){return this.visible}},{key:"setAbsoluteOverlayPosition",value:function(e,t){this.overlayPositions[e.id]=t}},{key:"getAbsoluteOverlayPosition",value:function(e){return this.overlayPositions?this.overlayPositions[e.id]:null}},{key:"_clazzManip",value:function(e,t){for(var r in this.overlays)e===Xs?this.instance.addOverlayClass(this.overlays[r],t):e===$s&&this.instance.removeOverlayClass(this.overlays[r],t)}},{key:"addClass",value:function(e,t){var r=(this.cssClass||"").split(" ");r.push(e),this.cssClass=r.join(" "),this._clazzManip(Xs,e)}},{key:"removeClass",value:function(e,t){var r=(this.cssClass||"").split(" ");this.cssClass=r.filter(function(s){return s!==e}).join(" "),this._clazzManip($s,e)}},{key:"getClass",value:function(){return this.cssClass}},{key:"shouldFireEvent",value:function(e,t,r){return!0}},{key:"getData",value:function(){return this.data}},{key:"setData",value:function(e){this.data=e||{}}},{key:"mergeData",value:function(e){this.data=W(this.data,e)}},{key:"addOverlay",value:function(e){var t=kv(this,e);if(this.getData&&t.type===Ln.type&&!Be(e)){var r=this.getData(),s=e.options;if(r){var l=s.labelLocationAttribute||wv,u=r[l];u&&(t.location=u)}}return t}},{key:"getOverlay",value:function(e){return this.overlays[e]}},{key:"getOverlays",value:function(){return this.overlays}},{key:"hideOverlay",value:function(e){var t=this.getOverlay(e);t&&t.setVisible(!1)}},{key:"hideOverlays",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];t=t||[];for(var s in this.overlays)(t.length===0||t.indexOf(s)!==-1)&&this.overlays[s].setVisible(!1)}},{key:"showOverlay",value:function(e){var t=this.getOverlay(e);t&&t.setVisible(!0)}},{key:"showOverlays",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];t=t||[];for(var s in this.overlays)(t.length===0||t.indexOf(s)!==-1)&&this.overlays[s].setVisible(!0)}},{key:"removeAllOverlays",value:function(){for(var e in this.overlays)this.instance.destroyOverlay(this.overlays[e]);this.overlays={},this.overlayPositions=null,this.overlayPlacements={}}},{key:"removeOverlay",value:function(e,t){var r=this.overlays[e];r&&(r.setVisible(!1),t||this.instance.destroyOverlay(r),delete this.overlays[e],this.overlayPositions&&delete this.overlayPositions[e],this.overlayPlacements&&delete this.overlayPlacements[e])}},{key:"removeOverlays",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(var s=0,l=t.length;s<l;s++)this.removeOverlay(arguments[s])}},{key:"getLabel",value:function(){var e=this.getLabelOverlay();return e!=null?e.getLabel():null}},{key:"getLabelOverlay",value:function(){return this.getOverlay(Br)}},{key:"setLabel",value:function(e){var t=this.getLabelOverlay();if(t)if(Be(e)||In(e))t.setLabel(e);else{var s=e;s.label&&t.setLabel(s.label),s.location&&(t.location=s.location)}else{var r=Be(e)||In(e)?{label:e}:e;t=Mv(this,r),this.overlays[Br]=t}}}]),n}(si),Lv=["connectorStyle","connectorHoverStyle","connectorOverlays","connector","connectionType","connectorClass","connectorHoverClass"],tr=function(o){Ee(n,o);var a=be(n);function n(i,e){var t;$(this,n),t=a.call(this,i,e),t.instance=i,h(m(t),"connections",[]),h(m(t),"endpoint",void 0),h(m(t),"element",void 0),h(m(t),"elementId",void 0),h(m(t),"dragAllowedWhenFull",!0),h(m(t),"timestamp",void 0),h(m(t),"portId",void 0),h(m(t),"maxConnections",void 0),h(m(t),"proxiedBy",void 0),h(m(t),"connectorClass",void 0),h(m(t),"connectorHoverClass",void 0),h(m(t),"finalEndpoint",void 0),h(m(t),"enabled",!0),h(m(t),"isSource",void 0),h(m(t),"isTarget",void 0),h(m(t),"isTemporarySource",void 0),h(m(t),"connectionCost",1),h(m(t),"connectionsDirected",void 0),h(m(t),"connectionsDetachable",void 0),h(m(t),"reattachConnections",void 0),h(m(t),"currentAnchorClass",void 0),h(m(t),"referenceEndpoint",void 0),h(m(t),"edgeType",void 0),h(m(t),"connector",void 0),h(m(t),"connectorOverlays",void 0),h(m(t),"connectorStyle",void 0),h(m(t),"connectorHoverStyle",void 0),h(m(t),"deleteOnEmpty",void 0),h(m(t),"uuid",void 0),h(m(t),"scope",void 0),h(m(t),"_anchor",void 0),h(m(t),"defaultLabelLocation",[.5,.5]),t.appendToDefaultType({edgeType:e.edgeType,maxConnections:e.maxConnections==null?t.instance.defaults.maxConnections:e.maxConnections,paintStyle:e.paintStyle||t.instance.defaults.endpointStyle,hoverPaintStyle:e.hoverPaintStyle||t.instance.defaults.endpointHoverStyle,connectorStyle:e.connectorStyle,connectorHoverStyle:e.connectorHoverStyle,connectorClass:e.connectorClass,connectorHoverClass:e.connectorHoverClass,connectorOverlays:e.connectorOverlays,connector:e.connector}),t.enabled=e.enabled!==!1,t.visible=!0,t.element=e.element,t.uuid=e.uuid,t.portId=e.portId,t.elementId=e.elementId,t.connectionCost=e.connectionCost==null?1:e.connectionCost,t.connectionsDirected=e.connectionsDirected,t.currentAnchorClass="",t.events={},t.connectorOverlays=e.connectorOverlays,t.connectorStyle=e.connectorStyle,t.connectorHoverStyle=e.connectorHoverStyle,t.connector=e.connector,t.edgeType=e.edgeType,t.connectorClass=e.connectorClass,t.connectorHoverClass=e.connectorHoverClass,t.deleteOnEmpty=e.deleteOnEmpty===!0,t.isSource=e.source||!1,t.isTemporarySource=e.isTemporarySource||!1,t.isTarget=e.target||!1,t.connections=e.connections||[],t.scope=e.scope||i.defaultScope,t.timestamp=null,t.reattachConnections=e.reattachConnections||i.defaults.reattachConnections,t.connectionsDetachable=i.defaults.connectionsDetachable,e.connectionsDetachable===!1&&(t.connectionsDetachable=!1),t.dragAllowedWhenFull=e.dragAllowedWhenFull!==!1,e.onMaxConnections&&t.bind(iu,e.onMaxConnections);var r=e.endpoint||e.existingEndpoint||i.defaults.endpoint;if(t.setEndpoint(r),e.preparedAnchor!=null)t.setPreparedAnchor(e.preparedAnchor);else{var s=e.anchor?e.anchor:e.anchors?e.anchors:i.defaults.anchor||Gt.Top;t.setAnchor(s)}var l=[eo,e.type||""].join(" ");return t.addType(l,e.data),t}return J(n,[{key:"getIdPrefix",value:function(){return"_jsplumb_e"}},{key:"getTypeDescriptor",value:function(){return"endpoint"}},{key:"getXY",value:function(){return{x:this.endpoint.x,y:this.endpoint.y}}},{key:"getDefaultOverlayKey",value:function(){return"endpointOverlays"}},{key:"_updateAnchorClass",value:function(){var e=this._anchor&&this._anchor.cssClass;if(e!=null&&e.length>0){var t=this.instance.endpointAnchorClassPrefix+"-"+this.currentAnchorClass;this.currentAnchorClass=e;var r=this.instance.endpointAnchorClassPrefix+(this.currentAnchorClass?"-"+this.currentAnchorClass:"");t!==r&&(this.removeClass(t),this.addClass(r),this.instance.removeClass(this.element,t),this.instance.addClass(this.element,r))}}},{key:"setPreparedAnchor",value:function(e){return this.instance.router.setAnchor(this,e),this._updateAnchorClass(),this}},{key:"_anchorLocationChanged",value:function(e){this.fire(Jd,{endpoint:this,anchor:e}),this._updateAnchorClass()}},{key:"setAnchor",value:function(e){var t=this.instance.router.prepareAnchor(e);return this.setPreparedAnchor(t),this}},{key:"addConnection",value:function(e){this.connections.push(e),this.instance._refreshEndpoint(this)}},{key:"detachFromConnection",value:function(e,t,r){t=t??this.connections.indexOf(e),t>=0&&(this.connections.splice(t,1),this.instance._refreshEndpoint(this)),!r&&this.deleteOnEmpty&&this.connections.length===0&&this.instance.deleteEndpoint(this)}},{key:"deleteEveryConnection",value:function(e){for(var t=this.connections.length,r=0;r<t;r++)this.instance.deleteConnection(this.connections[0],e)}},{key:"detachFrom",value:function(e){for(var t=[],r=0;r<this.connections.length;r++)(this.connections[r].endpoints[1]===e||this.connections[r].endpoints[0]===e)&&t.push(this.connections[r]);for(var s=0,l=t.length;s<l;s++)this.instance.deleteConnection(t[0]);return this}},{key:"setVisible",value:function(e,t,r){if(Ge(_e(n.prototype),"setVisible",this).call(this,e),this.endpoint.setVisible(e),e?this.showOverlays():this.hideOverlays(),!t){for(var s=0;s<this.connections.length;s++)if(this.connections[s].setVisible(e),!r){var l=this===this.connections[s].endpoints[0]?1:0;this.connections[s].endpoints[l].connections.length===1&&this.connections[s].endpoints[l].setVisible(e,!0,!0)}}}},{key:"applyType",value:function(e,t){Ge(_e(n.prototype),"applyType",this).call(this,e,t),this.setPaintStyle(e.endpointStyle||e.paintStyle),this.setHoverPaintStyle(e.endpointHoverStyle||e.hoverPaintStyle),this.connectorStyle=e.connectorStyle,this.connectorHoverStyle=e.connectorHoverStyle,this.connector=e.connector,this.connectorOverlays=e.connectorOverlays,this.edgeType=e.edgeType,e.maxConnections!=null&&(this.maxConnections=e.maxConnections),e.scope&&(this.scope=e.scope),W(e,Lv),this.instance.applyEndpointType(this,e)}},{key:"destroy",value:function(){Ge(_e(n.prototype),"destroy",this).call(this),this.deleted=!0,this.endpoint!=null&&this.instance.destroyEndpoint(this)}},{key:"isFull",value:function(){return this.maxConnections===0?!0:!(this.isFloating()||this.maxConnections<0||this.connections.length<this.maxConnections)}},{key:"isFloating",value:function(){return this.instance.router.isFloating(this)}},{key:"isConnectedTo",value:function(e){var t=!1;if(e){for(var r=0;r<this.connections.length;r++)if(this.connections[r].endpoints[1]===e||this.connections[r].endpoints[0]===e){t=!0;break}}return t}},{key:"setDragAllowedWhenFull",value:function(e){this.dragAllowedWhenFull=e}},{key:"getUuid",value:function(){return this.uuid}},{key:"connectorSelector",value:function(){return this.connections[0]}},{key:"prepareEndpoint",value:function(e,t){var r={cssClass:this.cssClass,endpoint:this},s;if($l(e,vr)){var l=e;s=ln.clone(l),s.classes=r.cssClass.split(" ")}else if(Be(e))s=ln.get(this,e,r);else{var u=e;W(r,u.options||{}),s=ln.get(this,u.type,r)}return s.typeId=t,s}},{key:"setEndpoint",value:function(e){var t=this.prepareEndpoint(e);this.setPreparedEndpoint(t)}},{key:"setPreparedEndpoint",value:function(e){this.endpoint!=null&&this.instance.destroyEndpoint(this),this.endpoint=e}},{key:"addClass",value:function(e,t){Ge(_e(n.prototype),"addClass",this).call(this,e,t),this.endpoint!=null&&this.endpoint.addClass(e)}},{key:"removeClass",value:function(e,t){Ge(_e(n.prototype),"removeClass",this).call(this,e,t),this.endpoint!=null&&this.endpoint.removeClass(e)}}]),n}(_u),Ti="anchors",Go="connector";function Ks(o,a,n,i,e,t,r){var s;if(a)o.endpoints[n]=a,a.addConnection(o);else{var l=r||o.endpointSpec||o.endpointsSpec[n]||o.instance.defaults.endpoints[n]||o.instance.defaults.endpoint,u=o.endpointStyles[n]||o.endpointStyle||o.instance.defaults.endpointStyles[n]||o.instance.defaults.endpointStyle;u.fill==null&&o.paintStyle!=null&&(u.fill=o.paintStyle.stroke),u.outlineStroke==null&&o.paintStyle!=null&&(u.outlineStroke=o.paintStyle.outlineStroke),u.outlineWidth==null&&o.paintStyle!=null&&(u.outlineWidth=o.paintStyle.outlineWidth);var c=o.endpointHoverStyles[n]||o.endpointHoverStyle||o.endpointHoverStyle||o.instance.defaults.endpointHoverStyles[n]||o.instance.defaults.endpointHoverStyle;o.hoverPaintStyle!=null&&(c==null&&(c={}),c.fill==null&&(c.fill=o.hoverPaintStyle.stroke));var d=o.uuids?o.uuids[n]:null;i=i??(o.instance.defaults.anchors!=null?o.instance.defaults.anchors[n]:o.instance.defaults.anchor),s=o.instance._internal_newEndpoint({paintStyle:u,hoverPaintStyle:c,endpoint:l,connections:[o],uuid:d,element:e,scope:o.scope,anchor:i,reattachConnections:o.reattach||o.instance.defaults.reattachConnections,connectionsDetachable:o.detachable||o.instance.defaults.connectionsDetachable}),o.instance._refreshEndpoint(s),a==null&&(s.deleteOnEmpty=!0),o.endpoints[n]=s}return s}var ni=function(o){Ee(n,o);var a=be(n);function n(i,e){var t;$(this,n),t=a.call(this,i,e),t.instance=i,h(m(t),"connector",void 0),h(m(t),"defaultLabelLocation",.5),h(m(t),"scope",void 0),h(m(t),"typeId","_jsplumb_connection"),h(m(t),"previousConnection",void 0),h(m(t),"sourceId",void 0),h(m(t),"targetId",void 0),h(m(t),"source",void 0),h(m(t),"target",void 0),h(m(t),"detachable",!0),h(m(t),"reattach",!1),h(m(t),"uuids",void 0),h(m(t),"cost",1),h(m(t),"directed",void 0),h(m(t),"endpoints",[null,null]),h(m(t),"endpointStyles",void 0),h(m(t),"endpointSpec",void 0),h(m(t),"endpointsSpec",void 0),h(m(t),"endpointStyle",{}),h(m(t),"endpointHoverStyle",{}),h(m(t),"endpointHoverStyles",void 0),h(m(t),"suspendedEndpoint",void 0),h(m(t),"suspendedIndex",void 0),h(m(t),"suspendedElement",void 0),h(m(t),"suspendedElementId",void 0),h(m(t),"suspendedElementType",void 0),h(m(t),"_forceReattach",void 0),h(m(t),"_forceDetach",void 0),h(m(t),"proxies",[]),h(m(t),"pending",!1),t.id=e.id,t.previousConnection=e.previousConnection,t.source=e.source,t.target=e.target,e.sourceEndpoint?(t.source=e.sourceEndpoint.element,t.sourceId=e.sourceEndpoint.elementId):t.sourceId=i.getId(t.source),e.targetEndpoint?(t.target=e.targetEndpoint.element,t.targetId=e.targetEndpoint.elementId):t.targetId=i.getId(t.target),t.scope=e.scope;var r=e.anchors?e.anchors[0]:e.anchor,s=e.anchors?e.anchors[1]:e.anchor;i.manage(t.source),i.manage(t.target),t.visible=!0,t.params={cssClass:e.cssClass,hoverClass:e.hoverClass,"pointer-events":e["pointer-events"],overlays:e.overlays},t.lastPaintedAt=null,e.type&&(e.endpoints=e.endpoints||t.instance._deriveEndpointAndAnchorSpec(e.type).endpoints),t.endpointSpec=e.endpoint,t.endpointsSpec=e.endpoints||[null,null],t.endpointStyle=e.endpointStyle,t.endpointHoverStyle=e.endpointHoverStyle,t.endpointStyles=e.endpointStyles||[null,null],t.endpointHoverStyles=e.endpointHoverStyles||[null,null],t.paintStyle=e.paintStyle,t.hoverPaintStyle=e.hoverPaintStyle,t.uuids=e.uuids,t.makeEndpoint(!0,t.source,t.sourceId,r,e.sourceEndpoint),t.makeEndpoint(!1,t.target,t.targetId,s,e.targetEndpoint),t.scope||(t.scope=t.endpoints[0].scope),e.deleteEndpointsOnEmpty!=null&&(t.endpoints[0].deleteOnEmpty=e.deleteEndpointsOnEmpty,t.endpoints[1].deleteOnEmpty=e.deleteEndpointsOnEmpty);var l=t.instance.defaults.connectionsDetachable;e.detachable===!1&&(l=!1),t.endpoints[0].connectionsDetachable===!1&&(l=!1),t.endpoints[1].connectionsDetachable===!1&&(l=!1),t.endpointsSpec=e.endpoints||[null,null],t.endpointSpec=e.endpoint||null;var u=e.reattach||t.endpoints[0].reattachConnections||t.endpoints[1].reattachConnections||t.instance.defaults.reattachConnections,c=W({},t.endpoints[0].connectorStyle||t.endpoints[1].connectorStyle||e.paintStyle||t.instance.defaults.paintStyle);if(t.appendToDefaultType({detachable:l,reattach:u,paintStyle:c,hoverPaintStyle:W({},t.endpoints[0].connectorHoverStyle||t.endpoints[1].connectorHoverStyle||e.hoverPaintStyle||t.instance.defaults.hoverPaintStyle)}),e.outlineWidth&&(c.outlineWidth=e.outlineWidth),e.outlineColor&&(c.outlineStroke=e.outlineColor),e.lineWidth&&(c.strokeWidth=e.lineWidth),e.color&&(c.stroke=e.color),!t.instance._suspendDrawing){var d=t.instance._suspendedAt||Ke();t.instance._paintEndpoint(t.endpoints[0],{timestamp:d}),t.instance._paintEndpoint(t.endpoints[1],{timestamp:d})}t.cost=e.cost||t.endpoints[0].connectionCost,t.directed=e.directed,e.directed==null&&(t.directed=t.endpoints[0].connectionsDirected);var f=W({},t.endpoints[1].parameters);W(f,t.endpoints[0].parameters),W(f,t.parameters),t.parameters=f,t.paintStyleInUse=t.getPaintStyle()||{},t._setConnector(t.endpoints[0].connector||t.endpoints[1].connector||e.connector||t.instance.defaults.connector,!0);var v=e.data==null||!sr(e.data)?{}:e.data;t.setData(v);var p=[eo,t.endpoints[0].edgeType,t.endpoints[1].edgeType,e.type].join(" ");return/[^\s]/.test(p)&&t.addType(p,e.data),t}return J(n,[{key:"getIdPrefix",value:function(){return"_jsPlumb_c"}},{key:"getDefaultOverlayKey",value:function(){return pf}},{key:"getXY",value:function(){return{x:this.connector.x,y:this.connector.y}}},{key:"makeEndpoint",value:function(e,t,r,s,l){return r=r||this.instance.getId(t),Ks(this,l,e?0:1,s,t)}},{key:"getTypeDescriptor",value:function(){return n.type}},{key:"isDetachable",value:function(e){return this.detachable===!1?!1:e!=null?e.connectionsDetachable===!0:this.detachable===!0}},{key:"setDetachable",value:function(e){this.detachable=e===!0}},{key:"isReattach",value:function(){return this.reattach===!0||this.endpoints[0].reattachConnections===!0||this.endpoints[1].reattachConnections===!0}},{key:"setReattach",value:function(e){this.reattach=e===!0}},{key:"applyType",value:function(e,t){var r=null;e.connector!=null&&(r=this.getCachedTypeItem(Go,t.connector),r==null&&(r=this.prepareConnector(e.connector,t.connector),this.cacheTypeItem(Go,r,t.connector)),this.setPreparedConnector(r)),Ge(_e(n.prototype),"applyType",this).call(this,e,t),e.detachable!=null&&this.setDetachable(e.detachable),e.reattach!=null&&this.setReattach(e.reattach),e.scope&&(this.scope=e.scope);var s=null;e.anchor?(s=this.getCachedTypeItem(Ti,t.anchor),s==null&&(s=[jr(e.anchor),jr(e.anchor)],this.cacheTypeItem(Ti,s,t.anchor))):e.anchors&&(s=this.getCachedTypeItem(Ti,t.anchors),s==null&&(s=[jr(e.anchors[0]),jr(e.anchors[1])],this.cacheTypeItem(Ti,s,t.anchors))),s!=null&&(this.instance.router.setConnectionAnchors(this,s),this.instance.router.isDynamicAnchor(this.endpoints[1])&&this.instance.repaint(this.endpoints[1].element)),this.instance.applyConnectorType(this.connector,e)}},{key:"addClass",value:function(e,t){Ge(_e(n.prototype),"addClass",this).call(this,e),t&&(this.endpoints[0].addClass(e),this.endpoints[1].addClass(e),this.suspendedEndpoint&&this.suspendedEndpoint.addClass(e)),this.connector&&this.instance.addConnectorClass(this.connector,e)}},{key:"removeClass",value:function(e,t){Ge(_e(n.prototype),"removeClass",this).call(this,e),t&&(this.endpoints[0].removeClass(e),this.endpoints[1].removeClass(e),this.suspendedEndpoint&&this.suspendedEndpoint.removeClass(e)),this.connector&&this.instance.removeConnectorClass(this.connector,e)}},{key:"setVisible",value:function(e){Ge(_e(n.prototype),"setVisible",this).call(this,e),this.connector&&this.instance.setConnectorVisible(this.connector,e),this.instance._paintConnection(this)}},{key:"destroy",value:function(){Ge(_e(n.prototype),"destroy",this).call(this),this.endpoints=null,this.endpointStyles=null,this.source=null,this.target=null,this.instance.destroyConnector(this),this.connector=null,this.deleted=!0}},{key:"getUuids",value:function(){return[this.endpoints[0].getUuid(),this.endpoints[1].getUuid()]}},{key:"prepareConnector",value:function(e,t){var r={cssClass:this.params.cssClass,hoverClass:this.params.hoverClass,"pointer-events":this.params["pointer-events"]},s;if(Be(e))s=this.instance._makeConnector(this,e,r);else{var l=e;s=this.instance._makeConnector(this,l.type,zi(l.options||{},r))}return t!=null&&(s.typeId=t),s}},{key:"setPreparedConnector",value:function(e,t,r,s){if(this.connector!==e){var l,u="";if(this.connector!=null&&(l=this.connector,u=this.instance.getConnectorClass(this.connector),this.instance.destroyConnector(this)),this.connector=e,s&&this.cacheTypeItem(Go,e,s),this.addClass(u),l!=null){var c=this.getOverlays();for(var d in c)this.instance.reattachOverlay(c[d],this)}t||this.instance._paintConnection(this)}}},{key:"_setConnector",value:function(e,t,r,s){var l=this.prepareConnector(e,s);this.setPreparedConnector(l,t,r,s)}},{key:"replaceEndpoint",value:function(e,t){var r=this.endpoints[e],s=r.elementId,l=this.instance.getEndpoints(r.element),u=l.indexOf(r),c=Ks(this,null,e,null,r.element,s,t);this.endpoints[e]=c,l.splice(u,1,c),r.detachFromConnection(this),this.instance.deleteEndpoint(r),this.instance.fire(qd,{previous:r,current:c})}}]),n}(_u);h(ni,"type","connection");function Ur(o){if(o.path==null){var a=W({"jtk-overlay-id":o.id},o.attributes);o.path=Wt(ea,a);var n=o.instance.overlayClass+" "+(o.cssClass?o.cssClass:"");o.instance.addClass(o.path,n),o.path.jtk={overlay:o}}var i=o.path.parentNode;if(i==null){if(o.component instanceof ni){var e=o.component.connector;i=e!=null?e.canvas:null}else if(o.component instanceof tr){var t=o.component.endpoint;i=t!=null?t.canvas:t}i!=null&&Gi(i,o.path,1)}return o.path}function Nv(o,a,n,i){Ur(o);var e=[0,0];i.xmin<0&&(e[0]=-i.xmin),i.ymin<0&&(e[1]=-i.ymin);var t={d:a,stroke:n.stroke?n.stroke:null,fill:n.fill?n.fill:null,transform:"translate("+e[0]+","+e[1]+")","pointer-events":"visibleStroke"};$t(o.path,t)}function Rv(o,a){var n=o;n.path!=null&&n.path.parentNode!=null&&n.path.parentNode.removeChild(n.path),n.bgPath!=null&&n.bgPath.parentNode!=null&&n.bgPath.parentNode.removeChild(n.bgPath),delete n.path,delete n.bgPath}(function(o){Ee(n,o);var a=be(n);function n(){var i;$(this,n);for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return i=a.call.apply(a,[this].concat(t)),h(m(i),"path",void 0),i}return n})(go);var wu=function(){function o(){$(this,o)}return J(o,null,[{key:"paint",value:function(n,i,e,t){if(e!=null){var r=[n.x,n.y],s=[n.w,n.h];if(t!=null&&(t.xmin<0&&(r[0]+=t.xmin),t.ymin<0&&(r[1]+=t.ymin),s[0]=t.xmax+(t.xmin<0?-t.xmin:0),s[1]=t.ymax+(t.ymin<0?-t.ymin:0)),isFinite(s[0])&&isFinite(s[1])){var l={width:""+(s[0]||0),height:""+(s[1]||0)};i.containerType===wn.HTML?$t(n.canvas,W(l,{style:cu([r[0],r[1]])})):$t(n.canvas,W(l,{x:r[0],y:r[1]}))}}}}]),o}();function Fv(o,a,n,i){Gv(o,a),wu.paint(a,o,n,i);var e="",t=[0,0];if(i.xmin<0&&(t[0]=-i.xmin),i.ymin<0&&(t[1]=-i.ymin),a.segments.length>0){e=o.getPathData(a);var r={d:e,transform:"translate("+t[0]+","+t[1]+")","pointer-events":"visibleStroke"},s=null;if(n.outlineStroke){var l=n.outlineWidth||1,u=n.strokeWidth+2*l;s=W({},n),s.stroke=n.outlineStroke,s.strokeWidth=u,a.bgPath==null?(a.bgPath=Wt(ea,r),o.addClass(a.bgPath,o.connectorOutlineClass),Gi(a.canvas,a.bgPath,0)):$t(a.bgPath,r),ta(a.canvas,a.bgPath,s)}var c=a;c.path==null?(c.path=Wt(ea,r),Gi(c.canvas,c.path,n.outlineStroke?1:0)):(c.path.parentNode!==c.canvas&&Gi(c.canvas,c.path,n.outlineStroke?1:0),$t(a.path,r)),ta(a.canvas,a.path,n)}}function Gv(o,a){if(a.canvas!=null)return a.canvas;var n=Wt(uu,{style:"",width:"0",height:"0","pointer-events":lr,position:qr});return a.canvas=n,o._appendElement(a.canvas,o.getContainer()),a.cssClass!=null&&o.addClass(n,a.cssClass),o.addClass(n,o.connectorClass),n.jtk=n.jtk||{},n.jtk.connector=a,n}var jv=function(){function o(){$(this,o)}return J(o,null,[{key:"getEndpointElement",value:function(n){if(n.canvas!=null)return n.canvas;var i=Wt(uu,{style:"",width:"0",height:"0","pointer-events":"all",position:qr});n.canvas=i;var e=n.classes.join(" ");n.instance.addClass(i,e);for(var t=n.endpoint.scope.split(/\s/),r=0;r<t.length;r++)n.instance.setAttribute(i,Ql+t[r],hu);return n.instance._appendElementToContainer(i),n.cssClass!=null&&n.instance.addClass(i,n.cssClass),n.instance.addClass(i,n.instance.endpointClass),i.jtk=i.jtk||{},i.jtk.endpoint=n.endpoint,i.style.display=n.endpoint.visible!==!1?qo:lr,i}},{key:"paint",value:function(n,i,e){if(n.endpoint.deleted!==!0){this.getEndpointElement(n),wu.paint(n,n.instance,e);var t=W({},e);t.outlineStroke&&(t.stroke=t.outlineStroke),n.node==null?(n.node=i.makeNode(n,t),n.canvas.appendChild(n.node)):i.updateNode!=null&&i.updateNode(n,n.node),ta(n.canvas,n.node,t)}}}]),o}(),yo=function(){function o(a,n){$(this,o),this.connection=a,h(this,"type",void 0),h(this,"edited",!1),h(this,"stub",void 0),h(this,"sourceStub",void 0),h(this,"targetStub",void 0),h(this,"maxStub",void 0),h(this,"typeId",void 0),h(this,"gap",void 0),h(this,"sourceGap",void 0),h(this,"targetGap",void 0),h(this,"segments",[]),h(this,"totalLength",0),h(this,"segmentProportions",[]),h(this,"segmentProportionalLengths",[]),h(this,"paintInfo",null),h(this,"strokeWidth",void 0),h(this,"x",void 0),h(this,"y",void 0),h(this,"w",void 0),h(this,"h",void 0),h(this,"segment",void 0),h(this,"bounds",qi()),h(this,"cssClass",void 0),h(this,"hoverClass",void 0),h(this,"geometry",void 0),this.stub=n.stub||this.getDefaultStubs(),this.sourceStub=Array.isArray(this.stub)?this.stub[0]:this.stub,this.targetStub=Array.isArray(this.stub)?this.stub[1]:this.stub,this.gap=n.gap||0,this.sourceGap=Array.isArray(this.gap)?this.gap[0]:this.gap,this.targetGap=Array.isArray(this.gap)?this.gap[1]:this.gap,this.maxStub=Math.max(this.sourceStub,this.targetStub),this.cssClass=n.cssClass||"",this.hoverClass=n.hoverClass||""}return J(o,[{key:"getTypeDescriptor",value:function(){return"connector"}},{key:"getIdPrefix",value:function(){return"_jsplumb_connector"}},{key:"setGeometry",value:function(n,i){this.geometry=n,this.edited=n!=null&&!i}},{key:"exportGeometry",value:function(){return this.geometry}},{key:"importGeometry",value:function(n){return this.geometry=n,!0}},{key:"resetGeometry",value:function(){this.geometry=null,this.edited=!1}},{key:"transformAnchorPlacement",value:function(n,i,e){return{x:n.x,y:n.y,ox:n.ox,oy:n.oy,curX:n.curX+i,curY:n.curY+e}}},{key:"resetBounds",value:function(){this.bounds=qi()}},{key:"findSegmentForPoint",value:function(n,i){for(var e={d:1/0,s:null,x:null,y:null,l:null,x1:null,y1:null,x2:null,y2:null,index:null,connectorLocation:null},t=0;t<this.segments.length;t++){var r=this.segments[t].findClosestPointOnPath(n,i);r.d<e.d&&(e.d=r.d,e.l=r.l,e.x=r.x,e.y=r.y,e.s=this.segments[t],e.x1=r.x1,e.x2=r.x2,e.y1=r.y1,e.y2=r.y2,e.index=t,e.connectorLocation=this.segmentProportions[t][0]+r.l*(this.segmentProportions[t][1]-this.segmentProportions[t][0]))}return e}},{key:"lineIntersection",value:function(n,i,e,t){for(var r=[],s=0;s<this.segments.length;s++)r.push.apply(r,this.segments[s].lineIntersection(n,i,e,t));return r}},{key:"boxIntersection",value:function(n,i,e,t){for(var r=[],s=0;s<this.segments.length;s++)r.push.apply(r,this.segments[s].boxIntersection(n,i,e,t));return r}},{key:"boundingBoxIntersection",value:function(n){for(var i=[],e=0;e<this.segments.length;e++)i.push.apply(i,this.segments[e].boundingBoxIntersection(n));return i}},{key:"_updateSegmentProportions",value:function(){for(var n=0,i=0;i<this.segments.length;i++){var e=this.segments[i].getLength();this.segmentProportionalLengths[i]=e/this.totalLength,this.segmentProportions[i]=[n,n+=e/this.totalLength]}}},{key:"_findSegmentForLocation",value:function(n,i){var e,t,r;if(i&&(n=n>0?n/this.totalLength:(this.totalLength+n)/this.totalLength),n===1)e=this.segments.length-1,r=1;else if(n===0)r=0,e=0;else if(n>=.5){for(e=0,r=0,t=this.segmentProportions.length-1;t>-1;t--)if(this.segmentProportions[t][1]>=n&&this.segmentProportions[t][0]<=n){e=t,r=(n-this.segmentProportions[t][0])/this.segmentProportionalLengths[t];break}}else for(e=this.segmentProportions.length-1,r=1,t=0;t<this.segmentProportions.length;t++)if(this.segmentProportions[t][1]>=n){e=t,r=(n-this.segmentProportions[t][0])/this.segmentProportionalLengths[t];break}return{segment:this.segments[e],proportion:r,index:e}}},{key:"_addSegment",value:function(n,i){if(!(i.x1===i.x2&&i.y1===i.y2)){var e=new n(i);this.segments.push(e),this.totalLength+=e.getLength(),this.updateBounds(e)}}},{key:"_clearSegments",value:function(){this.totalLength=0,this.segments.length=0,this.segmentProportions.length=0,this.segmentProportionalLengths.length=0}},{key:"getLength",value:function(){return this.totalLength}},{key:"_prepareCompute",value:function(n){this.strokeWidth=n.strokeWidth;var i=n.sourcePos.curX,e=n.targetPos.curX,t=n.sourcePos.curY,r=n.targetPos.curY,s=Ga({x:i,y:t},{x:e,y:r}),l=e<i,u=r<t,c=[n.sourcePos.ox,n.sourcePos.oy],d=[n.targetPos.ox,n.targetPos.oy],f=l?e:i,v=u?r:t,p=Math.abs(e-i),y=Math.abs(r-t),g=c[0]===0&&c[1]===0,E=d[0]===0&&d[1]===0;if(g||E){var b=p>y?0:1,S=[1,0][b],C=b===0?i:t,x=b===0?e:r;g&&(c[b]=C>x?-1:1,c[S]=0),E&&(d[b]=C>x?1:-1,d[S]=0)}var T=l?p+this.sourceGap*c[0]:this.sourceGap*c[0],O=u?y+this.sourceGap*c[1]:this.sourceGap*c[1],P=l?this.targetGap*d[0]:p+this.targetGap*d[0],A=u?this.targetGap*d[1]:y+this.targetGap*d[1],_=c[0]*d[0]+c[1]*d[1],R={sx:T,sy:O,tx:P,ty:A,xSpan:Math.abs(P-T),ySpan:Math.abs(A-O),mx:(T+P)/2,my:(O+A)/2,so:c,to:d,x:f,y:v,w:p,h:y,segment:s,startStubX:T+c[0]*this.sourceStub,startStubY:O+c[1]*this.sourceStub,endStubX:P+d[0]*this.targetStub,endStubY:A+d[1]*this.targetStub,isXGreaterThanStubTimes2:Math.abs(T-P)>this.sourceStub+this.targetStub,isYGreaterThanStubTimes2:Math.abs(O-A)>this.sourceStub+this.targetStub,opposite:_===-1,perpendicular:_===0,orthogonal:_===1,sourceAxis:c[0]===0?"y":"x",points:[f,v,p,y,T,O,P,A],stubs:[this.sourceStub,this.targetStub]};return R.anchorOrientation=R.opposite?"opposite":R.orthogonal?"orthogonal":"perpendicular",R}},{key:"updateBounds",value:function(n){var i=n.extents;this.bounds.xmin=Math.min(this.bounds.xmin,i.xmin),this.bounds.xmax=Math.max(this.bounds.xmax,i.xmax),this.bounds.ymin=Math.min(this.bounds.ymin,i.ymin),this.bounds.ymax=Math.max(this.bounds.ymax,i.ymax)}},{key:"dumpSegmentsToConsole",value:function(){We("SEGMENTS:");for(var n=0;n<this.segments.length;n++)We(this.segments[n].type,""+this.segments[n].getLength(),""+this.segmentProportions[n])}},{key:"pointOnPath",value:function(n,i){var e=this._findSegmentForLocation(n,i);return e.segment&&e.segment.pointOnPath(e.proportion,!1)||{x:0,y:0}}},{key:"gradientAtPoint",value:function(n,i){var e=this._findSegmentForLocation(n,i);return e.segment&&e.segment.gradientAtPoint(e.proportion,!1)||0}},{key:"pointAlongPathFrom",value:function(n,i,e){var t=this._findSegmentForLocation(n,e);return t.segment&&t.segment.pointAlongPathFrom(t.proportion,i,!1)||{x:0,y:0}}},{key:"compute",value:function(n){this.paintInfo=this._prepareCompute(n),this._clearSegments(),this._compute(this.paintInfo,n),this.x=this.paintInfo.points[0],this.y=this.paintInfo.points[1],this.w=this.paintInfo.points[2],this.h=this.paintInfo.points[3],this.segment=this.paintInfo.segment,this._updateSegmentProportions()}},{key:"setAnchorOrientation",value:function(n,i){}}]),o}(),Bv=20,Uv=20,fr=function(o){Ee(n,o);var a=be(n);function n(i,e,t){var r;return $(this,n),r=a.call(this,i,e,t),r.instance=i,r.component=e,h(m(r),"width",void 0),h(m(r),"length",void 0),h(m(r),"foldback",void 0),h(m(r),"direction",void 0),h(m(r),"location",.5),h(m(r),"paintStyle",void 0),h(m(r),"type",n.type),h(m(r),"cachedDimensions",void 0),t=t||{},r.width=t.width||Bv,r.length=t.length||Uv,r.direction=(t.direction||1)<0?-1:1,r.foldback=t.foldback||.623,r.paintStyle=t.paintStyle||{strokeWidth:1},r.location=t.location==null?r.location:Array.isArray(t.location)?t.location[0]:t.location,r}return J(n,[{key:"draw",value:function(e,t,r){if(e instanceof yo){var s=e,l,u,c,d,f;if(this.location>1||this.location<0){var v=this.location<0?1:0;l=s.pointAlongPathFrom(v,this.location,!1),u=s.pointAlongPathFrom(v,this.location-this.direction*this.length/2,!1),c=Cn(l,u,this.length)}else if(this.location===1){if(l=s.pointOnPath(this.location),u=s.pointAlongPathFrom(this.location,-this.length),c=Cn(l,u,this.length),this.direction===-1){var p=c;c=l,l=p}}else if(this.location===0){if(c=s.pointOnPath(this.location),u=s.pointAlongPathFrom(this.location,this.length),l=Cn(c,u,this.length),this.direction===-1){var y=c;c=l,l=y}}else l=s.pointAlongPathFrom(this.location,this.direction*this.length/2),u=s.pointOnPath(this.location),c=Cn(l,u,this.length);d=Sh(l,c,this.width),f=Cn(l,c,this.foldback*this.length);var g={hxy:l,tail:d,cxy:f},E=this.paintStyle.stroke||t.stroke,b=this.paintStyle.fill||t.stroke,S=this.paintStyle.strokeWidth||t.strokeWidth;return{component:e,d:g,"stroke-width":S,stroke:E,fill:b,xmin:Math.min(l.x,d[0].x,d[1].x),xmax:Math.max(l.x,d[0].x,d[1].x),ymin:Math.min(l.y,d[0].y,d[1].y),ymax:Math.max(l.y,d[0].y,d[1].y)}}}},{key:"updateFrom",value:function(e){}}]),n}(go);h(fr,"type","Arrow");function aa(o){return o.type===fr.type}kn.register(fr.type,fr);var oo=function(o){Ee(n,o);var a=be(n);function n(i,e,t){var r;return $(this,n),r=a.call(this,i,e,t),r.instance=i,h(m(r),"type",n.type),r.length=r.length/2,r.foldback=2,r}return n}(fr);h(oo,"type","Diamond");function sa(o){return o.type===oo.type}kn.register(oo.type,oo);var Xa=function(o){Ee(n,o);var a=be(n);function n(i,e,t){var r;return $(this,n),r=a.call(this,i,e,t),r.instance=i,h(m(r),"type",n.type),r.foldback=1,r}return n}(fr);h(Xa,"type","PlainArrow");function la(o){return o.type===Xa.type}kn.register("PlainArrow",Xa);var ao=function(o){Ee(n,o);var a=be(n);function n(i,e,t){var r;return $(this,n),r=a.call(this,i,e,t),r.instance=i,r.component=e,h(m(r),"create",void 0),h(m(r),"type",n.type),r.create=t.create,r}return J(n,[{key:"updateFrom",value:function(e){}}]),n}(go);h(ao,"type","Custom");function Qt(o){return o.type===ao.type}kn.register(ao.type,ao);var Vv="allowNestedGroups",Wn="paintStyle",Hv="scope",Nn=function(o){Ee(n,o);var a=be(n);function n(i,e){var t;return $(this,n),t=a.call(this,i,e),h(m(t),"radius",void 0),h(m(t),"defaultOffset",void 0),h(m(t),"defaultInnerRadius",void 0),h(m(t),"type",n.type),e=e||{},t.radius=e.radius||5,t.defaultOffset=.5*t.radius,t.defaultInnerRadius=t.radius/3,t}return n}(vr);h(Nn,"type","Dot");var Yv={type:Nn.type,cls:Nn,compute:function(a,n,i,e){var t=n.curX-a.radius,r=n.curY-a.radius,s=a.radius*2,l=a.radius*2;if(e&&e.stroke){var u=e.strokeWidth||1;t-=u,r-=u,s+=u*2,l+=u*2}return a.x=t,a.y=r,a.w=s,a.h=l,[t,r,s,l,a.radius]},getParams:function(a){return{radius:a.radius}}},jo=function o(a,n){$(this,o),this.instance=a,this.el=n,h(this,"group",void 0)},Xv=function(o){Ee(n,o);var a=be(n);function n(i,e,t){var r;$(this,n),r=a.call(this,i,e),r.instance=i,h(m(r),"children",[]),h(m(r),"collapsed",!1),h(m(r),"droppable",void 0),h(m(r),"enabled",void 0),h(m(r),"orphan",void 0),h(m(r),"constrain",void 0),h(m(r),"proxied",void 0),h(m(r),"ghost",void 0),h(m(r),"revert",void 0),h(m(r),"prune",void 0),h(m(r),"dropOverride",void 0),h(m(r),"anchor",void 0),h(m(r),"endpoint",void 0),h(m(r),"connections",{source:[],target:[],internal:[]}),h(m(r),"manager",void 0),h(m(r),"id",void 0),h(m(r),"elId",void 0);var s=r.el;return s._isJsPlumbGroup=!0,s._jsPlumbGroup=m(r),r.elId=i.getId(e),r.orphan=t.orphan===!0,r.revert=r.orphan===!0?!1:t.revert!==!1,r.droppable=t.droppable!==!1,r.ghost=t.ghost===!0,r.enabled=t.enabled!==!1,r.prune=r.orphan!==!0&&t.prune===!0,r.constrain=r.ghost||t.constrain===!0,r.proxied=t.proxied!==!1,r.id=t.id||Ke(),r.dropOverride=t.dropOverride===!0,r.anchor=t.anchor,r.endpoint=t.endpoint,r.anchor=t.anchor,i.setAttribute(e,Jl,""),r}return J(n,[{key:"contentArea",get:function(){return this.instance.getGroupContentArea(this)}},{key:"overrideDrop",value:function(e,t){return this.dropOverride&&(this.revert||this.prune||this.orphan)}},{key:"getAnchor",value:function(e,t){return this.anchor||"Continuous"}},{key:"getEndpoint",value:function(e,t){return this.endpoint||{type:Nn.type,options:{radius:10}}}},{key:"add",value:function(e,t){var r=this.instance.getGroupContentArea(this),s=e;if(s._jsPlumbParentGroup!=null){if(s._jsPlumbParentGroup===this)return;s._jsPlumbParentGroup.remove(e,!0,t,!1)}s._jsPlumbParentGroup=this,this.children.push(new jo(this.instance,e)),this.instance._appendElement(s,r),this.manager._updateConnectionsForGroup(this)}},{key:"resolveNode",value:function(e){return e==null?null:Ta(this.children,function(t){return t.el===e})}},{key:"remove",value:function(e,t,r,s,l){var u=this.resolveNode(e);u!=null&&this._doRemove(u,t,r,s,l)}},{key:"_doRemove",value:function(e,t,r,s,l){var u=e.el;if(delete u._jsPlumbParentGroup,Ze(this.children,function(d){return d===e}),t)try{this.instance.getGroupContentArea(this).removeChild(u)}catch(d){We("Could not remove element from Group "+d)}if(!r){var c={group:this,el:u};l&&(c.targetGroup=l),this.instance.fire(of,c)}s||this.manager._updateConnectionsForGroup(this)}},{key:"removeAll",value:function(e,t){for(var r=0,s=this.children.length;r<s;r++){var l=this.children[0];this._doRemove(l,e,t,!0),this.instance.unmanage(l.el,!0)}this.children.length=0,this.manager._updateConnectionsForGroup(this)}},{key:"orphanAll",value:function(){for(var e={},t=0;t<this.children.length;t++){var r=this.manager.orphan(this.children[t].el,!1);e[r.id]=r.pos}return this.children.length=0,e}},{key:"addGroup",value:function(e){if(this.instance.allowNestedGroups&&e!==this){if(this.instance.groupManager.isAncestor(this,e))return!1;e.group!=null&&e.group.removeGroup(e);var t=this.instance.getId(e.el),r=this.instance.getManagedElements()[t];r.group=this.elId;var s=this.instance.getOffsetRelativeToRoot(e.el),l=this.collapsed?this.instance.getOffsetRelativeToRoot(this.el):this.instance.getOffsetRelativeToRoot(this.instance.getGroupContentArea(this));e.el._jsPlumbParentGroup=this,this.children.push(e),this.instance._appendElementToGroup(this,e.el),e.group=this;var u={x:s.x-l.x,y:s.y-l.y};return this.instance.setPosition(e.el,u),this.instance.fire(sf,{parent:this,child:e}),!0}else return!1}},{key:"removeGroup",value:function(e){if(e.group===this){var t=e.el,r=this.instance.getGroupContentArea(this);r===t.parentNode&&r.removeChild(e.el);var s=this.instance.getId(e.el),l=this.instance.getManagedElements()[s];l&&delete l.group,this.children=this.children.filter(function(u){return u.id!==e.id}),delete e.group,delete t._jsPlumbParentGroup,this.instance.fire(lf,{parent:this,child:e})}}},{key:"getGroups",value:function(){return this.children.filter(function(e){return e.constructor===n})}},{key:"getNodes",value:function(){return this.children.filter(function(e){return e.constructor===jo})}},{key:"collapseParent",get:function(){var e=null;if(this.group==null)return null;for(var t=this.group;t!=null;)t.collapsed&&(e=t),t=t.group;return e}}]),n}(jo),$v=function(){function o(a){var n=this;$(this,o),this.instance=a,h(this,"groupMap",{}),h(this,"_connectionSourceMap",{}),h(this,"_connectionTargetMap",{}),a.bind(eu,function(i){var e=n.getGroupFor(i.source),t=n.getGroupFor(i.target);e!=null&&t!=null&&e===t?(n._connectionSourceMap[i.connection.id]=e,n._connectionTargetMap[i.connection.id]=e,Pr(e.connections.internal,i.connection)):(e!=null&&(i.target._jsPlumbGroup===e?Pr(e.connections.internal,i.connection):Pr(e.connections.source,i.connection),n._connectionSourceMap[i.connection.id]=e),t!=null&&(i.source._jsPlumbGroup===t?Pr(t.connections.internal,i.connection):Pr(t.connections.target,i.connection),n._connectionTargetMap[i.connection.id]=t))}),a.bind(Ma,function(i){n._cleanupDetachedConnection(i.connection)}),a.bind(wa,function(i){var e=i.originalEndpoint.element,t=n.getGroupFor(e),r=i.connection.endpoints[i.index],s=r.element,l=n.getGroupFor(s),u=i.index===0?n._connectionSourceMap:n._connectionTargetMap,c=i.index===0?n._connectionTargetMap:n._connectionSourceMap;l!=null?(u[i.connection.id]=l,i.connection.source===i.connection.target&&(c[i.connection.id]=l)):(delete u[i.connection.id],i.connection.source===i.connection.target&&delete c[i.connection.id]),t!=null&&n._updateConnectionsForGroup(t),l!=null&&n._updateConnectionsForGroup(l)})}return J(o,[{key:"_cleanupDetachedConnection",value:function(n){n.proxies.length=0;var i=this._connectionSourceMap[n.id],e;i!=null&&(e=function(r){return r.id===n.id},Ze(i.connections.source,e),Ze(i.connections.target,e),Ze(i.connections.internal,e),delete this._connectionSourceMap[n.id]),i=this._connectionTargetMap[n.id],i!=null&&(e=function(r){return r.id===n.id},Ze(i.connections.source,e),Ze(i.connections.target,e),Ze(i.connections.internal,e),delete this._connectionTargetMap[n.id])}},{key:"addGroup",value:function(n){var i=n.el;if(this.groupMap[n.id]!=null)throw new Error("cannot create Group ["+n.id+"]; a Group with that ID exists");if(i._isJsPlumbGroup!=null)throw new Error("cannot create Group ["+n.id+"]; the given element is already a Group");var e=new Xv(this.instance,n.el,n);return this.groupMap[e.id]=e,n.collapsed&&this.collapseGroup(e),this.instance.manage(e.el),this.instance.addClass(e.el,Ar),e.manager=this,this._updateConnectionsForGroup(e),this.instance.fire(ef,{group:e}),e}},{key:"getGroup",value:function(n){var i=n;if(Be(n)&&(i=this.groupMap[n],i==null))throw new Error("No such group ["+n+"]");return i}},{key:"getGroupFor",value:function(n){for(var i=n,e=this.instance.getContainer(),t=!1,r=null;!t;)i==null||i===e?t=!0:i._jsPlumbParentGroup?(r=i._jsPlumbParentGroup,t=!0):i=i.parentNode;return r}},{key:"getGroups",value:function(){var n=[];for(var i in this.groupMap)n.push(this.groupMap[i]);return n}},{key:"removeGroup",value:function(n,i,e,t){var r=this,s=this.getGroup(n);this.expandGroup(s,!0);var l={};return K(s.children,function(u){var c=r.instance.getManagedElements()[r.instance.getId(u.el)];c&&delete c.group}),i?(K(s.getGroups(),function(u){return r.removeGroup(u,i,e)}),s.removeAll(e,t)):(s.group&&K(s.children,function(u){return s.group.add(u.el)}),l=s.orphanAll()),s.group&&s.group.removeGroup(s),this.instance.unmanage(s.el,!0),delete this.groupMap[s.id],this.instance.fire(af,{group:s}),l}},{key:"removeAllGroups",value:function(n,i,e){for(var t in this.groupMap)this.removeGroup(this.groupMap[t],n,i,e)}},{key:"forEach",value:function(n){for(var i in this.groupMap)n(this.groupMap[i])}},{key:"orphan",value:function(n,i){var e=n;if(e._jsPlumbParentGroup){var t=e._jsPlumbParentGroup,r=this.instance.getId(e),s=this.instance.getOffset(n);return i!==!0&&t.group?this.instance._appendElementToGroup(t.group,n):this.instance._appendElementToContainer(n),this.instance.setPosition(n,s),delete e._jsPlumbParentGroup,{id:r,pos:s}}}},{key:"_updateConnectionsForGroup",value:function(n){var i=this;n.connections.source.length=0,n.connections.target.length=0,n.connections.internal.length=0;var e=n.children.slice().map(function(f){return f.el}),t=[];if(K(e,function(f){Array.prototype.push.apply(t,i.instance.getSelector(f,Ie))}),Array.prototype.push.apply(e,t),e.length>0){var r=this.instance.getConnections({source:e,scope:Tn},!0),s=this.instance.getConnections({target:e,scope:Tn},!0),l={},u,c,d=function(v){for(var p=0;p<v.length;p++)l[v[p].id]||(l[v[p].id]=!0,u=i.getGroupFor(v[p].source),c=i.getGroupFor(v[p].target),v[p].source===n.el&&c===n||v[p].target===n.el&&u===n?n.connections.internal.push(v[p]):u===n?(c!==n?n.connections.source.push(v[p]):n.connections.internal.push(v[p]),i._connectionSourceMap[v[p].id]=n):c===n&&(n.connections.target.push(v[p]),i._connectionTargetMap[v[p].id]=n))};d(r),d(s)}}},{key:"_collapseConnection",value:function(n,i,e){var t=n.endpoints[i===0?1:0].element;if(t._jsPlumbParentGroup&&!t._jsPlumbParentGroup.proxied&&t._jsPlumbParentGroup.collapsed)return!1;var r=n.endpoints[0].element,s=r._jsPlumbParentGroup,l=s!=null?s.collapseParent||s:null,u=n.endpoints[1].element,c=u._jsPlumbParentGroup,d=c!=null?c.collapseParent||c:null;if(l==null||d==null||l.id!==d.id){var f=e.el;return this.instance.getId(f),this.instance.proxyConnection(n,i,f,function(v,p){return e.getEndpoint(v,p)},function(v,p){return e.getAnchor(v,p)}),!0}else return!1}},{key:"_expandConnection",value:function(n,i,e){this.instance.unproxyConnection(n,i)}},{key:"isElementDescendant",value:function(n,i){for(var e=this.instance.getContainer(),t=!1;!t;){if(n==null||n===e)return!1;if(n===i)return!0;n=n.parentNode}}},{key:"collapseGroup",value:function(n){var i=this,e=this.getGroup(n);if(!(e==null||e.collapsed)){var t=e.el;if(e.collapseParent==null){if(this.instance.setGroupVisible(e,!1),e.collapsed=!0,this.instance.removeClass(t,Ar),this.instance.addClass(t,Ci),e.proxied){var r=new Set,s=function(u,c){for(var d=0;d<u.length;d++){var f=u[d];i._collapseConnection(f,c,e)===!0&&r.add(f.id)}};s(e.connections.source,0),s(e.connections.target,1),K(e.getGroups(),function(l){i.cascadeCollapse(e,l,r)})}this.instance.revalidate(t),this.repaintGroup(e),this.instance.fire(tf,{group:e})}else e.collapsed=!0,this.instance.removeClass(t,Ar),this.instance.addClass(t,Ci)}}},{key:"cascadeCollapse",value:function(n,i,e){var t=this;if(n.proxied){var r=function(l,u){for(var c=0;c<l.length;c++){var d=l[c];e.has(d.id)||t._collapseConnection(d,u,n)===!0&&e.add(d.id)}};r(i.connections.source,0),r(i.connections.target,1)}K(i.getGroups(),function(s){t.cascadeCollapse(n,s,e)})}},{key:"expandGroup",value:function(n,i){var e=this,t=this.getGroup(n);if(t!=null){var r=t.el;if(t.collapseParent==null){if(this.instance.setGroupVisible(t,!0),t.collapsed=!1,this.instance.addClass(r,Ar),this.instance.removeClass(r,Ci),t.proxied){var s=function(c,d){for(var f=0;f<c.length;f++){var v=c[f];e._expandConnection(v,d,t)}};s(t.connections.source,0),s(t.connections.target,1);var l=function u(c,d){if(d||c.collapsed){var f=function(p,y){for(var g=0;g<p.length;g++){var E=p[g];e._collapseConnection(E,y,c.collapseParent||c)}};f(c.connections.source,0),f(c.connections.target,1),K(c.connections.internal,function(v){return v.setVisible(!1)}),K(c.getGroups(),function(v){return u(v,!0)})}else e.expandGroup(c,!0)};K(t.getGroups(),l)}this.instance.revalidate(r),this.repaintGroup(t),i||this.instance.fire(nf,{group:t})}else t.collapsed=!1,this.instance.addClass(r,Ar),this.instance.removeClass(r,Ci)}}},{key:"toggleGroup",value:function(n){n=this.getGroup(n),n!=null&&(n.collapsed?this.expandGroup(n):this.collapseGroup(n))}},{key:"repaintGroup",value:function(n){for(var i=this.getGroup(n),e=i.children,t=0;t<e.length;t++)this.instance.revalidate(e[t].el)}},{key:"addToGroup",value:function(n,i){var e=this,t=this.getGroup(n);if(t){for(var r=t.el,s=function(f){var v=f,p=v._isJsPlumbGroup!=null,y=v._jsPlumbGroup,g=v._jsPlumbParentGroup;if(g!==t){var E=e.instance.manage(f),b=e.instance.getOffset(f),S=t.collapsed?e.instance.getOffsetRelativeToRoot(r):e.instance.getOffset(e.instance.getGroupContentArea(t));E.group=t.elId,g!=null&&(g.remove(f,!1,i,!1,t),e._updateConnectionsForGroup(g)),p?t.addGroup(y):t.add(f,i);var C=function(P,A){var _=A===0?1:0;P.each(function(R){R.setVisible(!1),R.endpoints[_].element._jsPlumbGroup===t?(R.endpoints[_].setVisible(!1),e._expandConnection(R,_,t)):(R.endpoints[A].setVisible(!1),e._collapseConnection(R,A,t))})};t.collapsed&&(C(e.instance.select({source:f}),0),C(e.instance.select({target:f}),1)),e.instance.getId(f);var x={x:b.x-S.x,y:b.y-S.y};if(e.instance.setPosition(f,x),e._updateConnectionsForGroup(t),e.instance.revalidate(f),!i){var T={group:t,el:f,pos:x};g&&(T.sourceGroup=g),e.instance.fire(rf,T)}}},l=arguments.length,u=new Array(l>2?l-2:0),c=2;c<l;c++)u[c-2]=arguments[c];K(u,s)}}},{key:"removeFromGroup",value:function(n,i){var e=this,t=this.getGroup(n);if(t){for(var r=function(d){if(t.collapsed){var f=function(y,g){for(var E=0;E<y.length;E++){var b=y[E];if(b.proxies){for(var S=0;S<b.proxies.length;S++)if(b.proxies[S]!=null){var C=b.proxies[S].originalEp.element;(C===d||e.isElementDescendant(C,d))&&e._expandConnection(b,g,t)}}}};f(t.connections.source.slice(),0),f(t.connections.target.slice(),1)}t.remove(d,null,i);var v=e.instance.getManagedElements()[e.instance.getId(d)];v&&delete v.group},s=arguments.length,l=new Array(s>2?s-2:0),u=2;u<s;u++)l[u-2]=arguments[u];K(l,r)}}},{key:"getAncestors",value:function(n){for(var i=[],e=n.group;e!=null;)i.push(e),e=e.group;return i}},{key:"isAncestor",value:function(n,i){return n==null||i==null?!1:this.getAncestors(n).indexOf(i)!==-1}},{key:"getDescendants",value:function(n){var i=[],e=function t(r){var s=r.getGroups();i.push.apply(i,ar(s)),K(s,t)};return e(n),i}},{key:"isDescendant",value:function(n,i){return n==null||i==null?!1:this.getDescendants(i).indexOf(n)!==-1}},{key:"reset",value:function(){this._connectionSourceMap={},this._connectionTargetMap={},this.groupMap={}}}]),o}(),Mu=function(){function o(a,n){$(this,o),this.instance=a,this.entries=n}return J(o,[{key:"length",get:function(){return this.entries.length}},{key:"each",value:function(n){return K(this.entries,function(i){return n(i)}),this}},{key:"get",value:function(n){return this.entries[n]}},{key:"addClass",value:function(n,i){return this.each(function(e){return e.addClass(n,i)}),this}},{key:"removeClass",value:function(n,i){return this.each(function(e){return e.removeClass(n,i)}),this}},{key:"removeAllOverlays",value:function(){return this.each(function(n){return n.removeAllOverlays()}),this}},{key:"setLabel",value:function(n){return this.each(function(i){return i.setLabel(n)}),this}},{key:"clear",value:function(){return this.entries.length=0,this}},{key:"map",value:function(n){var i=[];return this.each(function(e){return i.push(n(e))}),i}},{key:"addOverlay",value:function(n){return this.each(function(i){return i.addOverlay(n)}),this}},{key:"removeOverlay",value:function(n){return this.each(function(i){return i.removeOverlay(n)}),this}},{key:"removeOverlays",value:function(){return this.each(function(n){return n.removeOverlays()}),this}},{key:"showOverlay",value:function(n){return this.each(function(i){return i.showOverlay(n)}),this}},{key:"hideOverlay",value:function(n){return this.each(function(i){return i.hideOverlay(n)}),this}},{key:"setPaintStyle",value:function(n){return this.each(function(i){return i.setPaintStyle(n)}),this}},{key:"setHoverPaintStyle",value:function(n){return this.each(function(i){return i.setHoverPaintStyle(n)}),this}},{key:"setSuspendEvents",value:function(n){return this.each(function(i){return i.setSuspendEvents(n)}),this}},{key:"setParameter",value:function(n,i){return this.each(function(e){return e.parameters[n]=i}),this}},{key:"setParameters",value:function(n){return this.each(function(i){return i.parameters=n}),this}},{key:"setVisible",value:function(n){return this.each(function(i){return i.setVisible(n)}),this}},{key:"addType",value:function(n){return this.each(function(i){return i.addType(n)}),this}},{key:"toggleType",value:function(n){return this.each(function(i){return i.toggleType(n)}),this}},{key:"removeType",value:function(n){return this.each(function(i){return i.removeType(n)}),this}},{key:"bind",value:function(n,i){return this.each(function(e){return e.bind(n,i)}),this}},{key:"unbind",value:function(n,i){return this.each(function(e){return e.unbind(n,i)}),this}},{key:"setHover",value:function(n){var i=this;return this.each(function(e){return i.instance.setHover(e,n)}),this}}]),o}(),Wv=function(o){Ee(n,o);var a=be(n);function n(){return $(this,n),a.apply(this,arguments)}return J(n,[{key:"setEnabled",value:function(e){return this.each(function(t){return t.enabled=e}),this}},{key:"setAnchor",value:function(e){return this.each(function(t){return t.setAnchor(e)}),this}},{key:"deleteEveryConnection",value:function(){return this.each(function(e){return e.deleteEveryConnection()}),this}},{key:"deleteAll",value:function(){var e=this;return this.each(function(t){return e.instance.deleteEndpoint(t)}),this.clear(),this}}]),n}(Mu),Kv=function(o){Ee(n,o);var a=be(n);function n(){return $(this,n),a.apply(this,arguments)}return J(n,[{key:"setDetachable",value:function(e){return this.each(function(t){return t.setDetachable(e)}),this}},{key:"setReattach",value:function(e){return this.each(function(t){return t.setReattach(e)}),this}},{key:"setConnector",value:function(e){return this.each(function(t){return t._setConnector(e)}),this}},{key:"deleteAll",value:function(){var e=this;this.each(function(t){return e.instance.deleteConnection(t)}),this.clear()}},{key:"repaint",value:function(){var e=this;return this.each(function(t){return e.instance._paintConnection(t)}),this}}]),n}(Mu),zv=function o(){$(this,o),h(this,"affectedElements",new Set)};function zs(){return{x:0,y:0,w:0,h:0,r:0,c:{x:0,y:0},x2:0,y2:0,t:{x:0,y:0,c:{x:0,y:0},w:0,h:0,r:0,x2:0,y2:0,cr:0,sr:0},dirty:!0}}function Zv(o,a,n,i,e){var t={x:o+n/2,y:a+i/2},r=Math.cos(e/360*Math.PI*2),s=Math.sin(e/360*Math.PI*2),l=function(S,C){return{x:t.x+Math.round((S-t.x)*r-(C-t.y)*s),y:t.y+Math.round((C-t.y)*r-(S-t.x)*s)}},u=l(o,a),c=l(o+n,a),d=l(o+n,a+i),f=l(o,a+i),v=l(o+n/2,a+i/2),p=Math.min(u.x,c.x,d.x,f.x),y=Math.max(u.x,c.x,d.x,f.x),g=Math.min(u.y,c.y,d.y,f.y),E=Math.max(u.y,c.y,d.y,f.y);return{x:p,y:g,w:y-p,h:E-g,c:v,r:e,x2:y,y2:E,cr:r,sr:s}}var so=function(a,n){var i=0;return n[1]>a[1]?i=-1:n[1]<a[1]&&(i=1),i},Zs=function(a,n){return so(a,n)*-1};function Oi(o,a,n,i){wd([o,a],n,so,i)}function qt(o,a){var n=un(a,function(i){return i[0]===o});n>-1&&a.splice(n,1)}var Jv=function(o){Ee(n,o);var a=be(n);function n(i){var e;return $(this,n),e=a.call(this),e.instance=i,h(m(e),"_currentTransaction",null),h(m(e),"_sortedElements",{xmin:[],xmax:[],ymin:[],ymax:[]}),h(m(e),"_elementMap",new Map),h(m(e),"_transformedElementMap",new Map),h(m(e),"_bounds",{minx:0,maxx:0,miny:0,maxy:0}),e}return J(n,[{key:"_updateBounds",value:function(e,t,r){t!=null&&(qt(e,this._sortedElements.xmin),qt(e,this._sortedElements.xmax),qt(e,this._sortedElements.ymin),qt(e,this._sortedElements.ymax),Oi(e,t.t.x,this._sortedElements.xmin,!1),Oi(e,t.t.x+t.t.w,this._sortedElements.xmax,!0),Oi(e,t.t.y,this._sortedElements.ymin,!1),Oi(e,t.t.y+t.t.h,this._sortedElements.ymax,!0),r!==!0&&this._recalculateBounds())}},{key:"_recalculateBounds",value:function(){this._bounds.minx=this._sortedElements.xmin.length>0?this._sortedElements.xmin[0][1]:0,this._bounds.maxx=this._sortedElements.xmax.length>0?this._sortedElements.xmax[0][1]:0,this._bounds.miny=this._sortedElements.ymin.length>0?this._sortedElements.ymin[0][1]:0,this._bounds.maxy=this._sortedElements.ymax.length>0?this._sortedElements.ymax[0][1]:0}},{key:"recomputeBounds",value:function(){var e=this;this._sortedElements.xmin.length=0,this._sortedElements.xmax.length=0,this._sortedElements.ymin.length=0,this._sortedElements.ymax.length=0,this._elementMap.forEach(function(t,r){e._sortedElements.xmin.push([r,t.t.x]),e._sortedElements.xmax.push([r,t.t.x+t.t.w]),e._sortedElements.ymin.push([r,t.t.y]),e._sortedElements.ymax.push([r,t.t.y+t.t.h])}),this._sortedElements.xmin.sort(so),this._sortedElements.ymin.sort(so),this._sortedElements.xmax.sort(Zs),this._sortedElements.ymax.sort(Zs),this._recalculateBounds()}},{key:"_finaliseUpdate",value:function(e,t,r){t.t=Zv(t.x,t.y,t.w,t.h,t.r),this._transformedElementMap.set(e,t.t),r!==!0&&this._updateBounds(e,t,r)}},{key:"shouldFireEvent",value:function(e,t,r){return!0}},{key:"startTransaction",value:function(){if(this._currentTransaction!=null)throw new Error("Viewport: cannot start transaction; a transaction is currently active.");this._currentTransaction=new zv}},{key:"endTransaction",value:function(){var e=this;this._currentTransaction!=null&&(this._currentTransaction.affectedElements.forEach(function(t){var r=e.getPosition(t);e._finaliseUpdate(t,r,!0)}),this.recomputeBounds(),this._currentTransaction=null)}},{key:"updateElements",value:function(e){var t=this;K(e,function(r){return t.updateElement(r.id,r.x,r.y,r.width,r.height,r.rotation)})}},{key:"updateElement",value:function(e,t,r,s,l,u,c){var d=vs(this._elementMap,e,zs);return d.dirty=t==null&&d.x==null||r==null&&d.y==null||s==null&&d.w==null||l==null&&d.h==null,t!=null&&(d.x=t),r!=null&&(d.y=r),s!=null&&(d.w=s),l!=null&&(d.h=l),u!=null&&(d.r=u||0),d.c.x=d.x+d.w/2,d.c.y=d.y+d.h/2,d.x2=d.x+d.w,d.y2=d.y+d.h,this._currentTransaction==null?this._finaliseUpdate(e,d,c):this._currentTransaction.affectedElements.add(e),d}},{key:"refreshElement",value:function(e,t){var r=this.instance.getManagedElements(),s=r[e]?r[e].el:null;if(s!=null){var l=this.getSize(s),u=this.getOffset(s);return this.updateElement(e,u.x,u.y,l.w,l.h,null,t)}else return null}},{key:"getSize",value:function(e){return this.instance.getSize(e)}},{key:"getOffset",value:function(e){return this.instance.getOffset(e)}},{key:"registerElement",value:function(e,t){return this.updateElement(e,0,0,0,0,0,t)}},{key:"addElement",value:function(e,t,r,s,l,u){return this.updateElement(e,t,r,s,l,u)}},{key:"rotateElement",value:function(e,t){var r=vs(this._elementMap,e,zs);return r.r=t||0,this._finaliseUpdate(e,r),r}},{key:"getBoundsWidth",value:function(){return this._bounds.maxx-this._bounds.minx}},{key:"getBoundsHeight",value:function(){return this._bounds.maxy-this._bounds.miny}},{key:"getX",value:function(){return this._bounds.minx}},{key:"getY",value:function(){return this._bounds.miny}},{key:"setSize",value:function(e,t,r){if(this._elementMap.has(e))return this.updateElement(e,null,null,t,r,null)}},{key:"setPosition",value:function(e,t,r){if(this._elementMap.has(e))return this.updateElement(e,t,r,null,null,null)}},{key:"reset",value:function(){this._sortedElements.xmin.length=0,this._sortedElements.xmax.length=0,this._sortedElements.ymin.length=0,this._sortedElements.ymax.length=0,this._elementMap.clear(),this._transformedElementMap.clear(),this._recalculateBounds()}},{key:"remove",value:function(e){qt(e,this._sortedElements.xmin),qt(e,this._sortedElements.xmax),qt(e,this._sortedElements.ymin),qt(e,this._sortedElements.ymax),this._elementMap.delete(e),this._transformedElementMap.delete(e),this._recalculateBounds()}},{key:"getPosition",value:function(e){return this._elementMap.get(e)}},{key:"getElements",value:function(){return this._elementMap}},{key:"isEmpty",value:function(){return this._elementMap.size===0}}]),n}(si),Kn;function Qv(o,a,n,i,e){for(var t=n?o.w:o.h,r=n?o.h:o.w,s=[],l=t/(a.length+1),u=0;u<a.length;u++){var c=(u+1)*l,d=i*r;e&&(c=t-c);var f=n?c:d,v=o.x+f,p=f/o.w,y=n?d:c,g=o.y+y,E=y/o.h;if(o.r!==0&&o.r!=null){var b=Zi({x:v,y:g},o.c,o.r);v=b.x,g=b.y}s.push({x:v,y:g,xLoc:p,yLoc:E,c:a[u].c})}return s}function Js(o,a){return a.theta-o.theta}function Qs(o,a){var n=o.theta<0?-Math.PI-o.theta:Math.PI-o.theta,i=a.theta<0?-Math.PI-a.theta:Math.PI-a.theta;return n-i}var qv=(Kn={},h(Kn,He,Qs),h(Kn,et,Js),h(Kn,lt,Js),h(Kn,rt,Qs),Kn);function en(o){return o.isContinuous===!0}function qs(o){return o.isContinuous===!0}function ep(o){return o.locations.length>1}function el(o){return[o.currentLocation,o.locations[o.currentLocation]]}var tp=function(){function o(a){var n=this;$(this,o),this.instance=a,h(this,"anchorLists",new Map),h(this,"anchorLocations",new Map),a.bind(Ma,function(i){i.sourceEndpoint._anchor.isContinuous&&n._removeEndpointFromAnchorLists(i.sourceEndpoint),i.targetEndpoint._anchor.isContinuous&&n._removeEndpointFromAnchorLists(i.targetEndpoint)}),a.bind(nu,function(i){n._removeEndpointFromAnchorLists(i)})}return J(o,[{key:"getAnchorOrientation",value:function(n){var i=this.anchorLocations.get(n.id);return i?[i.ox,i.oy]:[0,0]}},{key:"_distance",value:function(n,i,e,t,r,s,l){var u=t.x+n.x*r.w,c=t.y+n.y*r.h,d=t.x+r.w/2,f=t.y+r.h/2;if(s!=null&&s.length>0){var v=this.instance._applyRotations([u,c,0,0],s);u=v.x,c=v.y}return Math.sqrt(Math.pow(i-u,2)+Math.pow(e-c,2))+Math.sqrt(Math.pow(d-u,2)+Math.pow(f-c,2))}},{key:"_anchorSelector",value:function(n,i,e,t,r,s,l){for(var u=e.x+t.w/2,c=e.y+t.h/2,d=-1,f=1/0,v=0;v<l.length;v++){var p=this._distance(l[v],u,c,n,i,r,s);p<f&&(d=v+0,f=p)}return[d,l[d]]}},{key:"_floatingAnchorCompute",value:function(n,i){var e=i.xy,t={curX:e.x+n.size.w/2,curY:e.y+n.size.h/2,x:0,y:0,ox:0,oy:0};return this._setComputedPosition(n,t)}},{key:"_setComputedPosition",value:function(n,i,e){return this.anchorLocations.set(n.id,i),n.computedPosition=i,e&&(n.timestamp=e),i}},{key:"_computeSingleLocation",value:function(n,i,e,t){var r,s=t.rotation,l={curX:i.x+n.x*e.w+n.offx,curY:i.y+n.y*e.h+n.offy,x:n.x,y:n.y,ox:0,oy:0};if(s!=null&&s.length>0){var u=[n.iox,n.ioy],c={x:l.curX,y:l.curY,cr:0,sr:0};K(s,function(d){c=Zi(c,d.c,d.r);var f=[Math.round(u[0]*c.cr-u[1]*c.sr),Math.round(u[1]*c.cr+u[0]*c.sr)];u=f.slice()}),n.ox=u[0],n.oy=u[1],r={curX:c.x,curY:c.y,x:n.x,y:n.y,ox:u[0],oy:u[1]}}else n.ox=n.iox,n.oy=n.ioy,r=W({ox:n.iox,oy:n.ioy},l);return r}},{key:"_singleAnchorCompute",value:function(n,i){var e=i.xy,t=i.wh,r=i.timestamp,s=this.anchorLocations.get(n.id);if(s!=null&&r&&r===n.timestamp)return s;var l=el(n),u=Ri(l,2);u[0];var c=u[1];return s=this._computeSingleLocation(c,e,t,i),this._setComputedPosition(n,s,r)}},{key:"_defaultAnchorCompute",value:function(n,i){var e;if(n.locations.length===1)return this._singleAnchorCompute(n,i);var t=i.xy,r=i.wh,s=i.txy,l=i.twh,u=el(n),c=Ri(u,2),d=c[0],f=c[1];if(n.locked||s==null||l==null)e=this._computeSingleLocation(f,t,r,i);else{var v=this._anchorSelector(t,r,s,l,i.rotation,i.tRotation,n.locations),p=Ri(v,2),y=p[0],g=p[1];n.currentLocation=y,y!==d&&(n.cssClass=g.cls||n.cssClass,i.element._anchorLocationChanged(n)),e=this._computeSingleLocation(g,t,r,i)}return this._setComputedPosition(n,e,i.timestamp)}},{key:"_placeAnchors",value:function(n,i){var e=this,t=this.instance.viewport.getPosition(n),r=function(l,u,c,d,f,v){if(c.length>0)for(var p=c.sort(qv[l]),y=l===et||l===He,g=Qv(t,p,d,f,y),E=0;E<g.length;E++){var b=g[E].c,S=b.endpoints[0].elementId===n,C=S?b.endpoints[0]:b.endpoints[1];e._setComputedPosition(C._anchor,{curX:g[E].x,curY:g[E].y,x:g[E].xLoc,y:g[E].yLoc,ox:v[0],oy:v[1]})}};r(lt,t,i.bottom,!0,1,[0,1]),r(He,t,i.top,!0,0,[0,-1]),r(rt,t,i.left,!1,0,[-1,0]),r(et,t,i.right,!1,1,[1,0])}},{key:"_updateAnchorList",value:function(n,i,e,t,r,s,l,u,c,d,f){var v=t.endpoints[l],p=v.id,y=[1,0][l],g={theta:i,order:e,c:t,b:r,elId:s,epId:p},E=n[c],b=v._continuousAnchorEdge?n[v._continuousAnchorEdge]:null,S;if(b){var C=un(b,function(P){return P.epId===p});if(C!==-1){b.splice(C,1);for(var x=0;x<b.length;x++)S=b[x].c,S.placeholder!==!0&&d.add(S),f.add(b[x].c.endpoints[l]),f.add(b[x].c.endpoints[y])}}for(var T=0;T<E.length;T++)S=E[T].c,S.placeholder!==!0&&d.add(S),f.add(E[T].c.endpoints[l]),f.add(E[T].c.endpoints[y]);{var O=u?0:E.length;E.splice(O,0,g)}v._continuousAnchorEdge=c}},{key:"_removeEndpointFromAnchorLists",value:function(n){var i=this.anchorLists.get(n.elementId),e=0;(function(t,r){if(t){var s=function(u){return u.epId===r};Ze(t.top,s),Ze(t.left,s),Ze(t.bottom,s),Ze(t.right,s),e+=t.top.length,e+=t.left.length,e+=t.bottom.length,e+=t.right.length}})(i,n.id),e===0&&this.anchorLists.delete(n.elementId),this.anchorLocations.delete(n._anchor.id)}},{key:"computeAnchorLocation",value:function(n,i){var e;return en(n)?e=this.anchorLocations.get(n.id)||{curX:0,curY:0,x:0,y:0,ox:0,oy:0}:qs(n)?e=this._floatingAnchorCompute(n,i):e=this._defaultAnchorCompute(n,i),n.timestamp=i.timestamp,e}},{key:"computePath",value:function(n,i){var e=this.instance.viewport.getPosition(n.sourceId),t=this.instance.viewport.getPosition(n.targetId),r=n.endpoints[0],s=n.endpoints[1],l=this.getEndpointLocation(r,{xy:e,wh:e,element:r,timestamp:i,rotation:this.instance._getRotations(n.sourceId)}),u=this.getEndpointLocation(s,{xy:t,wh:t,element:s,timestamp:i,rotation:this.instance._getRotations(n.targetId)});n.connector.resetBounds(),n.connector.compute({sourcePos:l,targetPos:u,sourceEndpoint:n.endpoints[0],targetEndpoint:n.endpoints[1],strokeWidth:n.paintStyleInUse.strokeWidth,sourceInfo:e,targetInfo:t})}},{key:"getEndpointLocation",value:function(n,i){i=i||{};var e=n._anchor,t=this.anchorLocations.get(e.id);return(t==null||i.timestamp!=null&&e.timestamp!==i.timestamp)&&(t=this.computeAnchorLocation(e,i),this._setComputedPosition(e,t,i.timestamp)),t}},{key:"getEndpointOrientation",value:function(n){return n._anchor?this.getAnchorOrientation(n._anchor):[0,0]}},{key:"setAnchorOrientation",value:function(n,i){var e=this.anchorLocations.get(n.id);e!=null&&(e.ox=i[0],e.oy=i[1])}},{key:"isDynamicAnchor",value:function(n){return n._anchor?!en(n._anchor)&&n._anchor.locations.length>1:!1}},{key:"isFloating",value:function(n){return n._anchor?qs(n._anchor):!1}},{key:"prepareAnchor",value:function(n){return jr(n)}},{key:"redraw",value:function(n,i,e){var t=this,r=new Set,s=new Set,l=new Set;if(!this.instance._suspendDrawing){var u=this.instance.endpointsByElement[n]||[];i=i||Ke();for(var c={},d,f,v=0;v<u.length;v++)if(f=u[v],f.visible!==!1)if(s.add(f),d=f._anchor,f.connections.length===0)en(d)&&(this.anchorLists.has(n)||this.anchorLists.set(n,{top:[],right:[],bottom:[],left:[]}),this._updateAnchorList(this.anchorLists.get(n),-Math.PI/2,0,{endpoints:[f,f],placeholder:!0},!1,n,0,!1,ev(d),r,s),l.add(n));else for(var p=0;p<f.connections.length;p++){var y=f.connections[p],g=y.sourceId,E=y.targetId,b=en(y.endpoints[0]._anchor),S=en(y.endpoints[1]._anchor);if(b||S){var C=(y.endpoints[0]._anchor.faces||[]).join("-"),x=(y.endpoints[1]._anchor.faces||[]).join("-"),T=[g,C,E,x].join("-"),O=c[T],P=y.sourceId===n?1:0;b&&!this.anchorLists.has(g)&&this.anchorLists.set(g,{top:[],right:[],bottom:[],left:[]}),S&&!this.anchorLists.has(E)&&this.anchorLists.set(E,{top:[],right:[],bottom:[],left:[]});var A=this.instance.viewport.getPosition(E),_=this.instance.viewport.getPosition(g);if(E===g&&(b||S))this._updateAnchorList(this.anchorLists.get(g),-Math.PI/2,0,y,!1,E,0,!1,He,r,s),this._updateAnchorList(this.anchorLists.get(E),-Math.PI/2,0,y,!1,g,1,!1,He,r,s);else{var R=this.instance._getRotations(g),M=this.instance._getRotations(E);O||(O=this._calculateOrientation(g,E,_,A,y.endpoints[0]._anchor,y.endpoints[1]._anchor,R,M),c[T]=O),b&&this._updateAnchorList(this.anchorLists.get(g),O.theta,0,y,!1,E,0,!1,O.a[0],r,s),S&&this._updateAnchorList(this.anchorLists.get(E),O.theta2,-1,y,!0,g,1,!0,O.a[1],r,s)}b&&l.add(g),S&&l.add(E),r.add(y),(b&&P===0||S&&P===1)&&s.add(y.endpoints[P])}else{var F=f.connections[p].endpoints[y.sourceId===n?1:0],L=F._anchor;if(ep(L)){this.instance._paintEndpoint(F,{elementWithPrecedence:n,timestamp:i}),r.add(f.connections[p]);for(var k=0;k<F.connections.length;k++)F.connections[k]!==f.connections[p]&&r.add(F.connections[k])}else r.add(f.connections[p])}}l.forEach(function(N){t._placeAnchors(N,t.anchorLists.get(N))}),s.forEach(function(N){var V=t.instance.viewport.getPosition(N.elementId);t.instance._paintEndpoint(N,{timestamp:i,offset:V})}),r.forEach(function(N){t.instance._paintConnection(N,{timestamp:i})})}return{c:r,e:s}}},{key:"reset",value:function(){this.anchorLocations.clear(),this.anchorLists.clear()}},{key:"setAnchor",value:function(n,i){i!=null&&(n._anchor=i)}},{key:"setConnectionAnchors",value:function(n,i){n.endpoints[0]._anchor=i[0],n.endpoints[1]._anchor=i[1]}},{key:"_calculateOrientation",value:function(n,i,e,t,r,s,l,u){var c=this,d={HORIZONTAL:"horizontal",VERTICAL:"vertical",DIAGONAL:"diagonal",IDENTITY:"identity"};if(n===i)return{orientation:d.IDENTITY,a:[He,He]};var f=Math.atan2(t.c.y-e.c.y,t.c.x-e.c.x),v=Math.atan2(e.c.y-t.c.y,e.c.x-t.c.x),p=[],y={};(function(T,O){for(var P=0;P<T.length;P++){var A;if(y[T[P]]=(A={},h(A,rt,{x:O[P][0].x,y:O[P][0].c.y}),h(A,et,{x:O[P][0].x+O[P][0].w,y:O[P][0].c.y}),h(A,He,{x:O[P][0].c.x,y:O[P][0].y}),h(A,lt,{x:O[P][0].c.x,y:O[P][0].y+O[P][0].h}),A),O[P][1]!=null&&O[P][1].length>0)for(var _ in y[T[P]])y[T[P]][_]=c.instance._applyRotationsXY(y[T[P]][_],O[P][1])}})([Qo,Zl],[[e,l],[t,u]]);for(var g=[He,rt,et,lt],E=0;E<g.length;E++)for(var b=0;b<g.length;b++)p.push({source:g[E],target:g[b],dist:ra(y.source[g[E]],y.target[g[b]])});p.sort(function(T,O){if(T.dist<O.dist)return-1;if(O.dist<T.dist)return 1;var P,A=(P={},h(P,rt,0),h(P,He,1),h(P,et,2),h(P,lt,3),P),_=A[T.source],R=A[O.source],M=A[T.target],F=A[O.target];return _<R?-1:R<_?1:M<F?-1:F<M?1:0});for(var S=p[0].source,C=p[0].target,x=0;x<p.length&&(en(r)&&r.locked?S=r.currentFace:!r.isContinuous||ws(r,p[x].source)?S=p[x].source:S=null,s.isContinuous&&s.locked?C=s.currentFace:!s.isContinuous||ws(s,p[x].target)?C=p[x].target:C=null,!(S!=null&&C!=null));x++);return r.isContinuous&&this.setCurrentFace(r,S),s.isContinuous&&this.setCurrentFace(s,C),{a:[S,C],theta:f,theta2:v}}},{key:"setCurrentFace",value:function(n,i,e){n.currentFace=i,e&&n.lockedFace!=null&&(n.lockedFace=n.currentFace)}},{key:"lock",value:function(n){n.locked=!0,en(n)&&(n.lockedFace=n.currentFace)}},{key:"unlock",value:function(n){n.locked=!1,en(n)&&(n.lockedFace=null)}},{key:"selectAnchorLocation",value:function(n,i){var e=un(n.locations,function(t){return t.x===i.x&&t.y===i.y});return e!==-1?(n.currentLocation=e,!0):!1}},{key:"lockCurrentAxis",value:function(n){n.currentFace!=null&&(n.lockedAxis=n.currentFace===rt||n.currentFace===et?Jh:Qh)}},{key:"unlockCurrentAxis",value:function(n){n.lockedAxis=null}},{key:"anchorsEqual",value:function(n,i){if(!n||!i)return!1;var e=n.locations[n.currentLocation],t=i.locations[i.currentLocation];return e.x===t.x&&e.y===t.y&&e.offx===t.offx&&e.offy===t.offy&&e.ox===t.ox&&e.oy===t.oy}}]),o}(),tl={},li={get:function(a,n,i){var e=tl[n];if(e)return new e(a,i);throw{message:"jsPlumb: unknown connector type '"+n+"'"}},register:function(a,n){tl[a]=n}},Dn=function(o){Ee(n,o);var a=be(n);function n(i){var e;return $(this,n),e=a.call(this,i),h(m(e),"length",void 0),h(m(e),"m",void 0),h(m(e),"m2",void 0),h(m(e),"type",n.segmentType),e._setCoordinates({x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2}),e}return J(n,[{key:"getPath",value:function(e){return(e?"M "+this.x1+" "+this.y1+" ":"")+"L "+this.x2+" "+this.y2}},{key:"_recalc",value:function(){this.length=Math.sqrt(Math.pow(this.x2-this.x1,2)+Math.pow(this.y2-this.y1,2)),this.m=cr({x:this.x1,y:this.y1},{x:this.x2,y:this.y2}),this.m2=-1/this.m,this.extents={xmin:Math.min(this.x1,this.x2),ymin:Math.min(this.y1,this.y2),xmax:Math.max(this.x1,this.x2),ymax:Math.max(this.y1,this.y2)}}},{key:"getLength",value:function(){return this.length}},{key:"getGradient",value:function(){return this.m}},{key:"_setCoordinates",value:function(e){this.x1=e.x1,this.y1=e.y1,this.x2=e.x2,this.y2=e.y2,this._recalc()}},{key:"pointOnPath",value:function(e,t){if(e===0&&!t)return{x:this.x1,y:this.y1};if(e===1&&!t)return{x:this.x2,y:this.y2};var r=t?e>0?e:this.length+e:e*this.length;return Cn({x:this.x1,y:this.y1},{x:this.x2,y:this.y2},r)}},{key:"gradientAtPoint",value:function(e,t){return this.m}},{key:"pointAlongPathFrom",value:function(e,t,r){var s=this.pointOnPath(e,r),l=t<=0?{x:this.x1,y:this.y1}:{x:this.x2,y:this.y2};return t<=0&&Math.abs(t)>1&&(t*=-1),Cn(s,l,t)}},{key:"within",value:function(e,t,r){return r>=Math.min(e,t)&&r<=Math.max(e,t)}},{key:"closest",value:function(e,t,r){return Math.abs(r-e)<Math.abs(r-t)?e:t}},{key:"findClosestPointOnPath",value:function(e,t){var r={d:1/0,x:null,y:null,l:null,x1:this.x1,x2:this.x2,y1:this.y1,y2:this.y2};if(this.m===0)r.y=this.y1,r.x=this.within(this.x1,this.x2,e)?e:this.closest(this.x1,this.x2,e);else if(this.m===1/0||this.m===-1/0)r.x=this.x1,r.y=this.within(this.y1,this.y2,t)?t:this.closest(this.y1,this.y2,t);else{var s=this.y1-this.m*this.x1,l=t-this.m2*e,u=(l-s)/(this.m-this.m2),c=this.m*u+s;r.x=this.within(this.x1,this.x2,u)?u:this.closest(this.x1,this.x2,u),r.y=this.within(this.y1,this.y2,c)?c:this.closest(this.y1,this.y2,c)}var d=ra({x:r.x,y:r.y},{x:this.x1,y:this.y1});return r.d=ra({x:e,y:t},r),r.l=d/length,r}},{key:"_pointLiesBetween",value:function(e,t,r){return r>t?t<=e&&e<=r:t>=e&&e>=r}},{key:"lineIntersection",value:function(e,t,r,s){var l=Math.abs(cr({x:e,y:t},{x:r,y:s})),u=Math.abs(this.m),c=u===1/0?this.x1:this.y1-u*this.x1,d=[],f=l===1/0?e:t-l*e;if(l!==u)if(l===1/0&&u===0)this._pointLiesBetween(e,this.x1,this.x2)&&this._pointLiesBetween(this.y1,t,s)&&d.push({x:e,y:this.y1});else if(l===0&&u===1/0)this._pointLiesBetween(t,this.y1,this.y2)&&this._pointLiesBetween(this.x1,e,r)&&d.push({x:this.x1,y:t});else{var v,p;l===1/0?(v=e,this._pointLiesBetween(v,this.x1,this.x2)&&(p=u*e+c,this._pointLiesBetween(p,t,s)&&d.push({x:v,y:p}))):l===0?(p=t,this._pointLiesBetween(p,this.y1,this.y2)&&(v=(t-c)/u,this._pointLiesBetween(v,e,r)&&d.push({x:v,y:p}))):(v=(f-c)/(u-l),p=u*v+c,this._pointLiesBetween(v,this.x1,this.x2)&&this._pointLiesBetween(p,this.y1,this.y2)&&d.push({x:v,y:p}))}return d}},{key:"boxIntersection",value:function(e,t,r,s){var l=[];return l.push.apply(l,this.lineIntersection(e,t,e+r,t)),l.push.apply(l,this.lineIntersection(e+r,t,e+r,t+s)),l.push.apply(l,this.lineIntersection(e+r,t+s,e,t+s)),l.push.apply(l,this.lineIntersection(e,t+s,e,t)),l}}]),n}(Na);h(Dn,"segmentType","Straight");var lo=function(o){Ee(n,o);var a=be(n);function n(){var i;$(this,n);for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return i=a.call.apply(a,[this].concat(t)),h(m(i),"type",n.type),i}return J(n,[{key:"getDefaultStubs",value:function(){return[0,0]}},{key:"_compute",value:function(e,t){this._addSegment(Dn,{x1:e.sx,y1:e.sy,x2:e.startStubX,y2:e.startStubY}),this._addSegment(Dn,{x1:e.startStubX,y1:e.startStubY,x2:e.endStubX,y2:e.endStubY}),this._addSegment(Dn,{x1:e.endStubX,y1:e.endStubY,x2:e.tx,y2:e.ty}),this.geometry={source:t.sourcePos,target:t.targetPos}}},{key:"transformGeometry",value:function(e,t,r){return{source:this.transformAnchorPlacement(e.source,t,r),target:this.transformAnchorPlacement(e.target,t,r)}}}]),n}(yo);h(lo,"type","Straight");function np(o,a){for(var n=o.scope.split(/\s/),i=a.scope.split(/\s/),e=0;e<n.length;e++)for(var t=0;t<i.length;t++)if(i[t]===n[e])return!0;return!1}function mn(o,a,n){var i=[],e=function(s){return Be(s)?s:o.getId(s)};if(a)if(typeof a=="string"){if(a==="*")return a;i.push(a)}else if(n)i=a;else if(a.length!=null){var t;(t=i).push.apply(t,ar(ar(a).map(e)))}else i.push(e(a));return i}function rp(o,a){o!=null&&o.endpoints.push(a)}function ip(o,a){o!=null&&Ze(o.endpoints,function(n){return n===a})}function Ai(o,a,n){a!=null&&(a.connections.push(o),a.connections.length===1&&o.instance.addClass(o.source,o.instance.connectedClass)),n!=null&&(a==null||o.sourceId!==o.targetId)&&(n.connections.push(o),n.connections.length===1&&o.instance.addClass(o.target,o.instance.connectedClass))}function Di(o,a,n){if(a!=null){var i=a.connections.length;Ze(a.connections,function(t){return o.id===t.id}),i>0&&a.connections.length===0&&o.instance.removeClass(o.source,o.instance.connectedClass)}if(n!=null){var e=n.connections.length;(a==null||o.sourceId!==o.targetId)&&Ze(n.connections,function(t){return o.id===t.id}),e>0&&n.connections.length===0&&o.instance.removeClass(o.target,o.instance.connectedClass)}}var op=function(o){Ee(n,o);var a=be(n);function n(i,e){var t;return $(this,n),t=a.call(this),t._instanceIndex=i,h(m(t),"defaults",void 0),h(m(t),"_initialDefaults",{}),h(m(t),"isConnectionBeingDragged",!1),h(m(t),"currentlyDragging",!1),h(m(t),"hoverSuspended",!1),h(m(t),"_suspendDrawing",!1),h(m(t),"_suspendedAt",null),h(m(t),"connectorClass",Da),h(m(t),"connectorOutlineClass",Yd),h(m(t),"connectedClass",Xd),h(m(t),"endpointClass",rr),h(m(t),"endpointConnectedClass",$d),h(m(t),"endpointFullClass",Wd),h(m(t),"endpointFloatingClass",Ia),h(m(t),"endpointDropAllowedClass",Kd),h(m(t),"endpointDropForbiddenClass",zd),h(m(t),"endpointAnchorClassPrefix",Zd),h(m(t),"overlayClass",po),h(m(t),"connections",[]),h(m(t),"endpointsByElement",{}),h(m(t),"endpointsByUUID",new Map),h(m(t),"sourceSelectors",[]),h(m(t),"targetSelectors",[]),h(m(t),"allowNestedGroups",void 0),h(m(t),"_curIdStamp",1),h(m(t),"viewport",new Jv(m(t))),h(m(t),"router",void 0),h(m(t),"groupManager",void 0),h(m(t),"_connectionTypes",new Map),h(m(t),"_endpointTypes",new Map),h(m(t),"_container",void 0),h(m(t),"_managedElements",{}),h(m(t),"DEFAULT_SCOPE",void 0),h(m(t),"_zoom",1),t.defaults={anchor:Gt.Bottom,anchors:[null,null],connectionsDetachable:!0,connectionOverlays:[],connector:lo.type,container:null,endpoint:Nn.type,endpointOverlays:[],endpoints:[null,null],endpointStyle:{fill:"#456"},endpointStyles:[null,null],endpointHoverStyle:null,endpointHoverStyles:[null,null],hoverPaintStyle:null,listStyle:{},maxConnections:1,paintStyle:{strokeWidth:2,stroke:"#456"},reattachConnections:!1,scope:"jsplumb_defaultscope",allowNestedGroups:!0},e&&W(t.defaults,e),W(t._initialDefaults,t.defaults),t._initialDefaults[Wn]!=null&&(t._initialDefaults[Wn].strokeWidth=t._initialDefaults[Wn].strokeWidth||2),t.DEFAULT_SCOPE=t.defaults[Hv],t.allowNestedGroups=t._initialDefaults[Vv]!==!1,t.router=new tp(m(t)),t.groupManager=new $v(m(t)),t.setContainer(t._initialDefaults.container),t}return J(n,[{key:"defaultScope",get:function(){return this.DEFAULT_SCOPE}},{key:"currentZoom",get:function(){return this._zoom}},{key:"areDefaultAnchorsSet",value:function(){return this.validAnchorsSpec(this.defaults.anchors)}},{key:"validAnchorsSpec",value:function(e){return e!=null&&e[0]!=null&&e[1]!=null}},{key:"getContainer",value:function(){return this._container}},{key:"setZoom",value:function(e,t){return this._zoom=e,this.fire(au,this._zoom),t&&this.repaintEverything(),!0}},{key:"_idstamp",value:function(){return""+this._curIdStamp++}},{key:"checkCondition",value:function(e,t){var r=this.getListener(e),s=!0;if(r&&r.length>0){var l=Array.prototype.slice.call(arguments,1);try{for(var u=0,c=r.length;u<c;u++)s=s&&r[u].apply(r[u],l)}catch(d){We("cannot check condition ["+e+"]"+d)}}return s}},{key:"getId",value:function(e,t){if(e==null)return null;var r=this.getAttribute(e,rn);return(!r||r==="undefined")&&(arguments.length===2&&arguments[1]!==void 0?r=t:(arguments.length===1||arguments.length===3&&!arguments[2])&&(r="jsplumb-"+this._instanceIndex+"-"+this._idstamp()),this.setAttribute(e,rn,r)),r}},{key:"getConnections",value:function(e,t){e?e.constructor===String&&(e={scope:e}):e={};for(var r=e.scope||this.defaultScope,s=mn(this,r,!0),l=mn(this,e.source),u=mn(this,e.target),c=!t&&s.length>1?{}:[],d=function(b,S){if(!t&&s.length>1){var C=c[b];C==null&&(C=c[b]=[]),C.push(S)}else c.push(S)},f=0,v=this.connections.length;f<v;f++){var p=this.connections[f],y=p.proxies&&p.proxies[0]?p.proxies[0].originalEp.elementId:p.sourceId,g=p.proxies&&p.proxies[1]?p.proxies[1].originalEp.elementId:p.targetId;pn(s,p.scope)&&pn(l,y)&&pn(u,g)&&d(p.scope,p)}return c}},{key:"select",value:function(e){return e=e||{},e.scope=e.scope||"*",new Kv(this,e.connections||this.getConnections(e,!0))}},{key:"selectEndpoints",value:function(e){e=e||{},e.scope=e.scope||Tn;var t=!e.element&&!e.source&&!e.target,r=t?Tn:mn(this,e.element),s=t?Tn:mn(this,e.source),l=t?Tn:mn(this,e.target),u=mn(this,e.scope,!0),c=[];for(var d in this.endpointsByElement){var f=pn(r,d,!0),v=pn(s,d,!0),p=s!=="*",y=pn(l,d,!0),g=l!=="*";if(f||v||y)e:for(var E=0,b=this.endpointsByElement[d].length;E<b;E++){var S=this.endpointsByElement[d][E];if(pn(u,S.scope,!0)){var C=p&&s.length>0&&!S.isSource,x=g&&l.length>0&&!S.isTarget;if(C||x)continue e;c.push(S)}}}return new Wv(this,c)}},{key:"setContainer",value:function(e){this._container=e,this.fire(Qd,this._container)}},{key:"_set",value:function(e,t,r){var s=[{el:"source",elId:"sourceId"},{el:"target",elId:"targetId"}],l,u=s[r],c=e[u.elId],d,f=e.endpoints[r],v={index:r,originalEndpoint:f,originalSourceId:r===0?c:e.sourceId,newSourceId:e.sourceId,originalTargetId:r===1?c:e.targetId,newTargetId:e.targetId,connection:e,newEndpoint:f};return t instanceof tr?(l=t,l.addConnection(e)):(d=this.getId(t),d===e[u.elId]?l=null:l=e.makeEndpoint(r===0,t,d)),l!=null&&(v.newEndpoint=l,f.detachFromConnection(e),e.endpoints[r]=l,e[u.el]=l.element,e[u.elId]=l.elementId,v[r===0?"newSourceId":"newTargetId"]=l.elementId,this.fireMoveEvent(v),this._paintConnection(e)),v}},{key:"setSource",value:function(e,t){Di(e,this._managedElements[e.sourceId]);var r=this._set(e,t,0);Ai(e,this._managedElements[r.newSourceId])}},{key:"setTarget",value:function(e,t){Di(e,this._managedElements[e.targetId]);var r=this._set(e,t,1);Ai(e,this._managedElements[r.newTargetId])}},{key:"setConnectionType",value:function(e,t,r){e.setType(t,r),this._paintConnection(e)}},{key:"isHoverSuspended",value:function(){return this.hoverSuspended}},{key:"setSuspendDrawing",value:function(e,t){var r=this._suspendDrawing;return this._suspendDrawing=e,e?this._suspendedAt=""+new Date().getTime():(this._suspendedAt=null,this.viewport.recomputeBounds()),t&&this.repaintEverything(),r}},{key:"getSuspendedAt",value:function(){return this._suspendedAt}},{key:"batch",value:function(e,t){var r=this._suspendDrawing===!0;r||this.setSuspendDrawing(!0),e(),r||this.setSuspendDrawing(!1,!t)}},{key:"each",value:function(e,t){if(e!=null){if(e.length!=null)for(var r=0;r<e.length;r++)t(e[r]);else t(e);return this}}},{key:"updateOffset",value:function(e){var t=e.elId;return e.recalc?this.viewport.refreshElement(t):this.viewport.getPosition(t)}},{key:"deleteConnection",value:function(e,t){if(e!=null&&e.deleted!==!0&&(t=t||{},t.force||Vl(!0,!1,[[e.endpoints[0],ir,[e]],[e.endpoints[1],ir,[e]],[e,ir,[e]],[this,ql,[lu,e]]]))){Di(e,this._managedElements[e.sourceId],this._managedElements[e.targetId]),this.fireDetachEvent(e,!e.pending&&t.fireEvent!==!1,t.originalEvent);var r=e.endpoints[0],s=e.endpoints[1];return r!==t.endpointToIgnore&&r.detachFromConnection(e,null,!0),s!==t.endpointToIgnore&&s.detachFromConnection(e,null,!0),Ze(this.connections,function(l){return e.id===l.id}),e.destroy(),r!==t.endpointToIgnore&&r.deleteOnEmpty&&r.connections.length===0&&this.deleteEndpoint(r),s!==t.endpointToIgnore&&s.deleteOnEmpty&&s.connections.length===0&&this.deleteEndpoint(s),!0}return!1}},{key:"deleteEveryConnection",value:function(e){var t=this;e=e||{};var r=this.connections.length,s=0;return this.batch(function(){for(var l=0;l<r;l++)s+=t.deleteConnection(t.connections[0],e)?1:0}),s}},{key:"deleteConnectionsForElement",value:function(e,t){var r=this.getId(e),s=this._managedElements[r];if(s)for(var l=s.connections.length,u=0;u<l;u++)this.deleteConnection(s.connections[0],t);return this}},{key:"fireDetachEvent",value:function(e,t,r){var s=e.id!=null,l=s?{connection:e,source:e.source,target:e.target,sourceId:e.sourceId,targetId:e.targetId,sourceEndpoint:e.endpoints[0],targetEndpoint:e.endpoints[1]}:e;t&&this.fire(tu,l,r),this.fire(Ma,l,r)}},{key:"fireMoveEvent",value:function(e,t){this.fire(wa,e,t)}},{key:"manageAll",value:function(e,t){for(var r=Be(e)?this.getSelector(this.getContainer(),e):e,s=0;s<r.length;s++)this.manage(r[s],null,t)}},{key:"manage",value:function(e,t,r){this.getAttribute(e,rn)==null&&(t=t||this.getAttribute(e,"id")||Ke(),this.setAttribute(e,rn,t));var s=this.getId(e);if(this._managedElements[s])r&&(this._managedElements[s].viewportElement=this.updateOffset({elId:s,timestamp:null,recalc:!0}));else{var l={el:e,endpoints:[],connections:[],rotation:0,data:{}};this._managedElements[s]=l,this._suspendDrawing?l.viewportElement=this.viewport.registerElement(s,!0):l.viewportElement=this.updateOffset({elId:s,recalc:!0}),this.fire(ru,{el:e})}return this._managedElements[s]}},{key:"getManagedData",value:function(e,t,r){if(this._managedElements[e]){var s=this._managedElements[e].data[t];return s!=null?s[r]:null}}},{key:"setManagedData",value:function(e,t,r,s){this._managedElements[e]&&(this._managedElements[e].data[t]=this._managedElements[e].data[t]||{},this._managedElements[e].data[t][r]=s)}},{key:"getManagedElement",value:function(e){return this._managedElements[e]?this._managedElements[e].el:null}},{key:"unmanage",value:function(e,t){var r=this;this.removeAllEndpoints(e,!0);var s=function(u){var c=r.getId(u);r.removeAttribute(u,rn),delete r._managedElements[c],r.viewport.remove(c),r.fire(ou,{el:u,id:c}),u&&t&&r._removeElement(u)};this._getAssociatedElements(e).map(s),s(e)}},{key:"rotate",value:function(e,t,r){var s=this.getId(e);return this._managedElements[s]&&(this._managedElements[s].rotation=t,this.viewport.rotateElement(s,t),r!==!0)?this.revalidate(e):{c:new Set,e:new Set}}},{key:"_getRotation",value:function(e){var t=this._managedElements[e];return t!=null&&t.rotation||0}},{key:"_getRotations",value:function(e){var t=this,r=[],s=this._managedElements[e],l=function u(c){if(c.group!=null){var d=t._managedElements[c.group];d!=null&&(r.push({r:d.viewportElement.r,c:d.viewportElement.c}),u(d))}};return s!=null&&(r.push({r:s.viewportElement.r||0,c:s.viewportElement.c}),l(s)),r}},{key:"_applyRotations",value:function(e,t){var r=e.slice(),s={x:r[0],y:r[1],cr:0,sr:0};return K(t,function(l){s=Zi(s,l.c,l.r)}),s}},{key:"_applyRotationsXY",value:function(e,t){return K(t,function(r){e=Zi(e,r.c,r.r)}),e}},{key:"_internal_newEndpoint",value:function(e){var t=W({},e),r=this.manage(t.element);t.elementId=this.getId(t.element),t.id="ep_"+this._idstamp();var s=new tr(this,t);return rp(r,s),e.uuid&&this.endpointsByUUID.set(e.uuid,s),Yl(this.endpointsByElement,s.elementId,s),this._suspendDrawing||this._paintEndpoint(s,{timestamp:this._suspendedAt}),s}},{key:"_deriveEndpointAndAnchorSpec",value:function(e,t){for(var r=((t?"":"default ")+e).split(/[\s]/),s=null,l=null,u=null,c=null,d=0;d<r.length;d++){var f=this.getConnectionType(r[d]);f&&(f.endpoints&&(s=f.endpoints),f.endpoint&&(l=f.endpoint),f.anchors&&(c=f.anchors),f.anchor&&(u=f.anchor))}return{endpoints:s||[l,l],anchors:c||[u,u]}}},{key:"revalidate",value:function(e,t){var r=this.getId(e);return this.updateOffset({elId:r,recalc:!0,timestamp:t}),this.repaint(e)}},{key:"repaintEverything",value:function(){var e=Ke(),t;for(t in this._managedElements)this.viewport.refreshElement(t,!0);this.viewport.recomputeBounds();for(t in this._managedElements)this.repaint(this._managedElements[t].el,e,!0);return this}},{key:"setElementPosition",value:function(e,t,r){var s=this.getId(e);return this.viewport.setPosition(s,t,r),this.repaint(e)}},{key:"repaint",value:function(e,t,r){var s={c:new Set,e:new Set},l=function(p){p.c.forEach(function(y){return s.c.add(y)}),p.e.forEach(function(y){return s.e.add(y)})};if(!this._suspendDrawing){var u=this.getId(e);if(e!=null){var c=this._getAssociatedElements(e);if(t==null&&(t=Ke()),!r)for(var d=0;d<c.length;d++)this.updateOffset({elId:this.getId(c[d]),recalc:!0,timestamp:t});if(l(this.router.redraw(u,t,null)),c.length>0)for(var f=0;f<c.length;f++)l(this.router.redraw(this.getId(c[f]),t,null))}}return s}},{key:"unregisterEndpoint",value:function(e){var t=e.getUuid();t&&this.endpointsByUUID.delete(t),ip(this._managedElements[e.elementId],e);var r=this.endpointsByElement[e.elementId];r!=null&&(this.endpointsByElement[e.elementId]=r.filter(function(s){return s!==e})),this.fire(nu,e)}},{key:"_maybePruneEndpoint",value:function(e){return e.deleteOnEmpty&&e.connections.length===0?(this.deleteEndpoint(e),!0):!1}},{key:"deleteEndpoint",value:function(e){var t=this,r=typeof e=="string"?this.endpointsByUUID.get(e):e;if(r){var s=r.proxiedBy,l=r.connections.slice();K(l,function(u){r.detachFromConnection(u,null,!0)}),this.unregisterEndpoint(r),r.destroy(),K(l,function(u){t.deleteConnection(u,{force:!0,endpointToIgnore:r})}),s!=null&&this.deleteEndpoint(s)}return this}},{key:"addEndpoint",value:function(e,t,r){r=r||{};var s=W({},r);W(s,t||{});var l=W({element:e},s);return this._internal_newEndpoint(l)}},{key:"addEndpoints",value:function(e,t,r){for(var s=[],l=0,u=t.length;l<u;l++)s.push(this.addEndpoint(e,t[l],r));return s}},{key:"reset",value:function(){var e=this;this.silently(function(){e.endpointsByElement={},e._managedElements={},e.endpointsByUUID.clear(),e.viewport.reset(),e.router.reset(),e.groupManager.reset(),e.connections.length=0})}},{key:"destroy",value:function(){this.reset(),this.unbind(),this.sourceSelectors.length=0,this.targetSelectors.length=0,this._connectionTypes.clear(),this._endpointTypes.clear()}},{key:"getEndpoints",value:function(e){return this.endpointsByElement[this.getId(e)]||[]}},{key:"getEndpoint",value:function(e){return this.endpointsByUUID.get(e)}},{key:"setEndpointUuid",value:function(e,t){e.uuid&&this.endpointsByUUID.delete(e.uuid),e.uuid=t,this.endpointsByUUID.set(t,e)}},{key:"connect",value:function(e,t){try{var r=this._prepareConnectionParams(e,t),s=this._newConnection(r);return this._finaliseConnection(s,r),s}catch(l){We(l);return}}},{key:"_prepareConnectionParams",value:function(e,t){var r=W({},e);t&&W(r,t);var s=r;if(s.source&&s.source.endpoint&&(s.sourceEndpoint=s.source),s.target&&s.target.endpoint&&(s.targetEndpoint=s.target),e.uuids&&(s.sourceEndpoint=this.getEndpoint(e.uuids[0]),s.targetEndpoint=this.getEndpoint(e.uuids[1])),s.sourceEndpoint!=null){if(s.sourceEndpoint.isFull())throw df;if(s.type||(s.type=s.sourceEndpoint.edgeType),s.sourceEndpoint.connectorOverlays){s.overlays=s.overlays||[];for(var l=0,u=s.sourceEndpoint.connectorOverlays.length;l<u;l++)s.overlays.push(s.sourceEndpoint.connectorOverlays[l])}s.sourceEndpoint.scope&&(s.scope=s.sourceEndpoint.scope)}else if(s.source==null)throw hf;if(s.targetEndpoint!=null){if(s.targetEndpoint.isFull())throw ff}else if(s.target==null)throw vf;if(s.sourceEndpoint&&s.targetEndpoint&&!np(s.sourceEndpoint,s.targetEndpoint))throw"Cannot establish connection: scopes do not match";return s}},{key:"_newConnection",value:function(e){e.id="con_"+this._idstamp();var t=new ni(this,e);return Ai(t,this._managedElements[t.sourceId],this._managedElements[t.targetId]),this._paintConnection(t),t}},{key:"_finaliseConnection",value:function(e,t,r){t=t||{},e.suspendedEndpoint||this.connections.push(e),e.pending=null,e.endpoints[0].isTemporarySource=!1,this.repaint(e.source);var s={connection:e,source:e.source,target:e.target,sourceId:e.sourceId,targetId:e.targetId,sourceEndpoint:e.endpoints[0],targetEndpoint:e.endpoints[1]};this.fire(eu,s,r),!t.doNotFireConnectionEvent&&t.fireEvent!==!1&&this.fire(_a,s,r)}},{key:"removeAllEndpoints",value:function(e,t){var r=this,s=function(u){var c=r.getId(u),d=r.endpointsByElement[c],f,v;if(d)for(f=0,v=d.length;f<v;f++)r.deleteEndpoint(d[f]);delete r.endpointsByElement[c]};return t&&this._getAssociatedElements(e).map(s),s(e),this}},{key:"_createSourceDefinition",value:function(e,t){var r=W({},t);W(r,e),r.edgeType=r.edgeType||eo;var s=this._deriveEndpointAndAnchorSpec(r.edgeType);r.endpoint=r.endpoint||s.endpoints[0],r.anchor=r.anchor||s.anchors[0];var l=r.maxConnections||-1,u={def:W({},r),uniqueEndpoint:r.uniqueEndpoint,maxConnections:l,enabled:!0,endpoint:null};return u}},{key:"addSourceSelector",value:function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=this._createSourceDefinition(t),l=new Gs(e,s,r);return this.sourceSelectors.push(l),l}},{key:"removeSourceSelector",value:function(e){Ze(this.sourceSelectors,function(t){return t===e})}},{key:"removeTargetSelector",value:function(e){Ze(this.targetSelectors,function(t){return t===e})}},{key:"addTargetSelector",value:function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=this._createTargetDefinition(t),l=new Gs(e,s,r);return this.targetSelectors.push(l),l}},{key:"_createTargetDefinition",value:function(e,t){var r=W({},t);W(r,e),r.edgeType=r.edgeType||eo;var s=r.maxConnections||-1,l={def:W({},r),uniqueEndpoint:r.uniqueEndpoint,maxConnections:s,enabled:!0,endpoint:null};return l}},{key:"show",value:function(e,t){return this._setVisible(e,qo,t)}},{key:"hide",value:function(e,t){return this._setVisible(e,lr,t)}},{key:"_setVisible",value:function(e,t,r){var s=t===qo,l=null;r&&(l=function(d){d.setVisible(s,!0,!0)});var u=this.getId(e);return this._operation(e,function(c){if(s&&r){var d=c.sourceId===u?1:0;c.endpoints[d].isVisible()&&c.setVisible(!0)}else c.setVisible(s)},l),this}},{key:"toggleVisible",value:function(e,t){var r=null;t&&(r=function(l){var u=l.isVisible();l.setVisible(!u)}),this._operation(e,function(s){var l=s.isVisible();s.setVisible(!l)},r)}},{key:"_operation",value:function(e,t,r){var s=this.getId(e),l=this.endpointsByElement[s];if(l&&l.length)for(var u=0,c=l.length;u<c;u++){for(var d=0,f=l[u].connections.length;d<f;d++){var v=t(l[u].connections[d]);if(v)return}r&&r(l[u])}}},{key:"registerConnectionType",value:function(e,t){if(this._connectionTypes.set(e,W({},t)),t.overlays){for(var r={},s=0;s<t.overlays.length;s++){var l=oa(t.overlays[s]);r[l.options.id]=l}this._connectionTypes.get(e).overlays=r}}},{key:"registerConnectionTypes",value:function(e){for(var t in e)this.registerConnectionType(t,e[t])}},{key:"registerEndpointType",value:function(e,t){if(this._endpointTypes.set(e,W({},t)),t.overlays){for(var r={},s=0;s<t.overlays.length;s++){var l=oa(t.overlays[s]);r[l.options.id]=l}this._endpointTypes.get(e).overlays=r}}},{key:"registerEndpointTypes",value:function(e){for(var t in e)this.registerEndpointType(t,e[t])}},{key:"getType",value:function(e,t){return t==="connection"?this.getConnectionType(e):this.getEndpointType(e)}},{key:"getConnectionType",value:function(e){return this._connectionTypes.get(e)}},{key:"getEndpointType",value:function(e){return this._endpointTypes.get(e)}},{key:"importDefaults",value:function(e){for(var t in e)this.defaults[t]=e[t];return this.defaults[Wn]!=null&&(this.defaults[Wn].strokeWidth=this.defaults[Wn].strokeWidth||2),e.container&&this.setContainer(e.container),this}},{key:"restoreDefaults",value:function(){return this.defaults=W({},this._initialDefaults),this}},{key:"getManagedElements",value:function(){return this._managedElements}},{key:"proxyConnection",value:function(e,t,r,s,l){var u=e.proxies[t]!=null,c,d=u?e.proxies[t].originalEp.elementId:e.endpoints[t].elementId,f=u?e.proxies[t].originalEp:e.endpoints[t],v=this.getId(r);e.proxies[t]?e.proxies[t].ep.elementId===v?c=e.proxies[t].ep:(e.proxies[t].ep.detachFromConnection(e,t),c=this._internal_newEndpoint({element:r,endpoint:s(e,t),anchor:l(e,t),parameters:{isProxyEndpoint:!0}})):c=this._internal_newEndpoint({element:r,endpoint:s(e,t),anchor:l(e,t),parameters:{isProxyEndpoint:!0}}),c.deleteOnEmpty=!0,e.proxies[t]={ep:c,originalEp:f},this.sourceOrTargetChanged(d,v,e,r,t),f.detachFromConnection(e,null,!0),c.connections=[e],e.endpoints[t]=c,f.proxiedBy=c,f.setVisible(!1),e.setVisible(!0),this.revalidate(r)}},{key:"unproxyConnection",value:function(e,t){if(!(e.proxies==null||e.proxies[t]==null)){var r=e.proxies[t].originalEp.element,s=e.proxies[t].originalEp.elementId,l=e.proxies[t].ep.elementId;e.endpoints[t]=e.proxies[t].originalEp,delete e.proxies[t].originalEp.proxiedBy,this.sourceOrTargetChanged(l,s,e,r,t),e.proxies[t].ep.detachFromConnection(e,null),e.proxies[t].originalEp.addConnection(e),e.isVisible()&&e.proxies[t].originalEp.setVisible(!0),e.proxies[t]=null,un(e.proxies,function(u){return u!=null})===-1&&(e.proxies.length=0)}}},{key:"sourceOrTargetChanged",value:function(e,t,r,s,l){e!==t&&(l===0?(r.sourceId=t,r.source=s):l===1&&(r.targetId=t,r.target=s),Di(r,this._managedElements[e]),Ai(r,this._managedElements[t]))}},{key:"getGroup",value:function(e){return this.groupManager.getGroup(e)}},{key:"getGroupFor",value:function(e){return this.groupManager.getGroupFor(e)}},{key:"addGroup",value:function(e){return this.groupManager.addGroup(e)}},{key:"addToGroup",value:function(e){for(var t,r=arguments.length,s=new Array(r>1?r-1:0),l=1;l<r;l++)s[l-1]=arguments[l];return(t=this.groupManager).addToGroup.apply(t,[e,!1].concat(s))}},{key:"collapseGroup",value:function(e){this.groupManager.collapseGroup(e)}},{key:"expandGroup",value:function(e){this.groupManager.expandGroup(e)}},{key:"toggleGroup",value:function(e){this.groupManager.toggleGroup(e)}},{key:"removeGroup",value:function(e,t,r,s){return this.groupManager.removeGroup(e,t,r,s)}},{key:"removeAllGroups",value:function(e,t){this.groupManager.removeAllGroups(e,t,!1)}},{key:"removeFromGroup",value:function(e,t,r){this.groupManager.removeFromGroup(e,r,t),this._appendElement(t,this.getContainer()),this.updateOffset({recalc:!0,elId:this.getId(t)})}},{key:"_paintEndpoint",value:function(e,t){function r(S){var C=0;if(t.elementWithPrecedence!=null){for(var x=0;x<S.connections.length;x++)if(S.connections[x].sourceId===t.elementWithPrecedence||S.connections[x].targetId===t.elementWithPrecedence){C=x;break}}return S.connections[C]}t=t||{};var s=t.timestamp,l=t.recalc!==!1;if(!s||e.timestamp!==s){var u=this.viewport.getPosition(e.elementId),c=t.offset?{x:t.offset.x,y:t.offset.y}:{x:u.x,y:u.y};if(c!=null){var d=t.anchorLoc;if(d==null){var f={xy:c,wh:u,element:e,timestamp:s};if(l&&this.router.isDynamicAnchor(e)&&e.connections.length>0){var v=r(e),p=v.endpoints[0]===e?1:0,y=p===0?v.sourceId:v.targetId,g=this.viewport.getPosition(y);f.index=p===0?1:0,f.connection=v,f.txy=g,f.twh=g,f.tElement=v.endpoints[p],f.tRotation=this._getRotations(y)}else e.connections.length>0&&(f.connection=e.connections[0]);f.rotation=this._getRotations(e.elementId),d=this.router.computeAnchorLocation(e._anchor,f)}e.endpoint.compute(d,this.router.getEndpointOrientation(e),e.paintStyleInUse),this.renderEndpoint(e,e.paintStyleInUse),e.timestamp=s;for(var E in e.overlays)if(e.overlays.hasOwnProperty(E)){var b=e.overlays[E];b.isVisible()&&(e.overlayPlacements[E]=this.drawOverlay(b,e.endpoint,e.paintStyleInUse,e.getAbsoluteOverlayPosition(b)),this._paintOverlay(b,e.overlayPlacements[E],{xmin:0,ymin:0}))}}}}},{key:"_paintConnection",value:function(e,t){if(!this._suspendDrawing&&e.visible!==!1){t=t||{};var r=t.timestamp;if(r!=null&&r===e.lastPaintedAt)return;if(r==null||r!==e.lastPaintedAt){this.router.computePath(e,r);var s={xmin:1/0,ymin:1/0,xmax:-1/0,ymax:-1/0};for(var l in e.overlays)if(e.overlays.hasOwnProperty(l)){var u=e.overlays[l];u.isVisible()&&(e.overlayPlacements[l]=this.drawOverlay(u,e.connector,e.paintStyleInUse,e.getAbsoluteOverlayPosition(u)),s.xmin=Math.min(s.xmin,e.overlayPlacements[l].xmin),s.xmax=Math.max(s.xmax,e.overlayPlacements[l].xmax),s.ymin=Math.min(s.ymin,e.overlayPlacements[l].ymin),s.ymax=Math.max(s.ymax,e.overlayPlacements[l].ymax))}var c=parseFloat(""+e.paintStyleInUse.strokeWidth||"1")/2,d=parseFloat(""+e.paintStyleInUse.strokeWidth||"0"),f={xmin:Math.min(e.connector.bounds.xmin-(c+d),s.xmin),ymin:Math.min(e.connector.bounds.ymin-(c+d),s.ymin),xmax:Math.max(e.connector.bounds.xmax+(c+d),s.xmax),ymax:Math.max(e.connector.bounds.ymax+(c+d),s.ymax)};this.paintConnector(e.connector,e.paintStyleInUse,f);for(var v in e.overlays)if(e.overlays.hasOwnProperty(v)){var p=e.overlays[v];p.isVisible()&&this._paintOverlay(p,e.overlayPlacements[v],f)}}e.lastPaintedAt=r}}},{key:"_refreshEndpoint",value:function(e){e._anchor.isFloating||(e.connections.length>0?this.addEndpointClass(e,this.endpointConnectedClass):this.removeEndpointClass(e,this.endpointConnectedClass),e.isFull()?this.addEndpointClass(e,this.endpointFullClass):this.removeEndpointClass(e,this.endpointFullClass))}},{key:"_makeConnector",value:function(e,t,r){return li.get(e,t,r)}},{key:"addOverlay",value:function(e,t,r){if(e.addOverlay(t),!r){var s=e instanceof tr?e.element:e.source;this.revalidate(s)}}},{key:"removeOverlay",value:function(e,t){e.removeOverlay(t);var r=e instanceof tr?e.element:e.source;this.revalidate(r)}},{key:"setOutlineColor",value:function(e,t){e.paintStyleInUse.outlineStroke=t,this._paintConnection(e)}},{key:"setOutlineWidth",value:function(e,t){e.paintStyleInUse.outlineWidth=t,this._paintConnection(e)}},{key:"setColor",value:function(e,t){e.paintStyleInUse.stroke=t,this._paintConnection(e)}},{key:"setLineWidth",value:function(e,t){e.paintStyleInUse.strokeWidth=t,this._paintConnection(e)}},{key:"setLineStyle",value:function(e,t){t.lineWidth!=null&&(e.paintStyleInUse.strokeWidth=t.lineWidth),t.outlineWidth!=null&&(e.paintStyleInUse.outlineWidth=t.outlineWidth),t.color!=null&&(e.paintStyleInUse.stroke=t.color),t.outlineColor!=null&&(e.paintStyleInUse.outlineStroke=t.outlineColor),this._paintConnection(e)}},{key:"getPathData",value:function(e){for(var t="",r=0;r<e.segments.length;r++)t+=e.segments[r].getPath(r===0),t+=" ";return t}}]),n}(si),ku={};function $a(o,a){ku[o]=a}function nl(o,a,n){var i=a,e=nr(a.getBoundingClientRect)!==fu?a.getBoundingClientRect():{left:0,top:0,width:0,height:0},t=document.body,r=document.documentElement,s=window.pageYOffset||r.scrollTop||t.scrollTop,l=window.pageXOffset||r.scrollLeft||t.scrollLeft,u=r.clientTop||t.clientTop||0,c=r.clientLeft||t.clientLeft||0,d=0,f=0,v=e.top+s-u+d*n,p=e.left+l-c+f*n,y=to(o),g=e.width||i.offsetWidth*n,E=e.height||i.offsetHeight*n,b=(y.x-p)/g,S=(y.y-v)/E;return{x:b,y:S}}function zn(o){return aa(o)||sa(o)||la(o)}function rl(o,a){o.canvas&&(o.canvas.style.display=a?"block":"none")}function il(o){o.canvas&&o.canvas.parentNode.removeChild(o.canvas),delete o.canvas}function wr(o){return o.canvas}function Ot(o){return Ya.getElement(o)}function En(o){return Ya.getElement(o,o.component,function(a){var n=o.create(a);return o.instance.addClass(n,o.instance.overlayClass),n})}function ap(o,a,n,i){var e=o.x,t=o.y;return a._jsPlumbParentGroup&&a._jsPlumbParentGroup.constrain&&(e=Math.max(o.x,0),t=Math.max(o.y,0),e=Math.min(e,n.w-i.w),t=Math.min(t,n.h-i.h)),{x:e,y:t}}var sp=function(o){Ee(n,o);var a=be(n);function n(i,e){var t;if($(this,n),t=a.call(this,i,e),t._instanceIndex=i,h(m(t),"containerType",null),h(m(t),"dragSelection",void 0),h(m(t),"dragManager",void 0),h(m(t),"_connectorClick",void 0),h(m(t),"_connectorDblClick",void 0),h(m(t),"_connectorTap",void 0),h(m(t),"_connectorDblTap",void 0),h(m(t),"_endpointClick",void 0),h(m(t),"_endpointDblClick",void 0),h(m(t),"_overlayClick",void 0),h(m(t),"_overlayDblClick",void 0),h(m(t),"_overlayTap",void 0),h(m(t),"_overlayDblTap",void 0),h(m(t),"_connectorMouseover",void 0),h(m(t),"_connectorMouseout",void 0),h(m(t),"_endpointMouseover",void 0),h(m(t),"_endpointMouseout",void 0),h(m(t),"_connectorContextmenu",void 0),h(m(t),"_connectorMousedown",void 0),h(m(t),"_connectorMouseup",void 0),h(m(t),"_endpointMousedown",void 0),h(m(t),"_endpointMouseup",void 0),h(m(t),"_overlayMouseover",void 0),h(m(t),"_overlayMouseout",void 0),h(m(t),"_elementClick",void 0),h(m(t),"_elementTap",void 0),h(m(t),"_elementDblTap",void 0),h(m(t),"_elementMouseenter",void 0),h(m(t),"_elementMouseexit",void 0),h(m(t),"_elementMousemove",void 0),h(m(t),"_elementMouseup",void 0),h(m(t),"_elementMousedown",void 0),h(m(t),"_elementContextmenu",void 0),h(m(t),"_resizeObserver",void 0),h(m(t),"eventManager",void 0),h(m(t),"draggingClass","jtk-dragging"),h(m(t),"elementDraggingClass","jtk-element-dragging"),h(m(t),"hoverClass","jtk-hover"),h(m(t),"sourceElementDraggingClass","jtk-source-element-dragging"),h(m(t),"targetElementDraggingClass","jtk-target-element-dragging"),h(m(t),"hoverSourceClass","jtk-source-hover"),h(m(t),"hoverTargetClass","jtk-target-hover"),h(m(t),"dragSelectClass","jtk-drag-select"),h(m(t),"managedElementsSelector",void 0),h(m(t),"elementsDraggable",void 0),h(m(t),"elementDragHandler",void 0),h(m(t),"groupDragOptions",void 0),h(m(t),"elementDragOptions",void 0),h(m(t),"svg",{node:function(s,l){return Wt(s,l)},attr:function(s,l){return $t(s,l)},pos:function(s){return cu(s)}}),e=e||{},t.containerType=Jo(t.getContainer()),t.elementsDraggable=e&&e.elementsDraggable!==!1,t.managedElementsSelector=e&&e.managedElementsSelector||Ie,t.eventManager=new Fa,t.dragSelection=new Uh(m(t)),t.dragManager=new Wh(m(t),t.dragSelection),t.dragManager.addHandler(new Bs(m(t))),t.groupDragOptions={constrainFunction:ap},t.dragManager.addHandler(new Us(m(t),t.dragSelection),t.groupDragOptions),t.elementDragHandler=new ia(m(t),t.dragSelection),t.elementDragOptions=e&&e.dragOptions||{},t.dragManager.addHandler(t.elementDragHandler,t.elementDragOptions),e&&e.dragOptions&&e.dragOptions.filter&&t.dragManager.addFilter(e.dragOptions.filter),t._createEventListeners(),t._attachEventDelegates(),e.resizeObserver!==!1)try{t._resizeObserver=new ResizeObserver(function(r){var s=r.filter(function(l){var u=t.getAttribute(l.target,rn);if(u!=null){var c=t.viewport._elementMap.get(u);return c?c.w!==l.contentRect.width||c.h!==l.contentRect.height:!1}else return!1});s.forEach(function(l){return t.revalidate(l.target)})})}catch{We("WARN: ResizeObserver could not be attached.")}return t}return J(n,[{key:"fireOverlayMethod",value:function(e,t,r){var s=e.component instanceof ni?Bt:Rn,l=Oe(s,t);r._jsPlumbOverlay=e,e.fire(t,{e:r,overlay:e}),this.fire(l,e.component,r)}},{key:"addDragFilter",value:function(e,t){this.dragManager.addFilter(e,t)}},{key:"removeDragFilter",value:function(e){this.dragManager.removeFilter(e)}},{key:"setDragGrid",value:function(e){this.dragManager.setOption(this.elementDragHandler,{grid:e})}},{key:"setDragConstrainFunction",value:function(e){this.dragManager.setOption(this.elementDragHandler,{constrainFunction:e})}},{key:"_removeElement",value:function(e){e.parentNode&&e.parentNode.removeChild(e)}},{key:"_appendElement",value:function(e,t){t&&t.appendChild(e)}},{key:"_appendElementToGroup",value:function(e,t){this.getGroupContentArea(e).appendChild(t)}},{key:"_appendElementToContainer",value:function(e){this._appendElement(e,this.getContainer())}},{key:"_getAssociatedElements",value:function(e){var t=[];if(e.nodeType!==3&&e.nodeType!==8){var r=e.querySelectorAll(Ie);Array.prototype.push.apply(t,r)}return t.filter(function(s){return s.nodeType!==3&&s.nodeType!==8})}},{key:"shouldFireEvent",value:function(e,t,r){return!0}},{key:"getClass",value:function(e){return kd(e)}},{key:"addClass",value:function(e,t){Sn(e,t)}},{key:"hasClass",value:function(e,t){return Ld(e,t)}},{key:"removeClass",value:function(e,t){Zo(e,t)}},{key:"toggleClass",value:function(e,t){Nd(e,t)}},{key:"setAttribute",value:function(e,t,r){e.setAttribute(t,r)}},{key:"getAttribute",value:function(e,t){return e.getAttribute(t)}},{key:"setAttributes",value:function(e,t){for(var r in t)e.setAttribute(r,t[r])}},{key:"removeAttribute",value:function(e,t){e.removeAttribute&&e.removeAttribute(t)}},{key:"on",value:function(e,t,r,s){var l=this,u=function(d){s==null?l.eventManager.on(d,t,r):l.eventManager.on(d,t,r,s)};return Qr(e)?K(e,function(c){return u(c)}):u(e),this}},{key:"off",value:function(e,t,r){var s=this;return Qr(e)?K(e,function(l){return s.eventManager.off(l,t,r)}):this.eventManager.off(e,t,r),this}},{key:"trigger",value:function(e,t,r,s,l){this.eventManager.trigger(e,t,r,s,l)}},{key:"getOffsetRelativeToRoot",value:function(e){return Qn(e)}},{key:"getOffset",value:function(e){for(var t=e,r=this.getContainer(),s=this.getPosition(t),l=e!==r&&t.offsetParent!==r?t.offsetParent:null,u=function(v){v!=null&&v!==document.body&&(v.scrollTop>0||v.scrollLeft>0)&&(s.x-=v.scrollLeft,s.y-=v.scrollTop)};l!=null;)s.x+=l.offsetLeft,s.y+=l.offsetTop,u(l),l=l.offsetParent===r?null:l.offsetParent;if(r!=null&&(r.scrollTop>0||r.scrollLeft>0)){var c=t.offsetParent!=null?this.getStyle(t.offsetParent,Ps):Ud,d=this.getStyle(t,Ps);d!==qr&&d!==ps&&c!==qr&&c!==ps&&(s.x-=r.scrollLeft,s.y-=r.scrollTop)}return s}},{key:"getSize",value:function(e){var t=e;if(t.offsetWidth!=null)return Rd(e);if(t.width&&t.width.baseVal)return Fd(t)}},{key:"getPosition",value:function(e){var t=e;if(t.offsetLeft!=null)return{x:parseFloat(t.offsetLeft),y:parseFloat(t.offsetTop)};if(t.x&&t.x.baseVal)return Gd(t)}},{key:"getStyle",value:function(e,t){return nr(window.getComputedStyle)!==fu?getComputedStyle(e,null).getPropertyValue(t):e.currentStyle[t]}},{key:"getGroupContentArea",value:function(e){var t=this.getSelector(e.el,Qf);return t&&t.length>0?t[0]:e.el}},{key:"getSelector",value:function(e,t){var r=null;if(arguments.length===1){if(!Be(e)){var s=document.createDocumentFragment();return s.appendChild(e),Ei(s.childNodes)}r=Ei(document.querySelectorAll(e))}else r=Ei(e.querySelectorAll(t));return r}},{key:"setPosition",value:function(e,t){var r=e;r.style.left=t.x+"px",r.style.top=t.y+"px"}},{key:"setDraggable",value:function(e,t){t?this.removeAttribute(e,Fi):this.setAttribute(e,Fi,hu)}},{key:"isDraggable",value:function(e){var t=this.getAttribute(e,Fi);return t==null||t===er}},{key:"toggleDraggable",value:function(e){var t=this.isDraggable(e);return this.setDraggable(e,!t),!t}},{key:"_createEventListeners",value:function(){var e=function(E,b){if(!b.defaultPrevented&&b._jsPlumbOverlay==null){var S=Vt(ht(b),Tt,this.getContainer(),!0);this.fire(E,S.jtk.connector.connection,b)}};this._connectorClick=e.bind(this,Vf),this._connectorDblClick=e.bind(this,Hf),this._connectorTap=e.bind(this,Zf),this._connectorDblTap=e.bind(this,Yf);var t=function(E,b){var S=ht(b).parentNode;if(S.jtk&&S.jtk.connector){var C=S.jtk.connector,x=C.connection;this.setConnectorHover(C,E),E?(this.addClass(x.source,this.hoverSourceClass),this.addClass(x.target,this.hoverTargetClass)):(this.removeClass(x.source,this.hoverSourceClass),this.removeClass(x.target,this.hoverTargetClass)),this.fire(E?$f:Xf,S.jtk.connector.connection,b)}};this._connectorMouseover=t.bind(this,!0),this._connectorMouseout=t.bind(this,!1);var r=function(E,b){var S=ht(b).parentNode;S.jtk&&S.jtk.connector&&this.fire(E?Wf:Kf,S.jtk.connector.connection,b)};this._connectorMouseup=r.bind(this,!0),this._connectorMousedown=r.bind(this,!1),this._connectorContextmenu=(function(g){var E=ht(g).parentNode;E.jtk&&E.jtk.connector&&this.fire(zf,E.jtk.connector.connection,g)}).bind(this);var s=function(E,b,S){!b.defaultPrevented&&b._jsPlumbOverlay==null&&this.fire(E,S.jtk.endpoint,b)};this._endpointClick=s.bind(this,Rf),this._endpointDblClick=s.bind(this,Ff);var l=function(E,b){var S=ht(b);S.jtk&&S.jtk.endpoint&&(this.setEndpointHover(S.jtk.endpoint,E),this.fire(E?jf:Gf,S.jtk.endpoint,b))};this._endpointMouseover=l.bind(this,!0),this._endpointMouseout=l.bind(this,!1);var u=function(E,b){var S=ht(b);S.jtk&&S.jtk.endpoint&&this.fire(E?Bf:Uf,S.jtk.endpoint,b)};this._endpointMouseup=u.bind(this,!0),this._endpointMousedown=u.bind(this,!1);var c=(function(g,E){var b=Vt(ht(E),Ut,this.getContainer(),!0),S=b.jtk.overlay;S&&this.fireOverlayMethod(S,g,E)}).bind(this);this._overlayClick=c.bind(this,at),this._overlayDblClick=c.bind(this,gt),this._overlayTap=c.bind(this,_t),this._overlayDblTap=c.bind(this,It);var d=function(E,b){var S=Vt(ht(b),Ut,this.getContainer(),!0),C=S.jtk.overlay;C&&this.setOverlayHover(C,E)};this._overlayMouseover=d.bind(this,!0),this._overlayMouseout=d.bind(this,!1);var f=function(E,b,S){b.defaultPrevented||this.fire(b.detail===1?Ss:If,S,b)};this._elementClick=f.bind(this,Ss);var v=function(E,b,S){b.defaultPrevented||this.fire(xs,S,b)};this._elementTap=v.bind(this,xs);var p=function(E,b,S){b.defaultPrevented||this.fire(Cs,S,b)};this._elementDblTap=p.bind(this,Cs);var y=function(E,b){this.fire(E?wf:_f,ht(b),b)};this._elementMouseenter=y.bind(this,!0),this._elementMouseexit=y.bind(this,!1),this._elementMousemove=(function(g){this.fire(Mf,ht(g),g)}).bind(this),this._elementMouseup=(function(g){this.fire(kf,ht(g),g)}).bind(this),this._elementMousedown=(function(g){this.fire(Lf,ht(g),g)}).bind(this),this._elementContextmenu=(function(g){this.fire(Nf,ht(g),g)}).bind(this)}},{key:"_attachEventDelegates",value:function(){var e=this.getContainer();this.eventManager.on(e,at,Ut,this._overlayClick),this.eventManager.on(e,gt,Ut,this._overlayDblClick),this.eventManager.on(e,_t,Ut,this._overlayTap),this.eventManager.on(e,It,Ut,this._overlayDblTap),this.eventManager.on(e,at,Tt,this._connectorClick),this.eventManager.on(e,gt,Tt,this._connectorDblClick),this.eventManager.on(e,_t,Tt,this._connectorTap),this.eventManager.on(e,It,Tt,this._connectorDblTap),this.eventManager.on(e,at,gn,this._endpointClick),this.eventManager.on(e,gt,gn,this._endpointDblClick),this.eventManager.on(e,at,this.managedElementsSelector,this._elementClick),this.eventManager.on(e,_t,this.managedElementsSelector,this._elementTap),this.eventManager.on(e,It,this.managedElementsSelector,this._elementDblTap),this.eventManager.on(e,bt,Tt,this._connectorMouseover),this.eventManager.on(e,Et,Tt,this._connectorMouseout),this.eventManager.on(e,Ht,Tt,this._connectorContextmenu),this.eventManager.on(e,fe,Tt,this._connectorMouseup),this.eventManager.on(e,de,Tt,this._connectorMousedown),this.eventManager.on(e,bt,gn,this._endpointMouseover),this.eventManager.on(e,Et,gn,this._endpointMouseout),this.eventManager.on(e,fe,gn,this._endpointMouseup),this.eventManager.on(e,de,gn,this._endpointMousedown),this.eventManager.on(e,bt,Ut,this._overlayMouseover),this.eventManager.on(e,Et,Ut,this._overlayMouseout),this.eventManager.on(e,bt,Ie,this._elementMouseenter),this.eventManager.on(e,Et,Ie,this._elementMouseexit),this.eventManager.on(e,ze,Ie,this._elementMousemove),this.eventManager.on(e,fe,Ie,this._elementMouseup),this.eventManager.on(e,de,Ie,this._elementMousedown),this.eventManager.on(e,Ht,Ie,this._elementContextmenu)}},{key:"_detachEventDelegates",value:function(){var e=this.getContainer();e&&(this.eventManager.off(e,at,this._connectorClick),this.eventManager.off(e,gt,this._connectorDblClick),this.eventManager.off(e,_t,this._connectorTap),this.eventManager.off(e,It,this._connectorDblTap),this.eventManager.off(e,at,this._endpointClick),this.eventManager.off(e,gt,this._endpointDblClick),this.eventManager.off(e,at,this._overlayClick),this.eventManager.off(e,gt,this._overlayDblClick),this.eventManager.off(e,_t,this._overlayTap),this.eventManager.off(e,It,this._overlayDblTap),this.eventManager.off(e,at,this._elementClick),this.eventManager.off(e,_t,this._elementTap),this.eventManager.off(e,It,this._elementDblTap),this.eventManager.off(e,bt,this._connectorMouseover),this.eventManager.off(e,Et,this._connectorMouseout),this.eventManager.off(e,Ht,this._connectorContextmenu),this.eventManager.off(e,fe,this._connectorMouseup),this.eventManager.off(e,de,this._connectorMousedown),this.eventManager.off(e,bt,this._endpointMouseover),this.eventManager.off(e,Et,this._endpointMouseout),this.eventManager.off(e,fe,this._endpointMouseup),this.eventManager.off(e,de,this._endpointMousedown),this.eventManager.off(e,bt,this._overlayMouseover),this.eventManager.off(e,Et,this._overlayMouseout),this.eventManager.off(e,ka,this._elementMouseenter),this.eventManager.off(e,La,this._elementMouseexit),this.eventManager.off(e,ze,this._elementMousemove),this.eventManager.off(e,fe,this._elementMouseup),this.eventManager.off(e,de,this._elementMousedown),this.eventManager.off(e,Ht,this._elementContextmenu))}},{key:"setContainer",value:function(e){var t=this;if(e===document||e===document.body)throw new Error("Cannot set document or document.body as container element");this._detachEventDelegates();var r;this.dragManager!=null&&(r=this.dragManager.reset()),this.setAttribute(e,Es,Ke().replace("-",""));var s=this.getContainer();if(s!=null){s.removeAttribute(Es);var l=Ei(s.childNodes).filter(function(u){return u!=null&&(t.hasClass(u,Da)||t.hasClass(u,rr)||t.hasClass(u,po)||u.getAttribute&&u.getAttribute(rn)!=null)});K(l,function(u){e.appendChild(u)})}Ge(_e(n.prototype),"setContainer",this).call(this,e),this.containerType=Jo(e),this.eventManager!=null&&this._attachEventDelegates(),this.dragManager!=null&&(this.dragManager.addHandler(new Bs(this)),this.dragManager.addHandler(new Us(this,this.dragSelection),this.groupDragOptions),this.elementDragHandler=new ia(this,this.dragSelection),this.dragManager.addHandler(this.elementDragHandler,this.elementDragOptions),r!=null&&this.dragManager.setFilters(r))}},{key:"reset",value:function(){Ge(_e(n.prototype),"reset",this).call(this),this._resizeObserver&&this._resizeObserver.disconnect();var e=this.getContainer(),t=e.querySelectorAll([Ie,gn,Tt,Ut].join(","));K(t,function(r){return r.parentNode&&r.parentNode.removeChild(r)})}},{key:"destroy",value:function(){this._detachEventDelegates(),this.dragManager!=null&&this.dragManager.reset(),this.clearDragSelection(),Ge(_e(n.prototype),"destroy",this).call(this)}},{key:"unmanage",value:function(e,t){this._resizeObserver!=null&&this._resizeObserver.unobserve(e),this.removeFromDragSelection(e),Ge(_e(n.prototype),"unmanage",this).call(this,e,t)}},{key:"addToDragSelection",value:function(){for(var e=this,t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];K(r,function(l){return e.dragSelection.add(l)})}},{key:"clearDragSelection",value:function(){this.dragSelection.clear()}},{key:"removeFromDragSelection",value:function(){for(var e=this,t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];K(r,function(l){return e.dragSelection.remove(l)})}},{key:"toggleDragSelection",value:function(){for(var e=this,t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];K(r,function(l){return e.dragSelection.toggle(l)})}},{key:"addToDragGroup",value:function(e){for(var t,r=arguments.length,s=new Array(r>1?r-1:0),l=1;l<r;l++)s[l-1]=arguments[l];(t=this.elementDragHandler).addToDragGroup.apply(t,[e].concat(s))}},{key:"removeFromDragGroup",value:function(){var e;(e=this.elementDragHandler).removeFromDragGroup.apply(e,arguments)}},{key:"setDragGroupState",value:function(e){for(var t,r=arguments.length,s=new Array(r>1?r-1:0),l=1;l<r;l++)s[l-1]=arguments[l];(t=this.elementDragHandler).setDragGroupState.apply(t,[e].concat(s))}},{key:"clearDragGroup",value:function(e){this.elementDragHandler.clearDragGroup(e)}},{key:"consume",value:function(e,t){Jr(e,t)}},{key:"rotate",value:function(e,t,r){var s=this.getId(e);return this._managedElements[s]?(this._managedElements[s].el.style.transform="rotate("+t+"deg)",this._managedElements[s].el.style.transformOrigin="center center",Ge(_e(n.prototype),"rotate",this).call(this,e,t,r)):{c:new Set,e:new Set}}},{key:"addOverlayClass",value:function(e,t){if(Jt(e))e.instance.addClass(Ot(e),t);else if(zn(e))e.instance.addClass(Ur(e),t);else if(Qt(e))e.instance.addClass(En(e),t);else throw"Could not add class to overlay of type ["+e.type+"]"}},{key:"removeOverlayClass",value:function(e,t){if(Jt(e))e.instance.removeClass(Ot(e),t);else if(zn(e))e.instance.removeClass(Ur(e),t);else if(Qt(e))e.instance.removeClass(En(e),t);else throw"Could not remove class from overlay of type ["+e.type+"]"}},{key:"_paintOverlay",value:function(e,t,r){if(Jt(e)){Ot(e);var s=e.component.getXY();e.canvas.style.left=s.x+t.d.minx+"px",e.canvas.style.top=s.y+t.d.miny+"px"}else if(zn(e)){var l=isNaN(t.d.cxy.x)||isNaN(t.d.cxy.y)?"M 0 0":"M"+t.d.hxy.x+","+t.d.hxy.y+" L"+t.d.tail[0].x+","+t.d.tail[0].y+" L"+t.d.cxy.x+","+t.d.cxy.y+" L"+t.d.tail[1].x+","+t.d.tail[1].y+" Z";Nv(e,l,t,r)}else if(Qt(e)){En(e);var u=e.component.getXY();e.canvas.style.left=u.x+t.d.minx+"px",e.canvas.style.top=u.y+t.d.miny+"px"}else throw"Could not paint overlay of type ["+e.type+"]"}},{key:"setOverlayVisible",value:function(e,t){var r=t?"block":"none";function s(l){l!=null&&(l.style.display=r)}Jt(e)?s(Ot(e)):Qt(e)?s(En(e)):zn(e)&&s(e.path)}},{key:"reattachOverlay",value:function(e,t){Jt(e)?e.instance._appendElement(Ot(e),this.getContainer()):Qt(e)?e.instance._appendElement(En(e),this.getContainer()):zn(e)&&this._appendElement(Ur(e),t.connector.canvas)}},{key:"setOverlayHover",value:function(e,t){var r;Jt(e)?r=Ot(e):Qt(e)?r=En(e):zn(e)&&(r=Ur(e)),r!=null&&(this.hoverClass!=null&&(t?this.addClass(r,this.hoverClass):this.removeClass(r,this.hoverClass)),this.setHover(e.component,t))}},{key:"destroyOverlay",value:function(e){if(Jt(e)){var t=Ot(e);t.parentNode.removeChild(t),delete e.canvas,delete e.cachedDimensions}else if(aa(e)||sa(e)||la(e))Rv(e);else if(Qt(e)){var r=En(e);r.parentNode.removeChild(r),delete e.canvas,delete e.cachedDimensions}}},{key:"drawOverlay",value:function(e,t,r,s){if(Jt(e)||Qt(e)){var l=Ya._getDimensions(e);if(l!=null&&l.w!=null&&l.h!=null){var u={x:0,y:0};if(s)u={x:s.x,y:s.y};else if(t instanceof vr){var c=Array.isArray(e.location)?e.location:[e.location,e.location];u={x:c[0]*t.w,y:c[1]*t.h}}else{var d=e.location,f=!1;(Be(e.location)||e.location<0||e.location>1)&&(d=parseInt(""+e.location,10),f=!0),u=t.pointOnPath(d,f)}var v=u.x-l.w/2,p=u.y-l.h/2;return{component:e,d:{minx:v,miny:p,td:l,cxy:u},xmin:v,xmax:v+l.w,ymin:p,ymax:p+l.h}}else return{xmin:0,xmax:0,ymin:0,ymax:0}}else{if(aa(e)||sa(e)||la(e))return e.draw(t,r,s);throw"Could not draw overlay of type ["+e.type+"]"}}},{key:"updateLabel",value:function(e){if(In(e.label)){var t=e.label(this);t!=null?Ot(e).innerText=t:Ot(e).innerText=""}else e.labelText==null&&(e.labelText=e.label,e.labelText!=null?Ot(e).innerText=e.labelText:Ot(e).innerText="")}},{key:"setHover",value:function(e,t){e._hover=t,e instanceof tr&&e.endpoint!=null?this.setEndpointHover(e,t,-1):e instanceof ni&&e.connector!=null&&this.setConnectorHover(e.connector,t)}},{key:"paintConnector",value:function(e,t,r){Fv(this,e,t,r)}},{key:"setConnectorHover",value:function(e,t,r){if(t===!1||!this.currentlyDragging&&!this.isHoverSuspended()){var s=e.canvas;s!=null&&(e.hoverClass!=null&&(t?this.addClass(s,e.hoverClass):this.removeClass(s,e.hoverClass)),t?this.addClass(s,this.hoverClass):this.removeClass(s,this.hoverClass)),e.connection.hoverPaintStyle!=null&&(e.connection.paintStyleInUse=t?e.connection.hoverPaintStyle:e.connection.paintStyle,this._suspendDrawing||this._paintConnection(e.connection)),e.connection.endpoints[0]!==r&&this.setEndpointHover(e.connection.endpoints[0],t,0,!0),e.connection.endpoints[1]!==r&&this.setEndpointHover(e.connection.endpoints[1],t,1,!0)}}},{key:"destroyConnector",value:function(e){e.connector!=null&&il(e.connector)}},{key:"addConnectorClass",value:function(e,t){e.canvas&&this.addClass(e.canvas,t)}},{key:"removeConnectorClass",value:function(e,t){e.canvas&&this.removeClass(e.canvas,t)}},{key:"getConnectorClass",value:function(e){return e.canvas?e.canvas.className.baseVal:""}},{key:"setConnectorVisible",value:function(e,t){rl(e,t)}},{key:"applyConnectorType",value:function(e,t){if(e.canvas&&t.cssClass){var r=Array.isArray(t.cssClass)?t.cssClass:[t.cssClass];this.addClass(e.canvas,r.join(" "))}}},{key:"addEndpointClass",value:function(e,t){var r=wr(e.endpoint);r!=null&&this.addClass(r,t)}},{key:"applyEndpointType",value:function(e,t){if(t.cssClass){var r=wr(e.endpoint);if(r){var s=Array.isArray(t.cssClass)?t.cssClass:[t.cssClass];this.addClass(r,s.join(" "))}}}},{key:"destroyEndpoint",value:function(e){var t=this.endpointAnchorClassPrefix+(e.currentAnchorClass?"-"+e.currentAnchorClass:"");this.removeClass(e.element,t),il(e.endpoint)}},{key:"renderEndpoint",value:function(e,t){var r=ku[e.endpoint.type];r!=null?jv.paint(e.endpoint,r,t):We("jsPlumb: no endpoint renderer found for type ["+e.endpoint.type+"]")}},{key:"removeEndpointClass",value:function(e,t){var r=wr(e.endpoint);r!=null&&this.removeClass(r,t)}},{key:"getEndpointClass",value:function(e){var t=wr(e.endpoint);return t!=null?t.className:""}},{key:"setEndpointHover",value:function(e,t,r,s){if(e!=null&&(t===!1||!this.currentlyDragging&&!this.isHoverSuspended())){var l=wr(e.endpoint);if(l!=null&&(e.hoverClass!=null&&(t?this.addClass(l,e.hoverClass):this.removeClass(l,e.hoverClass)),r===0||r===1)){var u=r===0?this.hoverSourceClass:this.hoverTargetClass;t?this.addClass(l,u):this.removeClass(l,u)}if(e.hoverPaintStyle!=null&&(e.paintStyleInUse=t?e.hoverPaintStyle:e.paintStyle,this._suspendDrawing||this.renderEndpoint(e,e.paintStyleInUse)),!s)for(var c=0;c<e.connections.length;c++)this.setConnectorHover(e.connections[c].connector,t,e)}}},{key:"setEndpointVisible",value:function(e,t){rl(e.endpoint,t)}},{key:"setGroupVisible",value:function(e,t){for(var r=e.el.querySelectorAll(Ie),s=0;s<r.length;s++)t?this.show(r[s],!0):this.hide(r[s],!0)}},{key:"deleteConnection",value:function(e,t){return e!=null&&e.deleted!==!0?(e.endpoints[0].deleted!==!0&&this.setEndpointHover(e.endpoints[0],!1,0,!0),e.endpoints[1].deleted!==!0&&this.setEndpointHover(e.endpoints[1],!1,1,!0),Ge(_e(n.prototype),"deleteConnection",this).call(this,e,t)):!1}},{key:"addSourceSelector",value:function(e,t,r){return this.addDragFilter(e),Ge(_e(n.prototype),"addSourceSelector",this).call(this,e,t,r)}},{key:"removeSourceSelector",value:function(e){this.removeDragFilter(e.selector),Ge(_e(n.prototype),"removeSourceSelector",this).call(this,e)}},{key:"manage",value:function(e,t,r){if(this.containerType===wn.SVG&&!jd(e))throw new Error("ERROR: cannot manage non-svg element when container is an SVG element.");var s=Ge(_e(n.prototype),"manage",this).call(this,e,t,r);return s!=null&&this._resizeObserver!=null&&this._resizeObserver.observe(s.el),s}}]),n}(op),lp="circle",up=function(){$a(Nn.type,{makeNode:function(n,i){return Wt(lp,{cx:n.w/2,cy:n.h/2,r:n.radius})},updateNode:function(n,i){$t(i,{cx:""+n.w/2,cy:""+n.h/2,r:""+n.radius})}})},ri=function(o){Ee(n,o);var a=be(n);function n(i,e){var t;return $(this,n),t=a.call(this,i,e),h(m(t),"width",void 0),h(m(t),"height",void 0),h(m(t),"type",n.type),e=e||{},t.width=e.width||10,t.height=e.height||10,t}return J(n,null,[{key:"_getParams",value:function(e){return{width:e.width,height:e.height}}}]),n}(vr);h(ri,"type","Rectangle");var cp={type:ri.type,cls:ri,compute:function(a,n,i,e){var t=e.width||a.width,r=e.height||a.height,s=n.curX-t/2,l=n.curY-r/2;return a.x=s,a.y=l,a.w=t,a.h=r,[s,l,t,r]},getParams:function(a){return{width:a.width,height:a.height}}},dp="rect",fp=function(){$a(ri.type,{makeNode:function(n,i){return Wt(dp,{width:n.w,height:n.h})},updateNode:function(n,i){$t(i,{width:n.w,height:n.h})}})},uo=function(o){Ee(n,o);var a=be(n);function n(i,e){var t;return $(this,n),t=a.call(this,i,e),h(m(t),"type",n.type),t}return n}(vr);h(uo,"type","Blank");var hp={type:uo.type,cls:uo,compute:function(a,n,i,e){return a.x=n.curX,a.y=n.curY,a.w=10,a.h=0,[n.curX,n.curY,10,0]},getParams:function(a){return{}}},ol={width:10,height:0,fill:"transparent",stroke:"transparent"},vp=function(){$a(uo.type,{makeNode:function(n,i){return Wt("rect",ol)},updateNode:function(n,i){$t(i,ol)}})};up();vp();fp();var Lt;(function(o){o[o.top=0]="top",o[o.bottom=1]="bottom"})(Lt||(Lt={}));var Wa=new Map;Wa.set(Lt.top,[Gt.TopRight,Gt.TopLeft]);Wa.set(Lt.bottom,[Gt.BottomRight,Gt.BottomLeft]);var pp={deriveAnchor:function(a,n,i,e){return Wa.get(a)[n]}},Ka="jtk-scrollable-list",gp=vo(Ka),al="scroll";(function(){function o(a,n){var i=this;$(this,o),this.instance=a,h(this,"options",void 0),h(this,"count",void 0),h(this,"lists",void 0),this.count=0,this.lists={},this.options=n||{},this.instance.bind(ru,function(e){for(var t=i.instance.getSelector(e.el,gp),r=0;r<t.length;r++)i.addList(t[r])}),this.instance.bind(ou,function(e){i.removeList(e.el)}),this.instance.bind(_a,function(e,t){if(t==null){var r=i.findParentList(e.target);r!=null&&r.newConnection(e.connection,e.target,1);var s=i.findParentList(e.source);s!=null&&s.newConnection(e.connection,e.source,0)}}),this.instance.bind(su,function(e){var t=e.dropEndpoint.element,r=i.findParentList(t);return r==null||t.offsetTop>=r.domElement.scrollTop&&t.offsetTop+t.offsetHeight<=r.domElement.scrollTop+r.domElement.offsetHeight})}return J(o,[{key:"addList",value:function(n,i){var e=W({},pp);W(e,this.options),i=W(e,i||{});var t=[this.instance._instanceIndex,this.count++].join("_");return this.lists[t]=new yp(this.instance,n,i,t),this.lists[t]}},{key:"getList",value:function(n){var i=this.instance.getAttribute(n,Ka);if(i!=null)return this.lists[i]}},{key:"removeList",value:function(n){var i=this.getList(n);i&&(i.destroy(),delete this.lists[i.id])}},{key:"findParentList",value:function(n){for(var i=n.parentNode,e=this.instance.getContainer(),t;i!=null&&i!==e&&i!==document;){if(t=this.getList(i),t!=null)return t;i=i.parentNode}}}]),o})();var yp=function(){function o(a,n,i,e){$(this,o),this.instance=a,this.el=n,this.options=i,this.id=e,h(this,"_scrollHandler",void 0),h(this,"domElement",void 0),h(this,"elId",void 0),this.domElement=n,this.elId=this.instance.getId(n),a.setAttribute(n,Ka,e),this._scrollHandler=this.scrollHandler.bind(this),this.domElement._jsPlumbScrollHandler=this._scrollHandler,a.on(n,al,this._scrollHandler),this._scrollHandler()}return J(o,[{key:"deriveAnchor",value:function(n,i,e,t){return this.options.anchor?this.options.anchor:this.options.deriveAnchor(n,i,e,t)}},{key:"deriveEndpoint",value:function(n,i,e,t){return this.options.deriveEndpoint?this.options.deriveEndpoint(n,i,e,t):this.options.endpoint?this.options.endpoint:e.endpoint.type}},{key:"newConnection",value:function(n,i,e){i.offsetTop<this.el.scrollTop?this._proxyConnection(i,n,e,Lt.top):i.offsetTop+i.offsetHeight>this.el.scrollTop+this.domElement.offsetHeight&&this._proxyConnection(i,n,e,Lt.bottom)}},{key:"scrollHandler",value:function(){for(var n=this,i=this.instance.getSelector(this.el,Ie),e=function(s){if(i[s].offsetTop<n.el.scrollTop)i[s]._jsPlumbProxies=i[s]._jsPlumbProxies||[],n.instance.select({source:i[s]}).each(function(u){n._proxyConnection(i[s],u,0,Lt.top)}),n.instance.select({target:i[s]}).each(function(u){n._proxyConnection(i[s],u,1,Lt.top)});else if(i[s].offsetTop+i[s].offsetHeight>n.el.scrollTop+n.domElement.offsetHeight)i[s]._jsPlumbProxies=i[s]._jsPlumbProxies||[],n.instance.select({source:i[s]}).each(function(u){n._proxyConnection(i[s],u,0,Lt.bottom)}),n.instance.select({target:i[s]}).each(function(u){n._proxyConnection(i[s],u,1,Lt.bottom)});else if(i[s]._jsPlumbProxies){for(var l=0;l<i[s]._jsPlumbProxies.length;l++)n.instance.unproxyConnection(i[s]._jsPlumbProxies[l][0],i[s]._jsPlumbProxies[l][1]);delete i[s]._jsPlumbProxies}n.instance.revalidate(i[s])},t=0;t<i.length;t++)e(t)}},{key:"_proxyConnection",value:function(n,i,e,t){var r=this;this.instance.proxyConnection(i,e,this.domElement,function(s,l){return r.deriveEndpoint(t,l,i.endpoints[l],i)},function(s,l){return r.deriveAnchor(t,l,i.endpoints[l],i)}),n._jsPlumbProxies=n._jsPlumbProxies||[],n._jsPlumbProxies.push([i,e])}},{key:"destroy",value:function(){this.instance.off(this.el,al,this._scrollHandler),delete this.domElement._jsPlumbScrollHandler;for(var n=this.instance.getSelector(this.el,Ie),i=0;i<n.length;i++)if(n[i]._jsPlumbProxies){for(var e=0;e<n[i]._jsPlumbProxies.length;e++)this.instance.unproxyConnection(n[i]._jsPlumbProxies[e][0],n[i]._jsPlumbProxies[e][1]);delete n[i]._jsPlumbProxies}}}]),o}(),sl=1e-10;function ll(o){var a=Math.floor(o),n=Math.ceil(o);return o-a<sl?a:n-o<sl?n:o}var za=function(o){Ee(n,o);var a=be(n);function n(i){var e;$(this,n),e=a.call(this,i),h(m(e),"type",n.segmentType),h(m(e),"cx",void 0),h(m(e),"cy",void 0),h(m(e),"radius",void 0),h(m(e),"anticlockwise",void 0),h(m(e),"startAngle",void 0),h(m(e),"endAngle",void 0),h(m(e),"sweep",void 0),h(m(e),"length",void 0),h(m(e),"circumference",void 0),h(m(e),"frac",void 0),e.cx=i.cx,e.cy=i.cy,e.radius=i.r,e.anticlockwise=i.ac,i.startAngle&&i.endAngle?(e.startAngle=i.startAngle,e.endAngle=i.endAngle,e.x1=e.cx+e.radius*Math.cos(e.startAngle),e.y1=e.cy+e.radius*Math.sin(e.startAngle),e.x2=e.cx+e.radius*Math.cos(e.endAngle),e.y2=e.cy+e.radius*Math.sin(e.endAngle)):(e.startAngle=e._calcAngle(e.x1,e.y1),e.endAngle=e._calcAngle(e.x2,e.y2)),e.endAngle<0&&(e.endAngle+=yn),e.startAngle<0&&(e.startAngle+=yn);var t=e.endAngle<e.startAngle?e.endAngle+yn:e.endAngle;return e.sweep=Math.abs(t-e.startAngle),e.anticlockwise&&(e.sweep=yn-e.sweep),e.circumference=2*Math.PI*e.radius,e.frac=e.sweep/yn,e.length=e.circumference*e.frac,e.extents={xmin:e.cx-e.radius,xmax:e.cx+e.radius,ymin:e.cy-e.radius,ymax:e.cy+e.radius},e}return J(n,[{key:"_calcAngle",value:function(e,t){return bh({x:this.cx,y:this.cy},{x:e,y:t})}},{key:"_calcAngleForLocation",value:function(e,t){if(e.anticlockwise){var r=e.startAngle<e.endAngle?e.startAngle+yn:e.startAngle,s=Math.abs(r-e.endAngle);return r-s*t}else{var l=e.endAngle<e.startAngle?e.endAngle+yn:e.endAngle,u=Math.abs(l-e.startAngle);return e.startAngle+u*t}}},{key:"getPath",value:function(e){var t=this.sweep>Math.PI?1:0,r=this.anticlockwise?0:1;return(e?"M"+this.x1+" "+this.y1+" ":"")+"A "+this.radius+" "+this.radius+" 0 "+t+","+r+" "+this.x2+" "+this.y2}},{key:"getLength",value:function(){return this.length}},{key:"pointOnPath",value:function(e,t){if(e===0)return{x:this.x1,y:this.y1,theta:this.startAngle};if(e===1)return{x:this.x2,y:this.y2,theta:this.endAngle};t&&(e=e/length);var r=this._calcAngleForLocation(this,e),s=this.cx+this.radius*Math.cos(r),l=this.cy+this.radius*Math.sin(r);return{x:ll(s),y:ll(l),theta:r}}},{key:"gradientAtPoint",value:function(e,t){var r=this.pointOnPath(e,t),s=Eh({x:this.cx,y:this.cy},r);return!this.anticlockwise&&(s===1/0||s===-1/0)&&(s*=-1),s}},{key:"pointAlongPathFrom",value:function(e,t,r){var s=this.pointOnPath(e,r),l=t/this.circumference*2*Math.PI,u=this.anticlockwise?-1:1,c=s.theta+u*l,d=this.cx+this.radius*Math.cos(c),f=this.cy+this.radius*Math.sin(c);return{x:d,y:f}}}]),n}(Na);h(za,"segmentType","Arc");var Lu=function(o){Ee(n,o);var a=be(n);function n(i,e){var t;return $(this,n),t=a.call(this,i,e),t.connection=i,h(m(t),"showLoopback",void 0),h(m(t),"curviness",void 0),h(m(t),"margin",void 0),h(m(t),"proximityLimit",void 0),h(m(t),"orientation",void 0),h(m(t),"loopbackRadius",void 0),h(m(t),"clockwise",void 0),h(m(t),"isLoopbackCurrently",void 0),h(m(t),"geometry",null),e=e||{},t.showLoopback=e.showLoopback!==!1,t.curviness=e.curviness||10,t.margin=e.margin||5,t.proximityLimit=e.proximityLimit||80,t.clockwise=e.orientation&&e.orientation==="clockwise",t.loopbackRadius=e.loopbackRadius||25,t.isLoopbackCurrently=!1,t}return J(n,[{key:"getDefaultStubs",value:function(){return[0,0]}},{key:"_compute",value:function(e,t){var r=t.sourcePos,s=t.targetPos,l=Math.abs(r.curX-s.curX),u=Math.abs(r.curY-s.curY);if(!this.showLoopback||t.sourceEndpoint.elementId!==t.targetEndpoint.elementId)this.isLoopbackCurrently=!1,this._computeBezier(e,t,r,s,l,u);else{this.isLoopbackCurrently=!0;var c=t.sourcePos.curX,d=t.sourcePos.curY-this.margin,f=c,v=d-this.loopbackRadius,p=f-this.loopbackRadius,y=v-this.loopbackRadius;l=2*this.loopbackRadius,u=2*this.loopbackRadius,e.points[0]=p,e.points[1]=y,e.points[2]=l,e.points[3]=u,this._addSegment(za,{loopback:!0,x1:c-p+4,y1:d-y,startAngle:0,endAngle:2*Math.PI,r:this.loopbackRadius,ac:!this.clockwise,x2:c-p-4,y2:d-y,cx:f-p,cy:v-y})}}},{key:"exportGeometry",value:function(){return this.geometry==null?null:{controlPoints:[W({},this.geometry.controlPoints[0]),W({},this.geometry.controlPoints[1])],source:W({},this.geometry.source),target:W({},this.geometry.target)}}},{key:"transformGeometry",value:function(e,t,r){return{controlPoints:[{x:e.controlPoints[0].x+t,y:e.controlPoints[0].y+r},{x:e.controlPoints[1].x+t,y:e.controlPoints[1].y+r}],source:this.transformAnchorPlacement(e.source,t,r),target:this.transformAnchorPlacement(e.target,t,r)}}},{key:"importGeometry",value:function(e){return e!=null?e.controlPoints==null||e.controlPoints.length!=2?(We("jsPlumb Bezier: cannot import geometry; controlPoints missing or does not have length 2"),this.setGeometry(null,!0),!1):e.controlPoints[0].x==null||e.controlPoints[0].y==null||e.controlPoints[1].x==null||e.controlPoints[1].y==null?(We("jsPlumb Bezier: cannot import geometry; controlPoints malformed"),this.setGeometry(null,!0),!1):e.source==null||e.source.curX==null||e.source.curY==null?(We("jsPlumb Bezier: cannot import geometry; source missing or malformed"),this.setGeometry(null,!0),!1):e.target==null||e.target.curX==null||e.target.curY==null?(We("jsPlumb Bezier: cannot import geometry; target missing or malformed"),this.setGeometry(null,!0),!1):(this.setGeometry(e,!1),!0):!1}}]),n}(yo),Nt={subtract:function(a,n){return{x:a.x-n.x,y:a.y-n.y}},dotProduct:function(a,n){return a.x*n.x+a.y*n.y},square:function(a){return Math.sqrt(a.x*a.x+a.y*a.y)},scale:function(a,n){return{x:a.x*n,y:a.y*n}}},Nu=64,mp=Math.pow(2,-Nu-1);function Ep(o,a){for(var n=[],i=Sp(o,a),e=a.length-1,t=2*e-1,r=ua(i,t,n,0),s=Nt.subtract(o,a[0]),l=Nt.square(s),u=0,c,d=0;d<r;d++)s=Nt.subtract(o,Za(a,e,n[d],null,null)),c=Nt.square(s),c<l&&(l=c,u=n[d]);return s=Nt.subtract(o,a[e]),c=Nt.square(s),c<l&&(l=c,u=1),{location:u,distance:l}}function bp(o,a){var n=Ep(o,a);return{point:Za(a,a.length-1,n.location,null,null),location:n.location}}function Sp(o,a){for(var n=a.length-1,i=2*n-1,e=[],t=[],r=[],s=[],l=[[1,.6,.3,.1],[.4,.6,.6,.4],[.1,.3,.6,1]],u=0;u<=n;u++)e[u]=Nt.subtract(a[u],o);for(var c=0;c<=n-1;c++)t[c]=Nt.subtract(a[c+1],a[c]),t[c]=Nt.scale(t[c],3);for(var d=0;d<=n-1;d++)for(var f=0;f<=n;f++)r[d]||(r[d]=[]),r[d][f]=Nt.dotProduct(t[d],e[f]);for(var v=0;v<=i;v++)s[v]||(s[v]=[]),s[v].y=0,s[v].x=parseFloat(""+v)/i;for(var p=n,y=n-1,g=0;g<=p+y;g++)for(var E=Math.max(0,g-y),b=Math.min(g,p),S=E;S<=b;S++){var C=g-S;s[S+C].y+=r[C][S]*l[C][S]}return s}function ua(o,a,n,i){var e=[],t=[],r,s,l=[],u=[];switch(Cp(o,a)){case 0:return 0;case 1:{if(i>=Nu)return n[0]=(o[0].x+o[a].x)/2,1;if(xp(o,a))return n[0]=Pp(o,a),1;break}}Za(o,a,.5,e,t),r=ua(e,a,l,i+1),s=ua(t,a,u,i+1);for(var c=0;c<r;c++)n[c]=l[c];for(var d=0;d<s;d++)n[d+r]=u[d];return r+s}function Cp(o,a){var n=0,i,e;i=e=Ji(o[0].y);for(var t=1;t<=a;t++)i=Ji(o[t].y),i!=e&&n++,e=i;return n}function xp(o,a){var n,i,e,t,r,s,l,u,c,d,f,v,p,y,g,E;s=o[0].y-o[a].y,l=o[a].x-o[0].x,u=o[0].x*o[a].y-o[a].x*o[0].y;var b,S;b=S=0;for(var C=1;C<a;C++){var x=s*o[C].x+l*o[C].y+u;x>b?b=x:x<S&&(S=x)}return f=0,v=1,p=0,y=s,g=l,E=u-b,c=f*g-y*v,d=1/c,i=(v*E-g*p)*d,y=s,g=l,E=u-S,c=f*g-y*v,d=1/c,e=(v*E-g*p)*d,t=Math.min(i,e),r=Math.max(i,e),n=r-t,n<mp?1:0}function Pp(o,a){var n=1,i=0,e=o[a].x-o[0].x,t=o[a].y-o[0].y,r=o[0].x-0,s=o[0].y-0,l=e*i-t*n,u=1/l,c=(e*s-t*r)*u;return 0+n*c}function Za(o,a,n,i,e){for(var t=[[]],r=0;r<=a;r++)t[0][r]=o[r];for(var s=1;s<=a;s++)for(var l=0;l<=a-s;l++)t[s]||(t[s]=[]),t[s][l]||(t[s][l]={}),t[s][l].x=(1-n)*t[s-1][l].x+n*t[s-1][l+1].x,t[s][l].y=(1-n)*t[s-1][l].y+n*t[s-1][l+1].y;if(i!=null)for(var u=0;u<=a;u++)i[u]=t[u][0];if(e!=null)for(var c=0;c<=a;c++)e[c]=t[a-c][c];return t[a][0]}function Tp(o,a){var n=[];o--;for(var i=0;i<=o;i++)n.push(Op(i/o,a));return n}function Op(o,a){var n={x:0,y:0};if(o===0)return a[0];var i=a.length-1;if(o===1)return a[i];var e=a,t=1-o;if(i===0)return a[0];if(i===1)return{x:t*e[0].x+o*e[1].x,y:t*e[0].y+o*e[1].y};if(4>i){var r=t*t,s=o*o,l=0,u,c,d;return i===2?(e=[e[0],e[1],e[2],n],u=r,c=2*(t*o),d=s):i===3&&(u=r*t,c=3*(r*o),d=3*(t*s),l=o*s),{x:u*e[0].x+c*e[1].x+d*e[2].x+l*e[3].x,y:u*e[0].y+c*e[1].y+d*e[2].y+l*e[3].y}}else return n}function Ap(o){var a=0;if(!Fu(o))for(var n=16,i=Tp(n,o),e=0;e<n-1;e++){var t=i[e],r=i[e+1];a+=Ru(t,r)}return a}var ul=new Map;function Dp(o){var a=ul.get(o);if(!a){a=[];var n=function(){return function(v){return Math.pow(v,o)}},i=function(){return function(v){return Math.pow(1-v,o)}},e=function(v){return function(p){return v}},t=function(){return function(v){return v}},r=function(){return function(v){return 1-v}},s=function(v){return function(p){for(var y=1,g=0;g<v.length;g++)y=y*v[g](p);return y}};a.push(n());for(var l=1;l<o;l++){for(var u=[e(o)],c=0;c<o-l;c++)u.push(t());for(var d=0;d<l;d++)u.push(r());a.push(s(u))}a.push(i()),ul.set(o,a)}return a}function ii(o,a){for(var n=Dp(o.length-1),i=0,e=0,t=0;t<o.length;t++)i=i+o[t].x*n[t](a),e=e+o[t].y*n[t](a);return{x:i,y:e}}function Ru(o,a){return Math.sqrt(Math.pow(o.x-a.x,2)+Math.pow(o.y-a.y,2))}function Fu(o){return o[0].x===o[1].x&&o[0].y===o[1].y}function Gu(o,a,n){if(Fu(o))return{point:o[0],location:a};for(var i=ii(o,a),e=0,t=a,r=n>0?1:-1,s=null;e<Math.abs(n);)t+=.005*r,s=ii(o,t),e+=Ru(s,i),i=s;return{point:s,location:t}}function Ip(o,a,n){return Gu(o,a,n).point}function _p(o,a,n){return Gu(o,a,n).location}function wp(o,a){var n=ii(o,a),i=ii(o.slice(0,o.length-1),a),e=i.y-n.y,t=i.x-n.x;return e===0?1/0:Math.atan(e/t)}function Mp(o,a,n,i,e){var t=i-a,r=o-n,s=o*(a-i)+a*(n-o),l=kp(e),u=[t*l[0][0]+r*l[1][0],t*l[0][1]+r*l[1][1],t*l[0][2]+r*l[1][2],t*l[0][3]+r*l[1][3]+s],c=Lp.apply(null,u),d=[];if(c!=null)for(var f=0;f<3;f++){var v=c[f],p=Math.pow(v,2),y=Math.pow(v,3),g={x:l[0][0]*y+l[0][1]*p+l[0][2]*v+l[0][3],y:l[1][0]*y+l[1][1]*p+l[1][2]*v+l[1][3]},E=void 0;n-o!==0?E=(g[0]-o)/(n-o):E=(g[1]-a)/(i-a),v>=0&&v<=1&&E>=0&&E<=1&&d.push(g)}return d}function cl(o,a){return[-o[0][a]+3*o[1][a]+-3*o[2][a]+o[3][a],3*o[0][a]-6*o[1][a]+3*o[2][a],-3*o[0][a]+3*o[1][a],o[0][a]]}function kp(o){return[cl(o,"x"),cl(o,"y")]}function Lp(o,a,n,i){var e=a/o,t=n/o,r=i/o,s=(3*t-Math.pow(e,2))/9,l=(9*e*t-27*r-2*Math.pow(e,3))/54,u=Math.pow(s,3)+Math.pow(l,2),c,d,f=[0,0,0];if(u>=0)c=Ji(l+Math.sqrt(u))*Math.pow(Math.abs(l+Math.sqrt(u)),1/3),d=Ji(l-Math.sqrt(u))*Math.pow(Math.abs(l-Math.sqrt(u)),1/3),f[0]=-e/3+(c+d),f[1]=-e/3-(c+d)/2,f[2]=-e/3-(c+d)/2,Math.abs(Math.sqrt(3)*(c-d)/2)!==0&&(f[1]=-1,f[2]=-1);else{var v=Math.acos(l/Math.sqrt(-Math.pow(s,3)));f[0]=2*Math.sqrt(-s)*Math.cos(v/3)-e/3,f[1]=2*Math.sqrt(-s)*Math.cos((v+2*Math.PI)/3)-e/3,f[2]=2*Math.sqrt(-s)*Math.cos((v+4*Math.PI)/3)-e/3}for(var p=0;p<3;p++)(f[p]<0||f[p]>1)&&(f[p]=-1);return f}var Ja=function(o){Ee(n,o);var a=be(n);function n(i){var e;return $(this,n),e=a.call(this,i),h(m(e),"curve",void 0),h(m(e),"cp1x",void 0),h(m(e),"cp1y",void 0),h(m(e),"cp2x",void 0),h(m(e),"cp2y",void 0),h(m(e),"length",0),h(m(e),"type",n.segmentType),e.cp1x=i.cp1x,e.cp1y=i.cp1y,e.cp2x=i.cp2x,e.cp2y=i.cp2y,e.x1=i.x1,e.x2=i.x2,e.y1=i.y1,e.y2=i.y2,e.curve=[{x:e.x1,y:e.y1},{x:e.cp1x,y:e.cp1y},{x:e.cp2x,y:e.cp2y},{x:e.x2,y:e.y2}],e.extents={xmin:Math.min(e.x1,e.x2,e.cp1x,e.cp2x),ymin:Math.min(e.y1,e.y2,e.cp1y,e.cp2y),xmax:Math.max(e.x1,e.x2,e.cp1x,e.cp2x),ymax:Math.max(e.y1,e.y2,e.cp1y,e.cp2y)},e}return J(n,[{key:"getPath",value:function(e){return(e?"M "+this.x2+" "+this.y2+" ":"")+"C "+this.cp2x+" "+this.cp2y+" "+this.cp1x+" "+this.cp1y+" "+this.x1+" "+this.y1}},{key:"pointOnPath",value:function(e,t){return e=n._translateLocation(this.curve,e,t),ii(this.curve,e)}},{key:"gradientAtPoint",value:function(e,t){return e=n._translateLocation(this.curve,e,t),wp(this.curve,e)}},{key:"pointAlongPathFrom",value:function(e,t,r){return e=n._translateLocation(this.curve,e,r),Ip(this.curve,e,t)}},{key:"getLength",value:function(){return(this.length==null||this.length===0)&&(this.length=Ap(this.curve)),this.length}},{key:"findClosestPointOnPath",value:function(e,t){var r=bp({x:e,y:t},this.curve);return{d:Math.sqrt(Math.pow(r.point.x-e,2)+Math.pow(r.point.y-t,2)),x:r.point.x,y:r.point.y,l:1-r.location,s:this,x1:null,y1:null,x2:null,y2:null}}},{key:"lineIntersection",value:function(e,t,r,s){return Mp(e,t,r,s,this.curve)}}],[{key:"_translateLocation",value:function(e,t,r){return r&&(t=_p(e,t>0?0:1,t)),t}}]),n}(Na);h(Ja,"segmentType","Bezier");var ca=function(o){Ee(n,o);var a=be(n);function n(i,e){var t;return $(this,n),t=a.call(this,i,e),t.connection=i,h(m(t),"type",n.type),h(m(t),"majorAnchor",void 0),h(m(t),"minorAnchor",void 0),e=e||{},t.majorAnchor=e.curviness||150,t.minorAnchor=10,t}return J(n,[{key:"getCurviness",value:function(){return this.majorAnchor}},{key:"_findControlPoint",value:function(e,t,r,s,l){var u=s[0]!==l[0]||s[1]===l[1],c={x:0,y:0};return u?(l[0]===0?c.x=r.curX<t.curX?e.x+this.minorAnchor:e.x-this.minorAnchor:c.x=e.x+this.majorAnchor*l[0],l[1]===0?c.y=r.curY<t.curY?e.y+this.minorAnchor:e.y-this.minorAnchor:c.y=e.y+this.majorAnchor*s[1]):(s[0]===0?c.x=t.curX<r.curX?e.x+this.minorAnchor:e.x-this.minorAnchor:c.x=e.x-this.majorAnchor*s[0],s[1]===0?c.y=t.curY<r.curY?e.y+this.minorAnchor:e.y-this.minorAnchor:c.y=e.y+this.majorAnchor*l[1]),c}},{key:"_computeBezier",value:function(e,t,r,s,l,u){var c,d,f=r.curX<s.curX?l:0,v=r.curY<s.curY?u:0,p=r.curX<s.curX?0:l,y=r.curY<s.curY?0:u;this.edited!==!0?(c=this._findControlPoint({x:f,y:v},r,s,e.so,e.to),d=this._findControlPoint({x:p,y},s,r,e.to,e.so)):(c=this.geometry.controlPoints[0],d=this.geometry.controlPoints[1]),this.geometry={controlPoints:[c,d],source:t.sourcePos,target:t.targetPos},this._addSegment(Ja,{x1:f,y1:v,x2:p,y2:y,cp1x:c.x,cp1y:c.y,cp2x:d.x,cp2y:d.y})}}]),n}(Lu);h(ca,"type","Bezier");function Np(o,a,n,i){return o<=n&&i<=a?1:o<=n&&a<=i?2:n<=o&&i>=a?3:4}function Rp(o,a,n,i,e,t,r,s,l){if(s<=l)return{x:o,y:a};if(n===1)return i.curY<=0&&e.curY>=1?{x:o+(i.x<.5?-1*t:t),y:a}:i.curX>=1&&e.curX<=0?{x:o,y:a+(i.y<.5?-1*r:r)}:{x:o+-1*t,y:a+-1*r};if(n===2)return i.curY>=1&&e.curY<=0?{x:o+(i.x<.5?-1*t:t),y:a}:i.curX>=1&&e.curX<=0?{x:o,y:a+(i.y<.5?-1*r:r)}:{x:o+t,y:a+-1*r};if(n===3)return i.curY>=1&&e.curY<=0?{x:o+(i.x<.5?-1*t:t),y:a}:i.curX<=0&&e.curX>=1?{x:o,y:a+(i.y<.5?-1*r:r)}:{x:o+-1*t,y:a+-1*r};if(n===4)return i.curY<=0&&e.curY>=1?{x:o+(i.x<.5?-1*t:t),y:a}:i.curX<=0&&e.curX>=1?{x:o,y:a+(i.y<.5?-1*r:r)}:{x:o+t,y:a+-1*r}}var da=function(o){Ee(n,o);var a=be(n);function n(i,e){var t;return $(this,n),t=a.call(this,i,e),t.connection=i,h(m(t),"type",n.type),h(m(t),"_controlPoint",void 0),t.curviness=e.curviness||10,t.margin=e.margin||5,t.proximityLimit=e.proximityLimit||80,t.clockwise=e.orientation&&e.orientation==="clockwise",t}return J(n,[{key:"_computeBezier",value:function(e,t,r,s,l,u){var c=r.curX<s.curX?0:l,d=r.curY<s.curY?0:u,f=r.curX<s.curX?l:0,v=r.curY<s.curY?u:0;if(r.x===0&&(c-=this.margin),r.x===1&&(c+=this.margin),r.y===0&&(d-=this.margin),r.y===1&&(d+=this.margin),s.x===0&&(f-=this.margin),s.x===1&&(f+=this.margin),s.y===0&&(v-=this.margin),s.y===1&&(v+=this.margin),this.edited!==!0){var p=(c+f)/2,y=(d+v)/2,g=Np(c,d,f,v),E=Math.sqrt(Math.pow(f-c,2)+Math.pow(v-d,2));this._controlPoint=Rp(p,y,g,t.sourcePos,t.targetPos,this.curviness,this.curviness,E,this.proximityLimit)}else this._controlPoint=this.geometry.controlPoints[0];var b,S,C,x;b=this._controlPoint.x,S=this._controlPoint.x,C=this._controlPoint.y,x=this._controlPoint.y,this.geometry={controlPoints:[this._controlPoint,this._controlPoint],source:t.sourcePos,target:t.targetPos},this._addSegment(Ja,{x1:f,y1:v,x2:c,y2:d,cp1x:b,cp1y:C,cp2x:S,cp2y:x})}}]),n}(Lu);h(da,"type","StateMachine");li.register(ca.type,ca);li.register(da.type,da);function dl(o){return o<0?-1:o===0?0:1}function fl(o){return[dl(o[2]-o[0]),dl(o[3]-o[1])]}function hl(o){return Math.sqrt(Math.pow(o[0]-o[2],2)+Math.pow(o[1]-o[3],2))}function vl(o){var a=[];return a.push.apply(a,o),a}var fa=function(o){Ee(n,o);var a=be(n);function n(i,e){var t;return $(this,n),t=a.call(this,i,e),t.connection=i,h(m(t),"type",n.type),h(m(t),"internalSegments",[]),h(m(t),"midpoint",void 0),h(m(t),"alwaysRespectStubs",void 0),h(m(t),"cornerRadius",void 0),h(m(t),"lastx",void 0),h(m(t),"lasty",void 0),h(m(t),"lastOrientation",void 0),h(m(t),"loopbackRadius",void 0),h(m(t),"isLoopbackCurrently",void 0),t.midpoint=e.midpoint==null||isNaN(e.midpoint)?.5:e.midpoint,t.cornerRadius=e.cornerRadius!=null?e.cornerRadius:0,t.alwaysRespectStubs=e.alwaysRespectStubs===!0,t.lastx=null,t.lasty=null,t.lastOrientation=null,t.loopbackRadius=e.loopbackRadius||25,t.isLoopbackCurrently=!1,t}return J(n,[{key:"getDefaultStubs",value:function(){return[30,30]}},{key:"addASegment",value:function(e,t,r){if(!(this.lastx===e&&this.lasty===t)){var s=this.lastx==null?r.sx:this.lastx,l=this.lasty==null?r.sy:this.lasty,u=s===e?"v":"h";this.lastx=e,this.lasty=t,this.internalSegments.push([s,l,e,t,u])}}},{key:"writeSegments",value:function(e){for(var t=null,r,s,l,u=0;u<this.internalSegments.length-1;u++){if(t=t||vl(this.internalSegments[u]),r=vl(this.internalSegments[u+1]),s=fl(t),l=fl(r),this.cornerRadius>0&&t[4]!==r[4]){var c=Math.min(hl(t),hl(r)),d=Math.min(this.cornerRadius,c/2);t[2]-=s[0]*d,t[3]-=s[1]*d,r[0]+=l[0]*d,r[1]+=l[1]*d;var f=s[1]===l[0]&&l[0]===1||s[1]===l[0]&&l[0]===0&&s[0]!==l[1]||s[1]===l[0]&&l[0]===-1,v=r[1]>t[3]?1:-1,p=r[0]>t[2]?1:-1,y=v===p,g=y&&f||!y&&!f?r[0]:t[2],E=y&&f||!y&&!f?t[3]:r[1];this._addSegment(Dn,{x1:t[0],y1:t[1],x2:t[2],y2:t[3]}),this._addSegment(za,{r:d,x1:t[2],y1:t[3],x2:r[0],y2:r[1],cx:g,cy:E,ac:f})}else this._addSegment(Dn,{x1:t[0],y1:t[1],x2:t[2],y2:t[3]});t=r}r!=null&&this._addSegment(Dn,{x1:r[0],y1:r[1],x2:r[2],y2:r[3]})}},{key:"_compute",value:function(e,t){var r=this;this.internalSegments.length=0,this.lastx=null,this.lasty=null,this.lastOrientation=null;var s=function(O){return[e.startStubX,e.startStubY,e.endStubX,e.endStubY]},l={perpendicular:s,orthogonal:s,opposite:function(O){var P=e,A=O==="x"?0:1,_={x:function(){return P.so[A]===1&&(P.startStubX>P.endStubX&&P.tx>P.startStubX||P.sx>P.endStubX&&P.tx>P.sx)||P.so[A]===-1&&(P.startStubX<P.endStubX&&P.tx<P.startStubX||P.sx<P.endStubX&&P.tx<P.sx)},y:function(){return P.so[A]===1&&(P.startStubY>P.endStubY&&P.ty>P.startStubY||P.sy>P.endStubY&&P.ty>P.sy)||P.so[A]===-1&&(P.startStubY<P.endStubY&&P.ty<P.startStubY||P.sy<P.endStubY&&P.ty<P.sy)}};return!r.alwaysRespectStubs&&_[O]()?{x:[(e.sx+e.tx)/2,e.startStubY,(e.sx+e.tx)/2,e.endStubY],y:[e.startStubX,(e.sy+e.ty)/2,e.endStubX,(e.sy+e.ty)/2]}[O]:[e.startStubX,e.startStubY,e.endStubX,e.endStubY]}},u=l[e.anchorOrientation](e.sourceAxis),c=e.sourceAxis==="x"?0:1,d=e.sourceAxis==="x"?1:0,f=u[c],v=u[d],p=u[c+2],y=u[d+2];this.addASegment(u[0],u[1],e);var g=e.startStubX+(e.endStubX-e.startStubX)*this.midpoint,E=e.startStubY+(e.endStubY-e.startStubY)*this.midpoint,b={x:[0,1],y:[1,0]},S={perpendicular:function(O,P,A,_,R){var M=e,F={x:[[[1,2,3,4],null,[2,1,4,3]],null,[[4,3,2,1],null,[3,4,1,2]]],y:[[[3,2,1,4],null,[2,3,4,1]],null,[[4,1,2,3],null,[1,4,3,2]]]},L={x:[[M.startStubX,M.endStubX],null,[M.endStubX,M.startStubX]],y:[[M.startStubY,M.endStubY],null,[M.endStubY,M.startStubY]]},k={x:[[g,M.startStubY],[g,M.endStubY]],y:[[M.startStubX,E],[M.endStubX,E]]},N={x:[[M.endStubX,M.startStubY]],y:[[M.startStubX,M.endStubY]]},V={x:[[M.startStubX,M.endStubY],[M.endStubX,M.endStubY]],y:[[M.endStubX,M.startStubY],[M.endStubX,M.endStubY]]},ae={x:[[M.startStubX,E],[M.endStubX,E],[M.endStubX,M.endStubY]],y:[[g,M.startStubY],[g,M.endStubY],[M.endStubX,M.endStubY]]},ve={x:[M.startStubY,M.endStubY],y:[M.startStubX,M.endStubX]},Ue=b[O][0],Ce=b[O][1],Se=M.so[Ue]+1,Ae=M.to[Ce]+1,B=M.to[Ce]===-1&&ve[O][1]<ve[O][0]||M.to[Ce]===1&&ve[O][1]>ve[O][0],H=L[O][Se][0],Q=L[O][Se][1],ne=F[O][Se][Ae];if(M.segment===ne[3]||M.segment===ne[2]&&B)return k[O];if(M.segment===ne[2]&&Q<H)return N[O];if(M.segment===ne[2]&&Q>=H||M.segment===ne[1]&&!B)return ae[O];if(M.segment===ne[0]||M.segment===ne[1]&&B)return V[O]},orthogonal:function(O,P,A,_,R){var M=e,F={x:M.so[0]===-1?Math.min(P,_):Math.max(P,_),y:M.so[1]===-1?Math.min(P,_):Math.max(P,_)}[O];return{x:[[F,A],[F,R],[_,R]],y:[[A,F],[R,F],[R,_]]}[O]},opposite:function(O,P,A,_,R){var M=e,F={x:"y",y:"x"}[O],L={x:"h",y:"w"}[O],k=M["is"+O.toUpperCase()+"GreaterThanStubTimes2"];if(t.sourceEndpoint.elementId===t.targetEndpoint.elementId){var N=A+(1-t.sourceEndpoint._anchor.computedPosition[F])*t.sourceInfo[L]+r.maxStub;return{x:[[P,N],[_,N]],y:[[N,P],[N,_]]}[O]}else{if(!k||M.so[c]===1&&P>_||M.so[c]===-1&&P<_)return{x:[[P,E],[_,E]],y:[[g,P],[g,_]]}[O];if(M.so[c]===1&&P<_||M.so[c]===-1&&P>_)return{x:[[g,M.sy],[g,M.ty]],y:[[M.sx,E],[M.tx,E]]}[O]}}},C=S[e.anchorOrientation](e.sourceAxis,f,v,p,y);if(C)for(var x=0;x<C.length;x++)this.addASegment(C[x][0],C[x][1],e);this.addASegment(u[2],u[3],e),this.addASegment(e.tx,e.ty,e),this.writeSegments(e)}},{key:"transformGeometry",value:function(e,t,r){return e}}]),n}(yo);h(fa,"type","Flowchart");li.register(fa.type,fa);ln.registerHandler(Yv);ln.registerHandler(cp);ln.registerHandler(hp);li.register(lo.type,lo);function Fp(){var o=Math.floor(Math.random()*2e3),a=Math.floor(Math.random()*2e3);return{clientX:o,clientY:a,screenX:o,screenY:a,pageX:o,pageY:a}}var Zn={clientX:5e4,clientY:5e4,screenX:5e4,screenY:5e4,pageX:5e4,pageY:5e4};for(var Ii=0;Ii<256;Ii++)(Ii<16?"0":"")+Ii.toString(16);var Gp=1e-11;(function(){function o(a,n,i){$(this,o),this._jsPlumb=a,this.ok=n,this.equal=i,h(this,"_divs",[]),h(this,"mottle",void 0),this.mottle=new Fa}return J(o,[{key:"_t",value:function(n,i,e,t){this.mottle.trigger(n,i,{pageX:e,pageY:t,screenX:e,screenY:t,clientX:e,clientY:t})}},{key:"addDiv",value:function(n,i,e,t,r,s,l){var u=document.createElement("div");return u.style.position="absolute",u.innerHTML=n,i?i.appendChild(u):this._jsPlumb.getContainer().appendChild(u),u.setAttribute("id",n),u.style.left=(t??Math.floor(Math.random()*1e3))+"px",u.style.top=(r??Math.floor(Math.random()*1e3))+"px",e&&(u.className=e),s&&(u.style.width=s+"px"),l&&(u.style.height=l+"px"),this._divs.push(n),u}},{key:"addDivs",value:function(n,i){for(var e=0;e<n.length;e++)this.addDiv(n[e],i)}},{key:"assertEndpointCount",value:function(n,i){var e=this._jsPlumb.getEndpoints(n),t=e?e.length:0;this.equal(t,i,n.getAttribute("data-jtk-managed")+" has "+i+(i>1||i==0?" endpoints":" endpoint"))}},{key:"_assertManagedEndpointCount",value:function(n,i){var e=this._jsPlumb.getId(n),t=this._jsPlumb._managedElements[e];this.equal(t.endpoints.length,i,e+" has "+i+" endpoints in managed record")}},{key:"_assertManagedConnectionCount",value:function(n,i){var e=this._jsPlumb.getId(n),t=this._jsPlumb._managedElements[e];this.equal(t.connections.length,i,e+" has "+i+" connections in managed record")}},{key:"_registerDiv",value:function(n){this._divs.push(n)}},{key:"makeDragStartEvt",value:function(n){var i=this.makeEvent(n),e=this._jsPlumb.getContainer();return i.clientX+=e.offsetLeft,i.screenX+=e.offsetLeft,i.pageX+=e.offsetLeft,i.clientY+=e.offsetTop,i.screenY+=e.offsetTop,i.pageY+=e.offsetTop,i}},{key:"getAttribute",value:function(n,i){return n.getAttribute(i)}},{key:"dragNodeBy",value:function(n,i,e,t){t=t||{},t.before&&t.before();var r=this.makeEvent(n);this._jsPlumb.trigger(n,de,r),t.beforeMouseMove&&t.beforeMouseMove(),this._t(document,ze,r.pageX+i,r.pageY+e),t.beforeMouseUp&&t.beforeMouseUp(),this.mottle.trigger(document,fe,null),t.after&&t.after()}},{key:"dragNodeTo",value:function(n,i,e,t){t=t||{};var r=this._jsPlumb.viewport.getPosition(this._jsPlumb.getId(n));t.before&&t.before();var s=this.makeEvent(n);this._jsPlumb.trigger(n,de,s);var l=this._jsPlumb.getContainer().getBoundingClientRect();t.beforeMouseMove&&t.beforeMouseMove(),this._t(document,ze,l.x+i+r.w/2,l.y+e+r.h/2),t.beforeMouseUp&&t.beforeMouseUp(),this.mottle.trigger(document,fe,null),t.after&&t.after()}},{key:"dragToGroup",value:function(n,i,e){var t=this._jsPlumb.getGroup(i),r=this._jsPlumb.viewport.getPosition(t.elId),s=r.x+r.w/2,l=r.y+r.h/2;this.dragNodeTo(n,s,l,e)}},{key:"aSyncDragNodeBy",value:function(n,i,e,t){var r=this;t=t||{},t.before&&t.before();var s=this.makeEvent(n);this._jsPlumb.trigger(n,de,s),t.beforeMouseMove&&t.beforeMouseMove(),setTimeout(function(){r._t(document,ze,s.pageX+i,s.pageY+e),t.beforeMouseUp&&t.beforeMouseUp(),setTimeout(function(){r.mottle.trigger(document,fe,null),t.after&&t.after()},45)},45)}},{key:"dragANodeAround",value:function(n,i,e){this._jsPlumb.trigger(n,de,this.makeEvent(n));for(var t=Math.random()*50,r=0;r<t;r++){var s=Fp();n.style.left=s.screenX+"px",n.style.top=s.screenY+"px",this._jsPlumb.trigger(document,ze,s)}i&&this.ok(i(),e||"while dragging assert"),this._jsPlumb.trigger(document,fe,Zn)}},{key:"dragConnection",value:function(n,i,e,t){var r=this.getCanvas(n),s=this.getCanvas(i),l=this.makeEvent(r),u=this.makeEvent(s);t=t||{};var c=this._jsPlumb.select().length;return this._jsPlumb.trigger(r,de,l),t.beforeMouseMove&&t.beforeMouseMove(),this._jsPlumb.trigger(e?s:document,ze,u),t.beforeMouseUp&&t.beforeMouseUp(),this._jsPlumb.trigger(e?s:document,fe,u),this._jsPlumb.select().get(c)}},{key:"aSyncDragConnection",value:function(n,i,e){var t=this;e=e||{};var r=this.getCanvas(n),s=this.getCanvas(i),l=this.makeEvent(r),u=this.makeEvent(s),c=this._jsPlumb.select().length;this._jsPlumb.trigger(r,de,l),setTimeout(function(){e.beforeMouseMove&&e.beforeMouseMove(),t._jsPlumb.trigger(document,ze,u),setTimeout(function(){e.beforeMouseUp&&e.beforeMouseUp(),t._jsPlumb.trigger(s,fe,u),e.after&&e.after(t._jsPlumb.select().get(c))},5)},5)}},{key:"dragAndAbortConnection",value:function(n){var i=this.getCanvas(n),e=this.makeEvent(i);this._jsPlumb.trigger(i,de,e),this._jsPlumb.trigger(document,ze,Zn),this._jsPlumb.trigger(document,fe,Zn)}},{key:"detachConnection",value:function(n,i){i=i||{};var e=this.getEndpointCanvas(n),t=this.makeEvent(e);i.before&&i.before(),this._jsPlumb.trigger(e,de,t),i.beforeMouseMove&&i.beforeMouseMove(),this._jsPlumb.trigger(document,ze,Zn),i.beforeMouseUp&&i.beforeMouseUp(),this._jsPlumb.trigger(document,fe,Zn),i.after&&i.after()}},{key:"detachAndReattachConnection",value:function(n,i){i=i||{};var e=this.getEndpointCanvas(n),t=this.makeEvent(e);i.before&&i.before(),this._jsPlumb.trigger(e,de,t),i.beforeMouseMove&&i.beforeMouseMove(),this._jsPlumb.trigger(document,ze,Zn),this._jsPlumb.trigger(document,ze,t),i.beforeMouseUp&&i.beforeMouseUp(),this._jsPlumb.trigger(document,fe,t),i.after&&i.after()}},{key:"detachConnectionByTarget",value:function(n,i){this.detachConnection(n.endpoints[1],i)}},{key:"relocateTarget",value:function(n,i,e){this.relocate(n,1,i,e)}},{key:"relocate",value:function(n,i,e,t){t=t||{},e=this.getCanvas(e);var r=this.getEndpointCanvas(n.endpoints[i]),s=this.makeEvent(r),l=this.makeEvent(e);t.before&&t.before(),this._jsPlumb.trigger(r,de,s),t.beforeMouseMove&&t.beforeMouseMove(),this._jsPlumb.trigger(document,ze,l),t.beforeMouseUp&&t.beforeMouseUp(),this._jsPlumb.trigger(e,fe,l),t.after&&t.after()}},{key:"relocateSource",value:function(n,i,e){this.relocate(n,0,i,e)}},{key:"makeEvent",value:function(n){var i=n.getBoundingClientRect(),e=i.x+i.width/2,t=i.y+i.height/2;return{clientX:e,clientY:t,screenX:e,screenY:t,pageX:e,pageY:t}}},{key:"getCanvas",value:function(n){return n.endpoint?this.getEndpointCanvas(n):n}},{key:"getEndpointCanvas",value:function(n){return n.endpoint.canvas}},{key:"getConnectionCanvas",value:function(n){return n.connector.canvas}},{key:"getEndpointCanvasPosition",value:function(n){var i=this.getEndpointCanvas(n);return{x:parseInt(i.style.left,10),y:parseInt(i.style.top,10),w:i.getAttribute("width"),h:i.getAttribute("height")}}},{key:"within",value:function(n,i,e){this.ok(Math.abs(n-i)<Gp,e+"[expected: "+i+" got "+n+"] [diff:"+Math.abs(n-i)+"]")}},{key:"assertManagedEndpointCount",value:function(n,i){var e=this._jsPlumb.getId(n),t=this._jsPlumb._managedElements[e];this.equal(t.endpoints.length,i,e+" has "+i+" endpoints in managed record")}},{key:"assertManagedConnectionCount",value:function(n,i){var e=this._jsPlumb.getId(n),t=this._jsPlumb._managedElements[e];this.equal(t.connections.length,i,e+" has "+i+" connections in managed record")}},{key:"fireEventOnEndpoint",value:function(n){for(var i=this.getEndpointCanvas(n),e=0;e<(arguments.length<=1?0:arguments.length-1);e++)this._jsPlumb.trigger(i,e+1<1||arguments.length<=e+1?void 0:arguments[e+1])}},{key:"fireEventOnElement",value:function(n){for(var i=0;i<(arguments.length<=1?0:arguments.length-1);i++)this._jsPlumb.trigger(n,i+1<1||arguments.length<=i+1?void 0:arguments[i+1])}},{key:"fireEventOnConnection",value:function(n){for(var i=this.getConnectionCanvas(n),e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];this.fireEventOnElement.apply(this,[i].concat(t))}},{key:"clickOnConnection",value:function(n){this.fireEventOnConnection(n,at)}},{key:"dblClickOnConnection",value:function(n){this.fireEventOnConnection(n,gt)}},{key:"tapOnConnection",value:function(n){this.fireEventOnConnection(n,de),this.fireEventOnConnection(n,fe)}},{key:"dblTapOnConnection",value:function(n){this.fireEventOnConnection(n,de),this.fireEventOnConnection(n,fe),this.fireEventOnConnection(n,de),this.fireEventOnConnection(n,fe)}},{key:"clickOnElement",value:function(n,i){this._jsPlumb.trigger(n,at,null,null,i??1)}},{key:"dblClickOnElement",value:function(n){this._jsPlumb.trigger(n,gt)}},{key:"tapOnElement",value:function(n){this._jsPlumb.trigger(n,de),this._jsPlumb.trigger(n,fe)}},{key:"dblTapOnElement",value:function(n){this._jsPlumb.trigger(n,de),this._jsPlumb.trigger(n,fe),this._jsPlumb.trigger(n,de),this._jsPlumb.trigger(n,fe)}},{key:"getOverlayCanvas",value:function(n){return n.canvas||n.path}},{key:"fireEventOnOverlay",value:function(n,i,e){var t=n.getOverlay(i),r=this.getOverlayCanvas(t);this._jsPlumb.trigger(r,e)}},{key:"clickOnOverlay",value:function(n,i){this.fireEventOnOverlay(n,i,at)}},{key:"dblClickOnOverlay",value:function(n,i){this.fireEventOnOverlay(n,i,gt)}},{key:"tapOnOverlay",value:function(n,i){this.fireEventOnOverlay(n,i,de),this.fireEventOnOverlay(n,i,fe)}},{key:"dblTapOnOverlay",value:function(n,i){this.fireEventOnOverlay(n,i,de),this.fireEventOnOverlay(n,i,fe),this.fireEventOnOverlay(n,i,de),this.fireEventOnOverlay(n,i,fe)}},{key:"cleanup",value:function(){var n=this._jsPlumb.getContainer();this._jsPlumb.destroy();for(var i in this._divs){var e=document.getElementById(this._divs[i]);e&&e.parentNode.removeChild(e)}this._divs.length=0;var t=this._jsPlumb.select().length,r=this._jsPlumb.selectEndpoints().length,s=n.querySelectorAll(".jtk-endpoint").length,l=n.querySelectorAll(".jtk-connector").length;for(var u in n.__ta)for(var c in n.__ta[u])throw"Container event bindings not empty for key "+u;if(t>0)throw"there are connections in the data model!";if(r>0)throw"there are endpoints in the data model!";if(s>0)throw"there are "+s+" endpoints left in the dom!";if(l>0)throw"there are "+l+" connections left in the dom!"}},{key:"makeContent",value:function(n){var i=document.createElement("div");return i.innerHTML=n,i.firstChild}},{key:"length",value:function(n){var i=0;for(var e in n)n.hasOwnProperty(e)&&i++;return i}},{key:"head",value:function(n){for(var i in n)return n[i]}},{key:"uuid",value:function(){return Ke()}}]),o})();var pl=0;function jp(){var o=pl+1;return pl++,o}function Bp(o){return new sp(jp(),o)}const Up={key:1,class:"flex flex-col h-full w-full relative"},Vp={class:"flex-grow flex flex-col justify-between px-4 py-2"},Hp={class:"text-sm text-gray-500"},Yp={key:0,class:"text-purple-500 h-[22px] w-4"},Xp={class:"text-md"},$p={class:"text-sm text-gray-500"},Wp={class:"absolute top-1 right-2 text-sm text-gray-500"},Kp={class:"flex justify-end absolute bottom-0 right-0"},zp=fo({__name:"LessonCard",props:{lesson:{},loading:{type:Boolean}},emits:["edit","delete","cover"],setup(o,{emit:a}){const n=o,i=a,e=ml();async function t(r){const s=r.files[0],l=new FormData;l.append("file",s),n.lesson.sourceImageUrl.length>0&&await Vi.deleteFile(n.lesson.sourceImageUrl);try{const{data:u}=await Vi.uploadFile(l,"cover");i("cover",n.lesson,u.source_url)}catch(u){console.log(u)}}return(r,s)=>{const l=xl,u=Cl,c=Ea,d=hr;return ue(),je("div",{class:"cursor-pointer w-[340px] h-40 bg-gray-50 rounded-lg border border-gray-200",onClick:s[3]||(s[3]=f=>he(e).push({name:"lesson-edit",params:{id:r.lesson.id}}))},[n.loading?(ue(),ot(l,{key:0,class:"flex justify-center items-center w-10 h-full"})):(ue(),je("div",Up,[se("div",Vp,[se("div",Hp,yt(`${n.lesson.stage}`),1),se("div",null,[r.lesson.accessType==="premium"?(ue(),je("div",Yp,s[4]||(s[4]=[se("i",{class:"pi pi-crown","aria-hidden":"true"},null,-1)]))):At("",!0),se("div",Xp,yt(r.lesson.name),1),se("div",$p,yt(n.lesson.description),1)])]),se("div",Wp,yt(n.lesson.id),1),n.lesson.sourceImageUrl?(ue(),ot(u,{key:0,src:n.lesson.sourceImageUrl,alt:"Image",class:"absolute top-2 right-3 w-[120px] h-[120px]"},null,8,["src"])):At("",!0),se("div",{class:"absolute top-2 right-3",onClick:s[0]||(s[0]=_i(()=>{},["stop"]))},[re(c,{mode:"basic",customUpload:"",auto:"",onSelect:t,"choose-icon":"pi pi-image",class:"p-button-link p-button-secondary w-[120px] h-[120px]"})]),se("div",Kp,[re(d,{icon:"pi pi-pencil",size:"small",severity:"info",variant:"text",onClick:s[1]||(s[1]=_i(f=>i("edit",n.lesson),["stop"]))}),re(d,{icon:"pi pi-trash",size:"small",severity:"danger",variant:"text",onClick:s[2]||(s[2]=_i(f=>i("delete",n.lesson),["stop"]))})])]))])}}}),Zp=ma(zp,[["__scopeId","data-v-4c2a36f7"]]),Jp=["id"],Qp={class:"flex justify-end gap-2"},qp=fo({__name:"LessonsView",props:{level:{},dependenciesMode:{type:Boolean}},setup(o){const a=o,n=va(),i=ha(),e=ba(),{isLessonCreating:t,isLessonUpdating:r,isLessonDeleting:s,isOrderUpdating:l,groupedLessons:u,groupedDependencies:c}=Zr(e),{createLesson:d,updateLessonById:f,deleteLessonById:v,loadRouteById:p,updateRouteLessonsOrderById:y,createLessonDependency:g,deleteLessonDependency:E,deleteAllLessonDependencies:b}=e,S=me(!1),C=me(!1),x=me(null),T=me(""),O=me(""),P=me("premium"),A=me("learn");let _;const R=me();El(async()=>{await Qu(),_=Bp({container:R.value,paintStyle:{strokeWidth:1.5,stroke:"#456"},maxConnections:-1,connector:"Bezier",connectionOverlays:[{type:"Arrow",options:{location:1}}]}),a.dependenciesMode?(M(),L()):F(),_.bind(wa,async B=>{if(B.originalSourceID.includes("jsplumb"))return;const H=B.originalSourceId.split("-")[1],Q=B.originalTargetId.split("-")[1];await E({depend_on_id:Number(H),lesson_id:Number(Q),route_id:Number(n.params.id)})}),_.bind(_a,async B=>{if(B.sourceId.includes("jsplumb"))return;const H=B.sourceId.split("-")[1],Q=B.targetId.split("-")[1];await g({depend_on_id:Number(H),lesson_id:Number(Q),route_id:Number(n.params.id)})}),_.bind(tu,async B=>{if(B.sourceId.includes("jsplumb"))return;const H=B.sourceId.split("-")[1],Q=B.targetId.split("-")[1];await E({depend_on_id:Number(H),lesson_id:Number(Q),route_id:Number(n.params.id)})})});async function M(){for(const B of Object.values(u.value[a.level.id]))for(const H of B){const Q=document.getElementById(`lesson-${H.id}`);_.addEndpoint(Q,{source:!0,anchor:"Top",endpoint:{type:Nn.type}}),_.addEndpoint(Q,{target:!0,anchor:"Left",endpoint:{type:ri.type}})}}async function F(){for(const B of Object.values(u.value[a.level.id]))for(const H of B){const Q=_.getEndpoints(document.getElementById(`lesson-${H.id}`));for(const ne of Q)_.deleteEndpoint(ne)}}function L(){const B=c.value[a.level.id];for(const H of B)_.connect({source:document.getElementById(`lesson-${H.depend_on_id}`),target:document.getElementById(`lesson-${H.lesson_id}`),anchors:["Top","Left"]})}function k(B){T.value="",O.value="",P.value="premium",C.value=!0,S.value=!0,A.value=B}function N(B){x.value=B,T.value=B.name,O.value=B.description,P.value=B.accessType,C.value=!1,S.value=!0}async function V(){C.value?await d({name:T.value,description:O.value,access_type:P.value,lesson_type:A.value,level_id:a.level.id,route_id:Number(n.params.id)}):x.value&&await f(x.value.id,{name:T.value,description:O.value,access_type:P.value}),await p(Number(n.params.id)),S.value=!1}async function ae(B,H){await f(B.id,{source_image_url:H}),await p(Number(n.params.id))}function ve(B){x.value=B,i.require({...ya,message:"Are you sure you want to delete this lesson?",accept:async()=>{await v(B.id),await p(Number(n.params.id))}})}async function Ue(B){if(!l.value){if(B.added){const H=B.added.element.id,Q=Ce(H);if(Q){const{levelId:Me,lessonType:Pe}=Q;if(Me!=B.added.element.levelId&&await b({lesson_id:Number(H),route_id:Number(n.params.id)}),Pe!=B.added.element.lessonType){await f(H,{lesson_type:Pe});const ft=u.value[a.level.id][Pe].find(xe=>xe.id===H);ft&&(ft.lessonType=Pe)}}const ne=Se();await y(Number(n.params.id),ne)}else if(B.moved){const H=Se();await y(Number(n.params.id),H)}}}function Ce(B){var H;for(const[Q,ne]of Object.entries(u.value))for(const Me of es)if((H=ne[Me])!=null&&H.some(Pe=>Pe.id===B))return{levelId:Number(Q),lessonType:Me};return null}function Se(){const B=[];for(const H in u.value){const Q=Number(H),ne=u.value[Q],Me=Object.values(ne).flat();B.push({level_id:Q,lesson_ids:Me.map(Pe=>Pe.id)})}return{orders:B}}const Ae={learn:"success",practice:"info",module:"warn",default:"error"};return(B,H)=>{const Q=Sl,ne=hr,Me=ga,Pe=cc,ft=pa;return ue(),je(On,null,[se("div",{ref_key:"lessonsWrapperRef",ref:R,class:"relative flex flex-col gap-4"},[(ue(!0),je(On,null,zr(he(es),xe=>(ue(),je(On,{key:xe},[re(Q,{severity:Ae[xe]||Ae.default,class:"min-w-fit pr-4",size:"small"},{default:st(()=>[Bo(yt(xe.charAt(0).toUpperCase()+xe.slice(1)),1)]),_:2},1032,["severity"]),re(he(pd),{modelValue:he(u)[B.level.id][xe],"onUpdate:modelValue":Je=>he(u)[B.level.id][xe]=Je,group:"lessons","item-key":"id","data-key":`${a.level.id}-${xe}`,class:"flex flex-wrap gap-4 min-h-[5rem]",onChange:Ue,disabled:he(l)||B.dependenciesMode},{item:st(({element:Je})=>{var Ye;return[se("div",{id:`lesson-${Je.id}`},[re(Zp,{lesson:Je,loading:((Ye=x.value)==null?void 0:Ye.id)===Je.id&&(he(r)||he(s)),onEdit:$e=>N(Je),onDelete:$e=>ve(Je),onCover:ae},null,8,["lesson","loading","onEdit","onDelete"])],8,Jp)]}),footer:st(()=>[re(ne,{icon:"pi pi-plus",label:"Add",variant:"outlined",class:"w-[340px] h-40",onClick:Je=>k(xe)},null,8,["onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue","data-key","disabled"])],64))),128))],512),re(ft,{visible:S.value,"onUpdate:visible":H[4]||(H[4]=xe=>S.value=xe),modal:"",header:C.value?"Create Lesson":"Update Lesson",style:{width:"25rem"}},{default:st(()=>[re(Me,{modelValue:T.value,"onUpdate:modelValue":H[0]||(H[0]=xe=>T.value=xe),class:"w-full mb-4",placeholder:"Name"},null,8,["modelValue"]),re(Me,{modelValue:O.value,"onUpdate:modelValue":H[1]||(H[1]=xe=>O.value=xe),class:"w-full mb-4",placeholder:"Description"},null,8,["modelValue"]),re(Pe,{modelValue:P.value,"onUpdate:modelValue":H[2]||(H[2]=xe=>P.value=xe),options:he(dc),class:"w-full mb-4",placeholder:"Select access type"},null,8,["modelValue","options"]),se("div",Qp,[re(ne,{label:"Cancel",severity:"secondary",onClick:H[3]||(H[3]=xe=>S.value=!1)}),re(ne,{label:C.value?"Create":"Update",loading:he(t)||he(r),disabled:he(t)||he(r),onClick:V},null,8,["label","loading","disabled"])])]),_:1},8,["visible","header"])],64)}}}),eg=ma(qp,[["__scopeId","data-v-5408bbb0"]]),tg={class:"flex flex-col gap-4"},ng={class:"flex items-center gap-2"},rg={class:"flex items-center gap-2"},ig={class:"text-xl"},og={class:"flex gap-2 mb-4"},ag={class:"flex justify-end gap-2"},sg=fo({__name:"LevelsView",props:{levels:{}},setup(o){const a=o,n=va(),i=ha(),e=ba(),{isLevelCreating:t,isLevelUpdating:r,mode:s}=Zr(e),{loadRouteById:l,createLevel:u,updateLevelById:c,deleteLevelById:d}=e,f=me(["Order mode","Dependency mode"]),v=me(!1),p=me(!1),y=me(null),g=me(""),E=me(0),b=me(0);function S(){g.value="",p.value=!0,v.value=!0}function C(O){y.value=O,g.value=O.name,E.value=O.learnCount,b.value=O.practiceCount,p.value=!1,v.value=!0}async function x(){p.value?await u({name:g.value}):y.value&&await c(y.value.id,{name:g.value,learn_count:E.value,practice_count:b.value}),await l(Number(n.params.id)),v.value=!1}function T(O){i.require({...ya,message:"Are you sure you want delete?",accept:async()=>{await d(O),await l(Number(n.params.id))}})}return bl(s,()=>l(Number(n.params.id))),(O,P)=>{const A=uc,_=hr,R=lc,M=ga,F=sc,L=pa;return ue(),je("div",tg,[re(A,{modelValue:he(s),"onUpdate:modelValue":P[0]||(P[0]=k=>qu(s)?s.value=k:null),options:f.value,size:"small",class:"self-end",allowEmpty:!1},null,8,["modelValue","options"]),(ue(!0),je(On,null,zr(a.levels,k=>(ue(),je("div",{key:k.id,class:"flex flex-col gap-4"},[se("div",ng,[re(R,{align:"center",type:"dotted",class:"m-0"},{default:st(()=>[se("div",rg,[re(_,{icon:"pi pi-pencil",size:"small",severity:"info",variant:"outlined",onClick:N=>C(k)},null,8,["onClick"]),se("div",ig,yt(k.name),1)])]),_:2},1024),re(_,{icon:"pi pi-trash",size:"small",severity:"danger",variant:"outlined",onClick:N=>T(k.id)},null,8,["onClick"])]),re(eg,{level:k,dependenciesMode:he(s)=="Dependency mode"},null,8,["level","dependenciesMode"])]))),128)),re(R,{align:"center",type:"dotted"},{default:st(()=>[re(_,{icon:"pi pi-plus",label:"Add level",variant:"outlined",onClick:S})]),_:1}),re(L,{visible:v.value,"onUpdate:visible":P[5]||(P[5]=k=>v.value=k),modal:"",header:p.value?"Create new level":"Update level",style:{width:"25rem"}},{default:st(()=>[re(M,{modelValue:g.value,"onUpdate:modelValue":P[1]||(P[1]=k=>g.value=k),id:"name",class:"w-full mb-4",autocomplete:"off",placeholder:"Name"},null,8,["modelValue"]),se("div",og,[re(F,{modelValue:E.value,"onUpdate:modelValue":P[2]||(P[2]=k=>E.value=k),placeholder:"Min Learn lessons",inputId:"minmax",min:0,max:100,fluid:""},null,8,["modelValue"]),re(F,{modelValue:b.value,"onUpdate:modelValue":P[3]||(P[3]=k=>b.value=k),placeholder:"Min Practice lessons",inputId:"minmax",min:0,max:100,fluid:""},null,8,["modelValue"])]),se("div",ag,[re(_,{type:"button",label:"Cancel",severity:"secondary",onClick:P[4]||(P[4]=k=>v.value=!1)}),re(_,{type:"button",label:p.value?"Create":"Update",loading:he(t)||he(r),disabled:he(t)||he(r),onClick:x},null,8,["label","loading","disabled"])])]),_:1},8,["visible","header"])])}}}),lg={class:"flex flex-col items-center relative"},ug={class:"w-full max-w-[1280px] px-8 py-10"},cg={key:1,class:"flex justify-center"},dg={key:2},fg={class:"flex items-center justify-between mb-2"},hg={class:"flex flex-col"},vg={class:"flex items-center gap-10"},pg={class:"text-2xl"},gg={class:"w-[120px] h-[120px] relative"},yg={class:"text-lg text-gray-500"},mg={class:"flex gap-2"},Eg={class:"flex justify-end gap-2"},bg={class:"fixed top-32 right-0 pl-2 pr-4 py-2 bg-white rounded-tl-lg rounded-bl-lg shadow-md z-[1000] border border-gray-200 flex flex-col items-center gap-4"},Sg=fo({__name:"RouteEditPage",setup(o){const a=va(),n=ml(),i=ha(),e=Pl(),{lang:t}=Zr(e),r=ba(),{isRouteLoading:s,isRouteUpdating:l,isRouteDeleting:u,selectedRoute:c}=Zr(r),{loadRouteById:d,updateRouteById:f,deleteRouteById:v}=r;function p(){i.require({...ya,message:"Are you sure you want delete?",accept:async()=>{await v(Number(a.params.id)),n.go(-1)}})}const y=me(!1);async function g(){var b,S;await f(Number(a.params.id),{name:(b=c.value)==null?void 0:b.name,description:(S=c.value)==null?void 0:S.description}),y.value=!1}El(()=>d(Number(a.params.id))),bl(t,async(b,S)=>{b!==S&&c.value&&await d(c.value.id)});async function E(b){if(c.value==null)return;const S=b.files[0],C=new FormData;C.append("file",S),c.value.sourceImage_url.length>0&&await Vi.deleteFile(c.value.sourceImage_url);try{const{data:x}=await Vi.uploadFile(C,"cover");await f(Number(a.params.id),{source_image_url:x.source_url}),await d(Number(a.params.id))}catch(x){console.log(x)}}return(b,S)=>{const C=xl,x=Cl,T=Ea,O=hr,P=ga,A=ec,_=pa;return ue(),je("div",lg,[re(he(rc)),se("div",ug,[he(s)?(ue(),ot(C,{key:0,class:"flex justify-center"})):he(c)?(ue(),je("div",dg,[se("div",fg,[se("div",hg,[se("div",vg,[se("div",pg,yt(he(c).name),1),se("div",gg,[he(c).sourceImage_url?(ue(),ot(x,{key:0,src:he(c).sourceImage_url,alt:"Image",class:"w-[120px] h-[120px] absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"},null,8,["src"])):At("",!0),se("div",{onClick:S[0]||(S[0]=_i(()=>{},["stop"])),class:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"},[re(T,{mode:"basic",customUpload:"",auto:"",onSelect:E,"choose-icon":"pi pi-image",class:"p-button-link p-button-secondary w-[120px] h-[120px]"})])])]),se("div",yg,yt(he(c).description),1)]),se("div",mg,[re(O,{label:"Edit",severity:"info",variant:"outlined",class:"w-fit",onClick:S[1]||(S[1]=R=>y.value=!0)}),re(O,{label:"Delete",severity:"danger",variant:"outlined",class:"w-fit",loading:he(u),disabled:he(u),onClick:p},null,8,["loading","disabled"]),re(_,{visible:y.value,"onUpdate:visible":S[5]||(S[5]=R=>y.value=R),modal:"",header:"Update route",style:{width:"40rem"}},{default:st(()=>[re(P,{modelValue:he(c).name,"onUpdate:modelValue":S[2]||(S[2]=R=>he(c).name=R),id:"name",class:"w-full mb-4",autocomplete:"off",placeholder:"Name"},null,8,["modelValue"]),re(A,{modelValue:he(c).description,"onUpdate:modelValue":S[3]||(S[3]=R=>he(c).description=R),rows:"5",id:"description",class:"w-full mb-4",autocomplete:"off",placeholder:"Description"},null,8,["modelValue"]),se("div",Eg,[re(O,{type:"button",label:"Cancel",severity:"secondary",onClick:S[4]||(S[4]=R=>y.value=!1)}),re(O,{type:"button",label:"Update",loading:he(l),disabled:he(l),onClick:g},null,8,["loading","disabled"])])]),_:1},8,["visible"])])]),re(sg,{levels:he(c).levels},null,8,["levels"])])):(ue(),je("div",cg,"No route found"))]),se("div",bg,[re(he(ic))])])}}}),ey=ma(Sg,[["__scopeId","data-v-fddbf36c"]]);export{ey as default};
