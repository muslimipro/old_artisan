import{s as R}from"./index-_swAczI0.js";import{s as U}from"./index-C4TRSEyf.js";import{s as z}from"./index-CAA1rma3.js";import{d as V,u as N,r,b as E,o as s,c as d,p as i,i as o,q as L,F as j,l as q,e as A,g as F,G as W,x as O,j as a,h as p,H as K,D as $,I as M,K as G,C as H,v as J,w as Q}from"./index-BNOYZ_6B.js";import{u as X,a as Y}from"./store-DTC7bVf7.js";import{S as Z}from"./SimulationView-C13y6_Wx.js";import"./CodeEditorView.vue_vue_type_script_setup_true_lang-DPho1RON.js";import{_ as ee}from"./CodeViewer.vue_vue_type_script_setup_true_lang-C9XRut4D.js";import{L as te}from"./lessonApi-DJ332M2h.js";import{m as se}from"./mapLessonFromDto-CG19vVOp.js";import{m as oe}from"./mapUnitFromDto-DJ2zlrQL.js";import{U as ne}from"./unitApi-CO-UTFqE.js";import{a as ie,b as ae,c as re,d as le}from"./TeacherReviseViewer.vue_vue_type_style_index_0_scoped_b98b9a0f_lang-CVQydLSn.js";import{a as ue,b as de,_ as ce}from"./SubmitImageReviseViewer.vue_vue_type_script_setup_true_lang-D223-FK7.js";import"./index-fSFpeyui.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-DlyffbqJ.js";import"./index-BjTXdGTl.js";import"./index-CNPyJFLZ.js";import"./index-nGXgVu-X.js";import"./index-SW19hvKn.js";import"./transformUnitDtosToPages-4blM3N0G.js";import"./index-Ym3p4DeK.js";import"./index-B1Mvx7RV.js";import"./index-CFd-0ZWH.js";import"./index-BTepqiGI.js";const pe=V("lesson-revise-store",()=>{const g=N(),e=r(null),l=r(!1),u=r([]),_=r(null),x=r(null),y=r(!1),m=r(!1);async function C(f,v){y.value=!1,m.value=!1;try{l.value=!0;const{data:n}=await te.getLessonById(f,v);e.value=se(n),await S()}catch(n){g.add({severity:"error",summary:n.response.data.error,life:2e3})}finally{l.value=!1}}async function S(){if(e.value)try{u.value=[];const f=[];e.value.pages.forEach(n=>{n.groups.forEach(h=>{h.units.forEach(w=>{f.push(w.id)})})});const{data:v}=await ne.getUnitsByIdsandLessonId(f,e.value.id);for(const n of v)u.value.push(oe(n)),(n.unit_type=="code"||n.unit_type=="pibody")&&(y.value=!0,x.value=X("emulatorID"),x.value.setCode("")),n.unit_type=="pibody"&&(m.value=!0,_.value=Y("emulatorID"),_.value.addNeededModules([]))}catch(f){console.error("Error loading units:",f)}finally{}}return{selectedLesson:e,isLessonLoading:l,units:u,showPibody:m,showCode:y,loadLessonById:C}}),me={key:1,class:"flex-grow px-4 py-2"},fe=E({__name:"UnitCard",props:{unit:{},loading:{type:Boolean}},setup(g){const e=g;return(l,u)=>{const _=U;return s(),d("div",null,[l.loading?(s(),i(_,{key:0,class:"flex justify-center items-center w-10 h-full"})):(s(),d("div",me,[e.unit.unitType=="article"?(s(),i(o(ie),{key:0,article:e.unit.content},null,8,["article"])):e.unit.unitType=="options"?(s(),i(o(ae),{key:1,"options-data":e.unit.content,state:e.unit.studentState},null,8,["options-data","state"])):e.unit.unitType=="open"?(s(),i(o(re),{key:2,state:e.unit.studentState},null,8,["state"])):e.unit.unitType=="video"?(s(),i(o(le),{key:3,video:e.unit.content},null,8,["video"])):e.unit.unitType=="code"?(s(),i(o(ue),{key:4,state:e.unit.studentState},null,8,["state"])):e.unit.unitType=="pibody"?(s(),i(o(de),{key:5,state:e.unit.studentState},null,8,["state"])):e.unit.unitType=="submit-image"?(s(),i(o(ce),{key:6,state:e.unit.studentState},null,8,["state"])):L("",!0)]))])}}}),ve={ref:"rootEl",class:"flex flex-col gap-8"},ye=E({__name:"UnitsView",props:{units:{}},setup(g){return(e,l)=>(s(),d("div",ve,[(s(!0),d(j,null,q(e.units,u=>(s(),i(fe,{key:u.id,unit:u},null,8,["unit"]))),128))],512))}}),_e={class:"h-screen flex flex-col items-center overflow-hidden relative bg-white"},he={class:"fixed top-0 left-0 right-0 z-50 bg-white border-b border-gray-200 max-w-[1920px] mx-auto"},we={class:"flex justify-between items-center w-full min-h-16 px-8 gap-8"},ge={class:"flex items-center gap-4"},be={key:0,class:"flex flex-grow max-w-screen-lg items-center gap-4"},xe={class:"flex-1 overflow-y-auto mt-16 mb-0 w-full"},ke={key:1,class:"flex justify-center"},$e={key:2},Le={key:0,class:"absolute left-0 top-1/2 -translate-y-1/2"},Ce={class:"relative h-full"},Se={class:"absolute -right-0 top-1/2 -translate-y-1/2 w-5 h-10 z-10"},De={key:1,class:"absolute right-0 top-1/2 -translate-y-1/2"},Ee={class:"relative h-full"},Ie={class:"absolute -left-0 top-1/2 -translate-y-1/2 w-5 h-10 z-10"},ot=E({__name:"LessonRevisePage",setup(g){const e=H(),l=J(),u=pe(),{units:_,isLessonLoading:x,selectedLesson:y,showPibody:m,showCode:C}=A(u),{loadLessonById:S}=u;function f(){var k;((k=y.value)==null?void 0:k.lessonType)=="module"?l.push("/v2/docs"):e.query.route_id&&e.query.route_id!=""?l.push("/v2/route/"+e.query.route_id):l.push("/v2/home")}const v=r(window.innerWidth),n=r(16),h=r(!0),w=r(!0);function D(){if(v.value=window.innerWidth,v.value<=1300){n.value=16;return}const t=452-(v.value-1024)/2;n.value=t>16?t:16}F(()=>{D(),S(Number(e.params.id),(e.query.route_id??"").toString()),window.addEventListener("resize",D)}),W(()=>{window.removeEventListener("resize",D)});const I=O(()=>v.value<=1920?{}:"calc((-100vw + 1920px) / 2)");return(k,t)=>{const b=Q,T=z,P=U,B=R;return s(),d("div",_e,[a("div",he,[a("div",we,[a("div",ge,[p(b,{icon:"pi pi-times",variant:"text",severity:"contrast",onClick:f})]),o(y)?(s(),d("div",be,[p(T,{value:100,"show-value":!1,class:"w-full rounded-full h-3"})])):L("",!0),t[7]||(t[7]=a("div",{class:"w-10"},null,-1))])]),a("div",xe,[a("div",{class:"w-full h-full max-w-screen-lg mx-auto py-8",style:K({paddingLeft:n.value+"px",paddingRight:n.value+"px"})},[o(x)?(s(),i(P,{key:0,class:"flex justify-center"})):o(y)?(s(),d("div",$e,[p(ye,{units:o(_)},null,8,["units"])])):(s(),d("div",ke,"No lesson found"))],4)]),o(m)?(s(),d("div",Le,[p(b,{icon:"pi pi-microchip",severity:"secondary",onClick:t[0]||(t[0]=c=>h.value=!0),class:"w-8 rounded-tl-none rounded-bl-none rounded-tr-lg rounded-br-lg mt-16"}),p(B,{visible:h.value,"onUpdate:visible":t[2]||(t[2]=c=>h.value=c),modal:!1,dismissable:!1,closeOnEscape:!1,class:"h-[calc(100vh-64px)] w-fit mt-16",pt:{root:{style:`right: ${I.value}`}}},{header:$(()=>t[8]||(t[8]=[a("div",null,null,-1)])),container:$(()=>[a("div",Ce,[a("div",Se,[p(b,{icon:"pi pi-chevron-left",severity:"secondary",onClick:t[1]||(t[1]=c=>h.value=!1),class:"w-5 rounded-tl-lg rounded-bl-lg rounded-tr-none rounded-br-none"})]),(s(),i(o(Z),{id:"emulatorID",key:"emulatorID",class:"w-full",horizontal:!1,autoPut:!0}))])]),_:1},8,["visible","pt"])])):L("",!0),o(C)?(s(),d("div",De,[p(b,{icon:"pi pi-code",severity:"secondary",onClick:t[3]||(t[3]=c=>w.value=!0),class:"w-8 rounded-tl-lg rounded-bl-lg rounded-tr-none rounded-br-none mt-16"}),p(B,{visible:w.value,"onUpdate:visible":t[6]||(t[6]=c=>w.value=c),header:"Drawer",modal:!1,dismissable:!1,closeOnEscape:!1,position:"right",class:"h-[calc(100vh-64px)] w-[452px] mt-16",pt:{root:{style:`left: ${I.value}`}}},{header:$(()=>t[9]||(t[9]=[a("div",null,null,-1)])),container:$(()=>[a("div",Ee,[a("div",Ie,[p(b,{icon:"pi pi-chevron-right",severity:"secondary",onClick:t[4]||(t[4]=c=>w.value=!1),class:"w-5 rounded-tl-none rounded-bl-none rounded-tr-lg rounded-br-lg"})]),(s(),i(G,null,[(s(),i(o(ee),{id:"emulatorID",key:"emulatorID",connectbuttons:o(m),"onUpdate:connectbuttons":t[5]||(t[5]=c=>M(m)?m.value=c:null)},null,8,["connectbuttons"]))],1024))])]),_:1},8,["visible","pt"])])):L("",!0)])}}});export{ot as default};
