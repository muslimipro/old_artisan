import{s as R}from"./index-D0oCXJTQ.js";import{b as D,a as U,r as f,x as N,o as t,c as a,j as _,p as v,q as k,k as W,t as T,h as p,y as b,n as H,F as A,l as B,aH as O,w as q,d as z,u as K,ac as G,i as y,e as J,g as Q,C as X}from"./index-CnKe9SRm.js";import{L as Y}from"./lessonApi-xOU5J9_F.js";import{m as Z}from"./mapLessonFromDto-De7FAIVI.js";import{u as ee,a as te}from"./store-81l0maM1.js";import{_ as S,a as se,b as ne,c as oe,d as ae}from"./TeacherReviseViewer.vue_vue_type_style_index_0_scoped_94e5260f_lang-BUIJmgFf.js";import{s as ie,a as le}from"./index-BzcUM8zt.js";import{_ as re}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./mapUnitFromDto-DVWJHO4f.js";import"./transformUnitDtosToPages-hsgZNhAG.js";import"./index-BouttIZh.js";import"./index-D6P5SBNN.js";import"./index-DmQw6gan.js";import"./index-D8XcetXe.js";import"./index-DyVOO59P.js";import"./index-Bzs2LotI.js";import"./index-BrO1a620.js";import"./index-CnKqUMsb.js";import"./index-DKJZLhcG.js";import"./index-DDLJupJ2.js";import"./index-CDFkGpQT.js";import"./index-D_SA3pqJ.js";const ue={class:"rounded-2xl max-w-2xl mx-auto border border-slate-100 gap-1 flex flex-col bg-slate-100 p-4"},ce={class:"flex items-center justify-between"},de={key:0,class:"text-2xl"},pe={class:"flex gap-2 items-center"},fe={class:"flex justify-end"},ve={key:0},me={key:1,class:"flex gap-2 flex-wrap"},_e={key:2},ye={class:"rounded-xl overflow-clip"},he={key:3},ge={class:"rounded-xl overflow-clip"},we=D({__name:"TeacherReviseViewer",props:{classData:{},unitType:{},unitContent:{}},setup(h){const{t:e}=U(),s=h,u=f(),m=f();(()=>{m.value={global:{value:null,matchMode:O.CONTAINS}}})();const r=[],w=[],o=f(0);function x(){r.push(0),w.push(e("pages.teacher.studentAnswers"));for(const n of s.classData)r.push(n.id),w.push(n.name)}x();const c=N(()=>s.classData.find(n=>n.id===r[o.value])),$=N(()=>{var n;return!((n=s.unitContent)!=null&&n.options)||!c.value.answer.options?[]:s.unitContent.options.filter(i=>c.value.answer.options.includes(i.id))});function d(n){return n==="completed"?"text-primary600":n==="attempted"?"text-rose400":n==="started"?"text-warning400":""}function I(){o.value=0}function V(){o.value-=1,o.value<0&&(o.value=0)}function j(){o.value+=1,o.value==r.length&&(o.value=r.length-1)}function M(n){for(let i=0;i<r.length;i++)r[i]==n&&(o.value=i)}return(n,i)=>{var E,F;const C=q,L=ie,P=le;return t(),a("div",ue,[_("div",ce,[s.classData?(t(),a("div",de,[o.value!=0?(t(),v(C,{key:0,tooltip:n.$t("pages.teacher.viewAnswer"),icon:"pi pi-angle-left",outlined:"",onClick:i[0]||(i[0]=l=>I())},null,8,["tooltip"])):k("",!0),W(" "+T(w[o.value]),1)])):k("",!0),_("div",pe,[p(C,{tooltip:n.$t("pages.teacher.viewAnswer"),icon:"pi pi-angle-left",rounded:"",severity:"contrast",onClick:i[1]||(i[1]=l=>V()),disabled:o.value==0},null,8,["tooltip","disabled"]),p(C,{tooltip:n.$t("pages.teacher.viewAnswer"),icon:"pi pi-angle-right",rounded:"",severity:"contrast",onClick:i[2]||(i[2]=l=>j()),disabled:o.value==r.length-1},null,8,["tooltip","disabled"])])]),_("div",null,[r[o.value]==0?(t(),v(P,{key:0,ref_key:"dt",ref:u,filters:m.value,"onUpdate:filters":i[3]||(i[3]=l=>m.value=l),value:s.classData,dataKey:"id",globalFilterFields:["name","email"],class:"rounded-md overflow-hidden w-full",scrollable:"",scrollHeight:"400px"},{default:b(()=>[p(L,{field:"name",header:n.$t("pages.teacher.name"),sortable:""},{body:b(({data:l})=>[_("div",null,T(`${l.name??l.email}`),1)]),_:1},8,["header"]),p(L,{field:"creator_name",header:n.$t("pages.school.status"),sortable:""},{body:b(({data:l})=>[_("div",{class:H(d(l.status))},T(`${l.status}`),3)]),_:1},8,["header"]),p(L,{header:n.$t("pages.teacher.answer"),exportable:!1,class:"text-right",headerClass:"text-right"},{body:b(({data:l})=>[_("div",fe,[p(C,{tooltip:n.$t("pages.teacher.viewAnswer"),icon:"pi pi-angle-right",outlined:"",rounded:"",severity:"info",onClick:Ee=>M(l.id)},null,8,["tooltip","onClick"])])]),_:1},8,["header"])]),_:1},8,["filters","value"])):(t(),a(A,{key:1},[s.unitType=="open"?(t(),a("div",ve,T(c.value.answer.open),1)):s.unitType=="options"?(t(),a("div",me,[(t(!0),a(A,null,B($.value,l=>(t(),a("div",{key:l.id},[p(S,{text:l.text},null,8,["text"])]))),128))])):s.unitType=="code"?(t(),a("div",_e,[_("div",ye,[p(S,{text:` \`\`\`python
${((E=c.value.answer)==null?void 0:E.code)??""}
\`\`\` `},null,8,["text"])])])):s.unitType=="pibody"?(t(),a("div",he,[_("div",ge,[p(S,{text:` \`\`\`python
${((F=c.value.answer)==null?void 0:F.code)??""}
\`\`\` `},null,8,["text"])])])):k("",!0)],64))])])}}}),xe=re(we,[["__scopeId","data-v-94e5260f"]]),$e=z("teacher-revise-store",()=>{const h=K(),e=f(null),s=f(!1),u=f([]),m=f(null),g=f(null),r=f(!1),w=f(!1);async function o(c,$){try{s.value=!0;const{data:d}=await Y.getLessonWithClassData(c,$);e.value=Z(d),await x()}catch(d){h.add({severity:"error",summary:d.response.data.error,life:2e3})}finally{s.value=!1}}async function x(){if(e.value)try{u.value=[],e.value.pages.forEach(c=>{c.groups.forEach($=>{$.units.forEach(d=>{u.value.push(d),(d.unitType=="code"||d.unitType=="pibody")&&(r.value=!0,g.value=ee("emulatorID"),g.value.setCode("")),d.unitType=="pibody"&&(w.value=!0,m.value=te("emulatorID"),m.value.addNeededModules([]))})})})}catch(c){console.error("Error loading units:",c)}finally{}}return{selectedLesson:e,isLessonLoading:s,units:u,showPibody:w,showCode:r,loadLessonWithClassData:o}}),ke={key:1,class:"flex-grow px-4 py-2"},Ce=D({__name:"UnitCard",props:{unit:{},loading:{type:Boolean}},setup(h){const e=h;let s=!1;return G(()=>{e.unit.classData&&(e.unit.unitType=="options"&&(s=!0),e.unit.unitType=="open"&&(s=!0),e.unit.unitType=="code"&&(s=!0),e.unit.unitType=="pibody"&&(s=!0),e.unit.unitType=="checklist"&&(s=!0))}),(u,m)=>{const g=R;return t(),a("div",null,[u.loading?(t(),v(g,{key:0,class:"flex justify-center items-center w-10 h-full"})):(t(),a("div",ke,[e.unit.unitType=="article"?(t(),v(y(se),{key:0,article:e.unit.content},null,8,["article"])):e.unit.unitType=="options"?(t(),v(y(ne),{key:1,"options-data":e.unit.content,state:e.unit.studentState},null,8,["options-data","state"])):e.unit.unitType=="open"?(t(),v(y(oe),{key:2,state:e.unit.studentState},null,8,["state"])):e.unit.unitType=="video"?(t(),v(y(ae),{key:3,video:e.unit.content},null,8,["video"])):k("",!0),y(s)?(t(),v(y(xe),{key:4,classData:e.unit.classData,unitType:e.unit.unitType,unitContent:e.unit.content},null,8,["classData","unitType","unitContent"])):k("",!0)]))])}}}),Te={ref:"rootEl",class:"flex flex-col gap-8"},be=D({__name:"UnitsView",props:{units:{}},setup(h){return(e,s)=>(t(),a("div",Te,[(t(!0),a(A,null,B(e.units,u=>(t(),v(Ce,{key:u.id,unit:u},null,8,["unit"]))),128))],512))}}),De={class:"h-full flex flex-col overflow-y-auto relative bg-white"},Le={class:"w-full max-w-screen-lg mx-auto py-8"},Se={key:1,class:"flex justify-center"},Ae={key:2},et=D({__name:"TeacherRevisePage",setup(h){const e=X(),s=$e(),{units:u,isLessonLoading:m,selectedLesson:g}=J(s),{loadLessonWithClassData:r}=s;return Q(()=>{r(e.params.class_id,e.params.lesson_id)}),(w,o)=>{const x=R;return t(),a("div",De,[_("div",Le,[y(m)?(t(),v(x,{key:0,class:"flex justify-center"})):y(g)?(t(),a("div",Ae,[p(be,{units:y(u)},null,8,["units"])])):(t(),a("div",Se,"No lesson found"))])])}}});export{et as default};
